<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>认识拖延</title>
      <link href="/2018-09-01-%E5%85%B3%E4%BA%8E%E7%A7%91%E5%B9%BB%E5%B0%8F%E8%AF%B4.html"/>
      <url>/2018-09-01-%E5%85%B3%E4%BA%8E%E7%A7%91%E5%B9%BB%E5%B0%8F%E8%AF%B4.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>一些浅薄的看法。<br><a id="more"></a><br>在国科大集中教学期间，我选了一门课叫《科幻小说史》，这门课的老师厉害就厉害在于一页20来字的ppt能够讲一节课，引经据典，博古通今，纵横捭阖，滔滔不绝，涉及了目之所及的所有中外科幻小说。虽然他讲的很好，但是遗憾的是在他的课上我经常做别的课的作业，导致并没有吸收太多的东西。但是好就好在，他的期末作业是交一篇文章，他只有两个要求：1.原创，2.写得好，只要满足这两点就能拿到高分，按照他的说法，就算你只写了一句话，只要这句话写得好，只要是你的原创，那么就可以给你高分。虽然我没有听课，但是自己对于科幻小说还是有一点浅薄的思考，最后把所有的思考写成了作业，字数也不多，最后拿到了一个还算不错的分数。<br>摘要：学习了《科幻小说与科学》这门课之后，对科幻小说有了一定的了解，解答了我之前对于科幻小说这一文学类型的长久的困惑，这些困惑主要包括科幻的小说属性，科幻小说与传统小说的区别，科幻小说中的科学技术以及科幻小说的世界观等等，本文就将对这些方面进行讨论。</p><hr><p>关键字：科幻小说 世界观 科学</p><h1 id="从小说说起：小说与现实的区别"><a href="#从小说说起：小说与现实的区别" class="headerlink" title="从小说说起：小说与现实的区别"></a>从小说说起：小说与现实的区别</h1><p>科幻小说有两个属性，一个是小说，一个是科幻，要想搞清楚科幻小说，就要先搞清楚小说这个概念。小说是<strong>来源于想象</strong>而不是<strong>严格遵守现实</strong>或者历史事实的体裁的一种集合。小说是一种创造性的发明，即是通过作家通过自己的创造而生产出来的一种产品，<strong>因此并不要求其作品的真实性和可信性</strong>。当然，也有一些小说（例如历史小说）可能是基于真实的历史事实描写而成，这些小说具有一定的可信性。但是无论如何，虚构是小说的一大特点。莫言甚至在其出版的作品集的前言写道：<strong>小说必须虚构</strong>。<br>虚构使得小说能够打破<strong>现实与想象</strong>之间的藩篱，能够使得作家创造出现实中并不存在的事情，正如余华说过的那样，现实生活中存在着各种各样的障碍，这些障碍阻挡我们的视线，干扰了我们的自由，文学能够将现实当中存在的障碍一扫而光。因而小说相对于完全基于现实的非虚构文学拥有了更多的可能，能够承载更多的东西。因此小说是一个非常巨大的容器，盛载了无数写作者的智慧结晶，给读者提供了更多的乐趣。小说的虚构性给我们带来了现实生活难以带来的乐趣,例如在柯南.道尔的《福尔摩斯探案集》中福尔摩斯对于华生军医身份的推理，爱伦坡的《黑猫》当中最后结局黑猫在墙壁中突然出现的鸣叫，余华的《活着》当中福贵家人接二连三地离世，这些事件在现实中顶多算是小概率事件，但是小说的存在让我们能够看到很多这样引人入胜的故事。这些虚构出来的故事给我们带来了精神上的愉悦和一些深入的思考，因此小说拓宽了我们的现实世界，化用王小波的一句话就是：小说使我们在此生此世之外拥有了一个诗意的世界。</p><h1 id="科幻小说与一般小说的区别"><a href="#科幻小说与一般小说的区别" class="headerlink" title="科幻小说与一般小说的区别"></a>科幻小说与一般小说的区别</h1><p>虽然大部分小说是虚构的，但是长久以来，传统文学当中的主流文学流派是现实主义文学，即小说当中的背景设定多是基于现实的，这些故事虽然绝大多数是虚构的，但是却是现实生活中很有可能会发生的，出乎意料之外，但是却在情理之中。故事当中的人物不会具有什么<strong>超能力</strong>或者<strong>神秘力量</strong>或者存在超出现实的技术。但是奇异小说、童话小说和科幻小说却在这一点上超越了这个藩篱，达到了更大的自由。科幻小说与奇幻小说和童话小说虽然都含有超现实的力量，但是科幻小说与其他两者有较大区别，因为科幻小说当中主要是通过<strong>自然观和科学观来解释故事当中的超现实情节</strong>，例如《弗兰肯斯坦》当中是通过雷电而不是通过魔法来使死人复活，而奇幻小说和童话小说多诉诸于魔法和巫术来实现超现实情节。而这些差别是由科幻小说的本质决定的：科幻小说有自己特殊的组合因素，有一定程度的认识逻辑和事实证明，将可能性变为现实，而非借助超能力。而这一点使得科幻小说既能够反映现实，却又能够具有比现实更多的可能性，从而具有比现实主义小说更大的包容性。<br>虽然科幻小说和传统小说都是对现实生活的改造，然而，<strong>如果说现实主义文学是对于现实的量变，那么科幻小说则达到了质变</strong>。科幻小说能够让我们看到如果一个新的现实中不存在的技术被发明出来之后可能会给现实世界带来的很多意想不到的变化，比如《时间规划局》：如果我们能够交易彼此的时间的时候，这个社会会发生那些变化？这些新技术的引进常常会带来翻天覆地的变化，在这种巨大的变化之中使我们对于世界和人类自身进行思考。科幻小说挣脱了现实主义小说中的现实主义设定，由于将大多数的故事背景放到了未来，因此通过对未来技术的想象来对未来世界进行描绘，这样一来科幻小说的疆界被大大拓宽，使得我们能够以一个更高的角度来俯瞰我们身处的世界。</p><p>#科幻小说中的“科”与“幻”<br>科幻小说还有一个属性就是“科幻”性，而其中既有“科”的元素，又有“幻”的元素，其中“科”即科学原理及科学的逻辑，而“幻”不仅在于故事的虚构，还在于科学的虚构，<strong>即科幻小说当中的科学并不完全是真实的，也可以是虚构的</strong>，因为科幻小说作家并不是科学家，首先是一个作家，其次科幻小说需要科学技术的虚构，因为一旦完全按照现实中的科学技术去描写，那么很多的故事根本就不成立。但是既然是“科幻小说”而不是“玄幻小说”其关键就在于科幻小说中有着科学的逻辑，有着自成一体的对于科学技术和背景设定的诠释，而不是想到哪里写到哪里。例如刘慈欣的《三体》当中描述了很多物理学现象，例如对于多维世界和其物理规律的诠释，其中有些内容虽然是虚构或者是想象出来的，但是却达到了<strong>自成一体的自洽的效果</strong>。<strong>而对于现实生活中不存在的技术</strong>，例如在《弗兰肯斯坦》和《银翼杀手》当中对于克隆人类这种技术的描写，一般只是指出大略的技术雏形，然后避免描述技术细节，《弗兰肯斯坦》中是以雷电等来克隆人，而《银翼杀手》中是以通过基因来克隆人，这种以<strong>“黑箱子”</strong>来处理技术的手段解决了对于不存在技术描写难题。<br>因此我们<strong>不能将科幻小说当中的科学等同于真正的科学</strong>，而是要进行批判地吸收，通过自己对其他渠道例如教科书或者文献来进行验证。如果我们“听风就是雨”，对科幻小说当中的科学不加甄别地全部吸收，分不清“科”与“幻”的话，就很容易走火入魔，成为大家眼中的“民科”。</p><h1 id="科幻小说中的世界观"><a href="#科幻小说中的世界观" class="headerlink" title="科幻小说中的世界观"></a>科幻小说中的世界观</h1><p>如前文所说，科幻小说对于现实来说发生了<strong>质的改变</strong>，这种质的改变对于小说当中的价值观和世界观造成了很大的影响，使得我们能够跳出固有的<strong>“人类中心”</strong>的视角，以更大的格局去思考这个世界以及对于人类的看法。而这种视野比起传统文学中的视野也许来的更为真实。<br>例如《星际穿越》中对未来资源匮乏，沙尘暴肆虐的世界末日到来之前的世界的描绘，能够让我们思考我们之前未曾思考的问题：如果世界末日到来我们应该如何应对？如果只能使一部分人存活，我们该让哪些人存活？而《三体》当中通过对银河系外三体文明意图对地球进行侵略这一事件的展开，让我们开始思考作为人类在整个宇宙当中所处的位置，以一个更高的视角来审视这个世界和宇宙。《银翼杀手》和《弗兰肯斯坦》当中对于造物主与克隆人人之间关系的探讨，都让我们进一步跳出了我们原有的思维框架。<br>而传统的现实主义文学始终难以<strong>挣脱对人类自我挣扎</strong>的探讨，难以达到更高的视角，《红楼梦》虽伟大，也不过是描述了一个官宦之家的起起落落；《活着》虽令人震撼，却也只是对人生存在意义与价值的探讨；《平凡的世界》虽鼓舞人心，却也只是一个时代当中中国人物的浮沉。当然，这些对人类自我的描写与探讨是我们日常生活中的主要内容，但是若将这些内容放置在整个宇宙的视角当中，却不过是一粒浮尘。人类虽然始终以万物之灵自居，但是在《乡村教师》和《三体》中，将故事背景拓宽到宇宙的层面后，人类文明的进化程度在一些外星人看来不过是上古时期，而《三体》中更是直接说出了“你们这些虫子”这种话，这种跳出人类自我中心而从整个宇宙的角度来俯瞰世界的宏伟世界观是科幻小说的一个引人入胜的地方。而这传统的小说很难实现种视角，而如果以单纯的科学和理论说教又未免太过枯燥，因此科幻小说是一种拓宽世界观的很好的渠道。<br>从这个角度上来说，虽然科幻小说比起现实主义小说的虚构成分更多一些，但是科幻小说能够让我们以一个更为接近科学的世界观来观察世界。这个世界观更加接近现实的本来面目，更能引发我们的深思。</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>综上，阅读科幻小说首先能够培养读者对科学的兴趣，其次还能够影响读者的世界观的形成，给自我的心灵构筑一个更为宏伟的世界，最后，当然也是比较重要的，科幻小说的故事相对于传统小说更为引人入胜。总体来说，科幻小说是一种非常好的文学类型。</p><hr><p>参考资料（除少数几句话为引用外，其余皆为原创）：<br>1布赖恩·奥尔迪丝，舒伟等译：《亿万年大狂欢：西方科幻小说史》，安徽文艺出版社，2011年版<br>2吴雪静. 试论《弗兰肯斯坦》作为科幻小说鼻祖的意义[J]. 作家, 2013(4X):93-94.</p>]]></content>
      
      <categories>
          
          <category> 专业外/科幻 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 科幻小说 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>github+hexo建站资源汇总</title>
      <link href="/2018-08-26-github+hexo%E5%BB%BA%E7%AB%99%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB(%E4%B8%8D%E6%96%AD%E6%9B%B4%E6%96%B0).html"/>
      <url>/2018-08-26-github+hexo%E5%BB%BA%E7%AB%99%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB(%E4%B8%8D%E6%96%AD%E6%9B%B4%E6%96%B0).html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>自己建立博客所用过资源的总结。<br><a id="more"></a></p><table><thead><tr><th>资源种类</th><th>网址</th></tr></thead><tbody><tr><td>从零开始建站</td><td><a href="https://reuixiy.github.io/technology/computer/computer-aided-art/2017/06/09/hexo-next-optimization.html以及https://www.jianshu.com/p/a39573555039" target="_blank" rel="noopener">https://reuixiy.github.io/technology/computer/computer-aided-art/2017/06/09/hexo-next-optimization.html以及https://www.jianshu.com/p/a39573555039</a></td></tr><tr><td>插入音乐</td><td><a href="https://www.jianshu.com/p/a52b68794a6b" target="_blank" rel="noopener">https://www.jianshu.com/p/a52b68794a6b</a></td></tr><tr><td>添加about页面</td><td><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E5%88%9B%E5%BB%BA-%22%E5%85%B3%E4%BA%8E%E6%88%91%22-%E9%A1%B5%E9%9D%A2" target="_blank" rel="noopener">https://github.com/iissnan/hexo-theme-next/wiki/%E5%88%9B%E5%BB%BA-%22%E5%85%B3%E4%BA%8E%E6%88%91%22-%E9%A1%B5%E9%9D%A2</a></td></tr><tr><td>添加tag页面</td><td><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E5%88%9B%E5%BB%BA%E6%A0%87%E7%AD%BE%E4%BA%91%E9%A1%B5%E9%9D%A2" target="_blank" rel="noopener">https://github.com/iissnan/hexo-theme-next/wiki/%E5%88%9B%E5%BB%BA%E6%A0%87%E7%AD%BE%E4%BA%91%E9%A1%B5%E9%9D%A2</a></td></tr><tr><td>添加valine评论系统</td><td><a href="https://www.bluelzy.com/articles/use_valine_for_your_blog.html和https://valine.js.org/quickstart.html和https://reuixiy.github.io/technology/computer/computer-aided-art/2018/07/15/use-valine-in-theme-next.html" target="_blank" rel="noopener">https://www.bluelzy.com/articles/use_valine_for_your_blog.html和https://valine.js.org/quickstart.html和https://reuixiy.github.io/technology/computer/computer-aided-art/2018/07/15/use-valine-in-theme-next.html</a></td></tr><tr><td>插入音乐</td><td><a href="https://github.com/MoePlayer/hexo-tag-aplayer" target="_blank" rel="noopener">https://github.com/MoePlayer/hexo-tag-aplayer</a></td></tr><tr><td>加入版权信息</td><td><a href="http://smartsi.club/2018/05/04/hexo-next-add-copyright-information/" target="_blank" rel="noopener">http://smartsi.club/2018/05/04/hexo-next-add-copyright-information/</a></td></tr><tr><td>添加网站访问量信息</td><td><a href="https://zhiho.github.io/2015/09/29/hexo-next/以及http://ibruce.info/2015/04/04/busuanzi/以及https://reuixiy.github.io/about/以及https://reuixiy.github.io/technology/computer/computer-aided-art/2017/06/09/hexo-next-optimization.html以及https://reuixiy.github.io/technology/computer/computer-aided-art/2017/06/09/hexo-next-optimization.html" target="_blank" rel="noopener">https://zhiho.github.io/2015/09/29/hexo-next/以及http://ibruce.info/2015/04/04/busuanzi/以及https://reuixiy.github.io/about/以及https://reuixiy.github.io/technology/computer/computer-aided-art/2017/06/09/hexo-next-optimization.html以及https://reuixiy.github.io/technology/computer/computer-aided-art/2017/06/09/hexo-next-optimization.html</a></td></tr><tr><td>增加页脚</td><td><a href="http://www.baixiaojian.com/hexo2/以及https://anson2416.github.io/posts/61245e5/以及https://asdfv1929.github.io/2018/01/28/add-the-end/" target="_blank" rel="noopener">http://www.baixiaojian.com/hexo2/以及https://anson2416.github.io/posts/61245e5/以及https://asdfv1929.github.io/2018/01/28/add-the-end/</a></td></tr></tbody></table>]]></content>
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 建站 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>认识拖延</title>
      <link href="/2018-08-25-%E8%AE%A4%E8%AF%86%E6%8B%96%E5%BB%B6.html"/>
      <url>/2018-08-25-%E8%AE%A4%E8%AF%86%E6%8B%96%E5%BB%B6.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>此诚危急存亡之秋也。<br><a id="more"></a></p><h1 id="拖延是一种坏习惯"><a href="#拖延是一种坏习惯" class="headerlink" title="拖延是一种坏习惯"></a>拖延是一种坏习惯</h1><p>拖延症并不是一个普遍的现象，全美国70%的大学生都在抱怨拖延心理，不是别人拖延，而是他们自己拖延。拖延与不快乐，生理免疫系统脆弱，压力过大等等都有关联，可能会导致抑郁，虽然关联程度不高，但两者呈正相关。<br>砒霜有剧毒,几百年前还没有现代这种检测方法,于是很多凶手喜欢用砒霜杀人,在1875年德国艺术与科学协会第48届会议上,两个人当众服下超过两倍致死剂量的砒霜时,可以想象,场下的观众有多么震惊.然而第二天这两个人却安然无恙地微笑着回到了会场,怎么可能摄入了如此剧毒的物质却依然活了下来?吃砒霜的人最开始只食用了微量的砒霜,微量的砒霜并不会造成明显伤害,你甚至可以对砒霜的毒效产生免疫力,这样你就可以服下更大剂量的砒霜了,并且看上去还是健康，即使此时砒霜已经逐渐增加了你患癌症的风险并损坏了你的器官。拖延也是一样，看上去只是推迟了一件非常小的事情，但是日积月累拖延就会成为习惯，虽然看上去也可以很健康，但长期影响并不乐观。<br>拖延是一个极其重要影响广泛的坏习惯，生活中的很多重要领域都会受到拖延的影响。如果你能提高对抗拖延的能力 ，很多有益的改变也会随之而来。拖延和上瘾有很多共同之处：它可以让你短暂地兴奋并从无聊的现实中解脱出来，人们总是轻易地自欺欺人，比如你可以骗自己说现在最好上网搜索资料，而不是去看书或者做作业。你开始对自己编故事：比如你会告诉自己有机化学需要空间想象能力，而你缺乏这种能力，所以你的有机化学必然会学得很烂。你会为自己找一些听起来有道理实际荒谬的借口：比如如果我学得太超前的话就可能会忘记考试内容，如果你受到了拖延的困扰，你甚至可能会开始告诉自己拖延是一种内在的不可改变的性格，毕竟如果拖延很容易解决的话你早就不再拖延了。</p><h1 id="拖延的原因"><a href="#拖延的原因" class="headerlink" title="拖延的原因"></a>拖延的原因</h1><p>要知道，我们常在那些让人不太舒服的事情上拖延。当你在脑海里想到那些不太喜欢的事情时，大脑的痛觉中枢会被点亮，因此你会把注意力转移到你更喜欢的事物上面，这样会让你感觉更好，至少暂时会感到更好，不过可惜的是，这种长期的习惯性逃避是没有好处的。</p><h1 id="拖延的对策"><a href="#拖延的对策" class="headerlink" title="拖延的对策"></a>拖延的对策</h1><p><strong>1.将任务写下来。</strong><br><img src="/images/2018-08/565d22c3-4298-4c42-8c84-2cd6f64415f8.png" alt="scatter"><br>书写下来等于建立了契约，把目标写下来，列一张表，分阶段进行，一一击破对多数人来说很有用。每周在计划本里写下本周关键任务列表,每一天另起一页写下合理的任务列表。试着在前一晚写下每日任务 ，为什么要在前一晚呢？ 研究表明这可以让你<strong>在潜意识下设法解决任务</strong>，从而找到完成方法，睡前写好任务清单征召僵尸，帮助你完成第二天列表里的项目。如果不把任务写下来，它们就会潜伏在四个工作记忆插槽的边缘，在寸土寸金的工作记忆区里尸位素餐，但将任务写到纸上工作记忆就可以用来想别的事情了。<br><strong>2.在早晨先完成困难的任务</strong><br>尽量先开始最重要且最讨厌的工作,至少完成一个番茄时间,一醒来就这么干,这极其有效。<br><strong>3.“5分钟起步”(5 Minutes take-off)</strong><br>大多数拖延症患者都存在着一个误区，那就是以为：开始某一件事情之前，自己必须先得到灵感和启发才能开始，比如说我现在想开始读一篇文献，或者是想开展一项研究，我们总想着先获得激励或者是灵感之后才能开始，但是这种工作方式是不对的，我们并不是先有灵感然后才开始某项工作，而是先开始工作，然后才能出现灵感，当你开始起步后就会形成惯性，从而继续向前前进，90分钟的长跑通常需要5分钟的起步，因此，5分钟起步很重要。通常当你开始学习或者工作时你应该注意到 ：开始学新东西时总是伴随着些许负面情绪，甚至学习你喜欢的科目也是如此。对于这些情绪，不同的处理方式会带来不同效果，研究者们发现不拖延的人会把负面情绪放到一边 ，并对自己说：别浪费时间了马上动工， 一旦你开始了就会感觉好多了。如果发现自己在避开某些让你感觉不舒服的任务，那么你应当知道可以用另一种方法来重新组织任务：学会把注意力集中在过程而不是结果上。过程就是指流动的时间以及这段时间里的习惯和行动。比如我要花20分钟来工作，而结果是产出。这里的基本思想在于<strong>你大脑中的“僵尸习惯”部分喜欢过程</strong>,因为它能够不费心思地前进,要是让友好的“僵尸习惯“来帮助过程的进行,再帮忙做出成果就简单得多了.专注于过程而不是结果,结果是触发痛苦会导致你拖延的东西 </p><blockquote><p>我非常非常热衷积极心理学，我喜欢积极心理学。但有时候，我早上起床，写关于积极心理学的文章，准备积极心理学讲座，或者阅读积极心理学文章，有时候完全不在状态，这让我大吃一惊。那时候我们刚刚结婚几年，我告诉她，是的，有时候我都没心情起床。她说，“这怎么可能，你早上起床，打开电脑，开始工作”。是的，每错，因为我了解5分钟起步，有时候在90分钟时间段里，我不得不再做一次5分钟起步，因为我感到精力不支，所以要么花时间休整，要么我只是有拖延情绪。我说没事，就5分钟，坚持住就行，这5分钟往往会让产生一个向上的螺旋，不是通过思想，不是通过心灵，而是通过行动，5分钟起步可能是客服拖延，最有用的技巧了。</p></blockquote><p><strong>4.利用习惯的力量</strong><br>习惯分为四个阶段:第一个阶段是<strong>信号 (cue)</strong>,这是你进入“僵尸状态”的触发器,触发器可能是你看到了待办事项清单上的第一件事。例如是时候做下周的作业了或看到朋友发来的一条短信 “是时候停止工作了” 。信号本身无所谓好坏，重点是我们对信号做出的反应。第二个阶段就是<strong>惯式 (routine)</strong> ，这就是“僵尸模式”。你的大脑在接收线索时做出的习惯反应就是惯式，僵尸模式下的反应可能有益无害，但有时也可能有害。第三阶段是<strong>奖励 (reward)</strong>, 任何一种习惯得以发展和延续都是因为它可以回报我们，它会立即给我们带来些许愉悦感。拖延是极易产生的习惯，因为你将关注点转向更令人愉悦的事情后所带来的奖励更迅速而简单。但好习惯也是有奖励的，<strong>对于克服拖延症来说想办法奖励好习惯非常重要</strong>。第四阶段是<strong>信念 (belief) </strong>,坚信习惯习惯就会强大起来。例如你可能觉得拖延到深夜才开始学习的习惯将永远无法改变，要改变这一习惯你必须改变潜藏于其中的信念。<br>如果我们利用习惯来的力量来改正拖延。第一个要素是<strong>信号</strong>：确认到底是什么让你进入了”僵尸拖延模式”。信号通常可以分为以下四类：地点、时间、感受和反应，即指对他人也指对刚刚发生的事情。拖延的问题在于你通常意识不到就已经开始拖延了，因为这是一个自然而然的习惯。<strong>你可以通过关掉手机或者离开互联网或者远离其他占用碎片时间的消遣来隔离那些最具杀伤力的信号</strong>。第二个要素是惯式,假如你在学习和工作的时候经常把注意力转移到一些不那么痛苦的事情上去，一旦得到信号大脑便会自动进入这个惯式，这就是你必须主动重设旧习惯的反应信号。重置旧习惯的关键是制订一个计划，<strong>养成一个新惯例会有帮助。一些学生养成了去上课时把手机留在车里的习惯从而移除了一个十分强大的干扰源;很多学生意识到待在图书馆或者家附近某个安静的地方,或者仅是在合适的时间坐在一张喜欢的椅子上摒弃网络,效率都是很高的。</strong>你的计划可能起初并不奏效，不过请坚持下去在必要时修改计划，并在计划完成时细细品味胜利的喜悦，别试图一下子就彻底改变。第三要素是<strong>奖励 </strong>,这有时候需要做一些调查:你为什么会拖延?能否从情感上找到拖延时短暂愉悦的替代品？比如完成一件事的自豪感和满足感,即使这只是件小事你可以在内心和自己打赌较量,赢了就奖励自己享受一杯拿铁或者是逛一个你最爱的网站,或者让自己一整晚无忧无虑地看电视,或者毫无罪恶感地刷网页,然后扩大打赌目标跟奖励，可以是电影票、一件新毛衣或一次完全无所谓的购物。记住习惯的力量之所以强大是因为习惯制造了神经系统的欲望，加上一个新的奖励可以帮助你克服原先的欲望。只有当大脑开始期待那个奖励，旧习惯才能得到重置，你才能养成新习惯。很多人发现需要给奖励设定时间点，比如说午休与朋友到快餐店吃饭，或是在下午5点结束主要的任务。这样小而实在的截止期限可以激励你去工作。第四要素是<strong>信念</strong>，改变拖延习惯最重要的一点就是相信你能够做到的这个信念。你可能会发现当事情变得棘手时，你就会渴望回到那个更舒适的旧习惯去，而相信新的习惯能够奏效这一信念可以让你坚持下去。发展一个新的圈子可以为这个信念打下基础，与志同道合的朋友在一起所形成的发展和鼓励的文化氛围能够帮助我们记住那些自己脆弱时容易忘记的可贵信念<br><strong>5.允许自己休息</strong><br>允许自己娱乐消遣，准许自己为人。有时候拖延一下也未尝不可，允许自己休整，你不是机器，我们不是机器，我们需要了解能力的范畴，否则就是违背自然，自然就会报复我们，让我们付出代价，效率降低，失去创造力与幸福感。计划休息时间和计划工作时间同样重要。</p><h1 id="自己的改进方案"><a href="#自己的改进方案" class="headerlink" title="自己的改进方案"></a>自己的改进方案</h1><p>1.每周开始前先写好周计划，<strong>然后每天晚上睡前写下第二天的工作列表</strong>。<br>2.早上先做看着不顺眼的任务(今天我们组长建议是先做顺眼的，不顺眼的留到加班的时候自己静下心来做，这样容易不受外界干扰，这种方法也有其道理，两种都试一下吧)。<br>3.没做一个任务前先快速做好规划，然后快速开始，边做边修正。<br>4.在工作时把手机断网放抽屉；把电脑的qq和微信退出；<strong>每天都想好奖励自己的方法</strong>，比如看个电影，看会闲书，吃自己想吃的东西。<br>5.每周安排好每天的休息计划，比如看书计划，打乒乓球计划，电影计划，跑步计划。</p><hr><p>参考资料<br>1.哈佛大学《幸福课》14集：过犹不及<br>2.麦克马斯特大学 &amp; 美国加州大学圣地亚哥分校《学会如何学习：帮助你掌握复杂学科的强大智力工具》第三周课程：拖延</p>]]></content>
      
      <categories>
          
          <category> 专业外/心理学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 拖延 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>数据可视化系列：导论及绘图的基本元素(ggplot2实现)</title>
      <link href="/2018-08-24-%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E7%B3%BB%E5%88%97%EF%BC%9A%E5%AF%BC%E8%AE%BA%E5%8F%8A%E7%BB%98%E5%9B%BE%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%85%83%E7%B4%A0.html"/>
      <url>/2018-08-24-%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E7%B3%BB%E5%88%97%EF%BC%9A%E5%AF%BC%E8%AE%BA%E5%8F%8A%E7%BB%98%E5%9B%BE%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%85%83%E7%B4%A0.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>数据可视化系列第一弹。<br><a id="more"></a></p><h1 id="一、为什么要进行数据可视化？"><a href="#一、为什么要进行数据可视化？" class="headerlink" title="一、为什么要进行数据可视化？"></a>一、为什么要进行数据可视化？</h1><p><strong>1.相比于文字，将文字进行可视化可以让大脑能够同时处理更多的数据。例如，如果读到下面一段文字</strong></p><blockquote><p>3rd Street is to the north of 4th Street. Peach Avenue runs perpendicular to 3rd and 4th streets. On the southeast corner of 4th and Peach is a coffee shop. On the northwest corner of 3rd and Peach is a tea store.<br>How many streets does a person need to cross when walking from the coffee shop to the tea store?</p></blockquote><p>如果用文字来表述这段信息会让很多不认路的人理解起来非常困难，但是如果直接给你下面一张图：<br><img src="/images/2018-08/aed08fdd-5a9b-4057-8868-772886afee0f.png" alt="shizijie"><br>答案就一目了然了。<br><strong>2.相较于文字，可视化能够使传递出的信息更加清晰，例如如果你读到下面一段话</strong></p><blockquote><p>The cross is above the rectangle. The triangle is next to the rectangle.</p></blockquote><p>在文字中，这句话所反映出的信息就比较模棱两可：在矩形上面是十字形，三角形与矩形相邻。这个<strong>相邻</strong>就是一个模棱两可的解释，因为相邻既可以在左边，也可以在右边，前面或者后面。但是如果你用一幅图来表示这个信息的话，那么你就可以非常清楚地看清楚这三个图形的位置关系。<br><strong>3.当我们将数据可视化的时候，可以看到一些用文字无法看到的信息。</strong><br>例如下面的这个散点图：<br><img src="/images/2018-08/4dc5f52e-5ae9-4627-aaa6-8fab16590b8e.jpg" alt="scatter"><br>如果只用文字表示，那我只能看到一个个冷冰冰的数字，很难从数字中看到规律，但是如果利用散点图，我们可以清楚地看到这个些数据的变化趋势</p><blockquote><p>图中的点代表全世界每一个提供数据的国家。横轴是对国家富裕程度的一种量度，即人均GDP，通常以美元为单位；纵轴是人的预期寿命。我们预计富裕国家的人应该寿命更长些。散点图的整体形态的确反映了这种情况，但两个变量间的关系表现为有趣的形状。当人均GDP增加时，起初预期寿命急速增加，但是后来呈平稳状态。像美国这样的富国的民众，并不比比较贫穷但非最贫穷国家的人预期寿命更长。有些国家，比如哥斯达黎加，其民众的预期寿命甚至超过美国。三个非洲国家是异常值，它们的民众预期寿命与邻国差不多，但人均GDP较高，它们分别是产油国赤道几内亚、加蓬，以及出产钻石的塞拉利昂。这可能是因为出口矿产的收入主要流入了少数人的腰包从而推高了人均GDP，但并没有对普通民众的收入或预期寿命产生多大的影响。换言之，人均GDP是一个平均数，我们知道收入的平均数可能远高于收入的中位数。</p></blockquote><h1 id="二、数据可视化的主流工具有哪些？"><a href="#二、数据可视化的主流工具有哪些？" class="headerlink" title="二、数据可视化的主流工具有哪些？"></a>二、数据可视化的主流工具有哪些？</h1><table><thead><tr><th>Name</th><th>Open Source or Not</th><th>Free or not</th><th>Program or not</th></tr></thead><tbody><tr><td>Tableau</td><td>No</td><td>Public edition – Free</td><td>No</td></tr><tr><td>D3.js</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Power BI</td><td>No</td><td>No</td><td>No</td></tr><tr><td>R</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Python</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Matlab</td><td>No</td><td>No</td><td>Yes</td></tr></tbody></table><p><code>Tableau</code>和<code>Power BI</code>是比较受欢迎的商业数据可视化工具，但是这两个都是付费的，作为穷科研民工不予考虑，<code>D3.js</code>是<code>javascript</code>的一个包，IT界用的比较多，<code>Matlab</code>是数据建模用的比较多在国科大的时候教生物统计的老师曾经跟我们一通安利）。<code>Python</code>虽然现在很受欢迎，但是我之前用过后觉得绘图方面还是不如<code>R</code>。<code>R</code>在科研界用的比较多，因此作为科研民工就遵循传统，也用<code>R</code>。</p><h1 id="三、为什么要使用ggplot2？"><a href="#三、为什么要使用ggplot2？" class="headerlink" title="三、为什么要使用ggplot2？"></a>三、为什么要使用ggplot2？</h1><p>用R进行数据可视化可以有多种选择，你可以用R的基础绘图系统，也可以使用其他的包，例如<code>ggplot2</code>、<code>Lattice</code>等等。最开始我是用的基础的R绘图系统，但是用起来很多时候比较蹩脚，后来开始尝试<code>ggplot2</code>,感觉<code>ggplot2</code>才是深得我心，当然，选择<code>ggplot2</code>的不止我一个人，作为科研民工，每一个选择都要有理有据，在<code>ggplot2</code>的github上有一个页面列出了<a href="https://github.com/tidyverse/ggplot2/wiki/Why-use-ggplot2" target="_blank" rel="noopener">为什么使用ggplot2的理由</a>,这些理由是不同的人写的，因此很多观点都有重复，我个人将这些理由总结了下，可以归为四点，以下将分别说明。<br><strong>1.良好的默认设置</strong><br>相比于基础的R绘图系统，ggplot2默认的颜色设置和<strong>图形布局</strong>更为漂亮(尤其是图形布局)，你不需要知道太多的主题设置方法也能画出漂亮的图，从这一点来说，<code>ggplot2</code>的下限比基础的R绘图系统更高（当然，上限我认为<code>ggplot2</code>比起基础的R绘图系统来说也更高)，当然，我这么说很多习惯用R基础绘图的会不同意，口说无凭，直接举例子。<br>先说布局的问题，比如我现在想画一个直方图，这里R里面自带的<code>mtcars</code>数据举例，用基础的R绘图系统画出来的图是这样的<br><img src="/images/2018-08/9e06f461-cee2-43ba-acd0-b699401f4325.png" alt="scatter"><br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">hist</span><span class="params">(mtcars<span class="variable">$wt</span>,main=<span class="string">"Histgrom of wt"</span>)</span></span></span><br></pre></td></tr></table></figure></p><p>用<code>ggplot2</code>画出来的是这样的<br><img src="/images/2018-08/9308d986-5517-4825-955e-10da2bfebae0.png" alt="scatter"><br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=mtcars</span>)+</span><br><span class="line">  geom_histogram(<span class="name">mapping=aes</span>(<span class="name">x=wt</span>))</span><br></pre></td></tr></table></figure></p><p>可以明显看出，基础的R绘图的坐标轴在默认设置下连数据都难以囊括，因此这张图根本难以及格，而<code>ggplot2</code>不会出现这种问题。<br>画条形图的时候基础绘图系统也会出现类似问题:<br><strong>基础绘图</strong><br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">counts &lt;- table(<span class="name">diamonds</span>$cut)</span><br><span class="line">barplot(<span class="name">counts</span>)</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/2f484ba3-ad1a-44c8-9139-57bb5ba66029.png" alt="hist"><br>上图中坐标轴的长度比最长的部分还要短。<br><strong>ggplot2</strong><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="attribute">data</span>=diamonds)+</span><br><span class="line">  geom_bar(<span class="attribute">mapping</span>=aes(x=cut,y= <span class="built_in">..</span>count<span class="built_in">..</span>,<span class="attribute">fill</span>=cut))</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/44a581e2-abcf-495a-9edf-0002bb09e6fd.png" alt="scatter"><br><strong>2.良好的分面设定</strong><br><code>ggplot2</code>能够通过<code>facet_grid()</code>函数能够将数据依据不同的分类整齐划一地映射到不同的图形中，而基础绘图中要实现类似的功能需要使用循环，从这个角度来说，<code>ggplot2</code>能够起到四两拨千斤的作用（当然，<code>ggplot2</code>的四两拨千斤体现在很多方面，这只是一方面）。<br><strong>基础绘图</strong><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library(reshape2)</span><br><span class="line">par(<span class="attribute">mfrow</span>=c(2,4))</span><br><span class="line">days &lt;- c(<span class="string">"Thur"</span>, <span class="string">"Fri"</span>, <span class="string">"Sat"</span>, <span class="string">"Sun"</span>)</span><br><span class="line">sexes &lt;- unique(tips<span class="variable">$sex</span>)</span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> 1:length(sexes)) &#123;</span><br><span class="line">  <span class="keyword">for</span> (j <span class="keyword">in</span> 1:length(days)) &#123;</span><br><span class="line">    currdata &lt;- tips[tips<span class="variable">$day</span> == days[j] &amp; tips<span class="variable">$sex</span> == sexes[i],]</span><br><span class="line">    plot(currdata<span class="variable">$total_bill</span>, currdata<span class="variable">$tip</span>/currdata<span class="variable">$total_bill</span>,</span><br><span class="line">         <span class="attribute">main</span>=paste(days[j], sexes[i], <span class="attribute">sep</span>=<span class="string">", "</span>), <span class="attribute">ylim</span>=c(0,0.7), <span class="attribute">las</span>=1)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/4b09870c-269f-4791-8912-ac064611d686.png" alt="face1"><br><strong>ggplot2</strong><br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">reshape2</span>)</span><br><span class="line">sp &lt;- ggplot(<span class="name">tips</span>, aes(<span class="name">x=total_bill</span>, y=tip/total_bill))+ geom_point(<span class="name">shape=1</span>)</span><br><span class="line">sp + facet_grid(<span class="name">sex</span> ~ day)</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/b5b69fee-9ffc-42b2-834b-1d2ddd78fa1d.png" alt="face2"><br><strong>3.方便使用的图层系统</strong><br>在画图过程中经常会进行多种图形的叠加，比方说散点图和线图的叠加，箱线图和抖动点图的叠加，<code>ggplot2</code>的图层系统使得在叠加过程中各个图层的坐标会进行自动调节和适应以达成整齐划一的效果，例如我想在箱线图的基础上增加抖动点图，先画出箱线图<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">ggplot2</span>)</span><br><span class="line">library(<span class="name">viridis</span>)</span><br><span class="line">p &lt;- ggplot(<span class="name">data=mpg</span>,mapping=aes(<span class="name">x=class</span>,y=hwy))+</span><br><span class="line">  stat_boxplot(<span class="name">geom</span> = <span class="string">"errorbar"</span>,width=0.<span class="number">15</span>,mapping=aes(<span class="name">color=class</span>))+</span><br><span class="line">  geom_boxplot(<span class="name">mapping=aes</span>(<span class="name">color=class</span>),width=0.<span class="number">3</span>,position = <span class="string">"dodge2"</span>)+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.x=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.line=element_line(<span class="name">size=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">legend</span>.position =<span class="string">"None"</span>)+</span><br><span class="line">  #theme(<span class="name">plot</span>.background = element_rect(<span class="name">fill=</span><span class="string">"gray20"</span>))+</span><br><span class="line">  theme(<span class="name">axis</span>.title=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.text = element_text(<span class="name">colour=</span><span class="string">"black"</span>))+</span><br><span class="line">  theme(<span class="name">plot</span>.title = element_text(<span class="name">hjust=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">panel</span>.grid.major.y=element_line(<span class="name">color=</span><span class="string">"grey"</span>,linetype = <span class="number">6</span>))</span><br><span class="line">p</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/a32bf4b4-aec4-4150-86db-562ad606006a.png" alt="box1"><br>再在箱线图基础上增加抖动点<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(<span class="name">data=mpg</span>,mapping=aes(<span class="name">x=class</span>,y=hwy))+</span><br><span class="line">  stat_boxplot(<span class="name">geom</span> = <span class="string">"errorbar"</span>,width=0.<span class="number">15</span>,mapping=aes(<span class="name">color=class</span>))+</span><br><span class="line">  geom_boxplot(<span class="name">mapping=aes</span>(<span class="name">color=class</span>),width=0.<span class="number">3</span>,position = <span class="string">"dodge2"</span>,outlier.shape = NA)+</span><br><span class="line">  geom_jitter(<span class="name">width</span> = <span class="number">0.1</span>)+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.x=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.line=element_line(<span class="name">size=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">legend</span>.position =<span class="string">"None"</span>)+</span><br><span class="line">  theme(<span class="name">axis</span>.title=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.text = element_text(<span class="name">colour=</span><span class="string">"black"</span>))+</span><br><span class="line">  theme(<span class="name">plot</span>.title = element_text(<span class="name">hjust=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">panel</span>.grid.major.y=element_line(<span class="name">color=</span><span class="string">"grey"</span>,linetype = <span class="number">6</span>))</span><br><span class="line">p</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/e66cf68a-fabf-4a29-9296-dd5d91bdae40.png" alt="box2"><br><strong>4.强大实用的图形化语法</strong><br>说到底，<code>ggplot2</code>区别于基础绘图系统的最大特点就在于其强大而实用的图形化语法，而这一特点也是以上所有<code>ggplot2</code>优点所存在的基础，图形化语法的存在，使得我们从数据本身以及图形本质来理解绘图，即</p><blockquote><p>The grammar of graphics is based on the insight that you can uniquely describe any plot as a combination of a dataset, a geom, a set of mappings, a stat, a position adjustment, a coordinate system, and a faceting scheme.<br>图形化语法将任何一张图都看作是数据集、几何图形、映射关系、统计变换、位置设置、坐标系统以及分面系统的集合。</p></blockquote><p>通过这一逻辑，可以总结出一个<code>ggplot2</code>的万能公式，从而使得我们只需要掌握很少的命令就能绘制大部分的图形<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ggplot(data = <span class="tag">&lt;<span class="name">DATA</span>&gt;</span>) +    </span><br><span class="line">  <span class="tag">&lt;<span class="name">GEOM_FUNCTION</span>&gt;</span>(</span><br><span class="line">     mapping = aes(<span class="tag">&lt;<span class="name">MAPPINGS</span>&gt;</span>),</span><br><span class="line">     stat = <span class="tag">&lt;<span class="name">STAT</span>&gt;</span>, </span><br><span class="line">     position = <span class="tag">&lt;<span class="name">POSITION</span>&gt;</span></span><br><span class="line">  ) +</span><br><span class="line">  <span class="tag">&lt;<span class="name">COORDINATE_FUNCTION</span>&gt;</span> +</span><br><span class="line">  <span class="tag">&lt;<span class="name">FACET_FUNCTION</span>&gt;</span>+</span><br><span class="line">  <span class="tag">&lt;<span class="name">THEME_FUNCTION</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>该公式与<code>ggplot2</code>图形的对应关系如下</p><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">图形</th></tr></thead><tbody><tr><td style="text-align:center">data = &lt; DATA &gt;</td><td style="text-align:center">数据集,例如上面的data=mpg</td></tr><tr><td style="text-align:center">&lt; GEOM_FUNCTION &gt;</td><td style="text-align:center">几何对象，例如上面条形图的geom_bar</td></tr><tr><td style="text-align:center">stat = &lt; STAT &gt;</td><td style="text-align:center">统计变换，例如上面条形图中的默认统计为stat=”count”</td></tr><tr><td style="text-align:center">position = &lt; POSITION &gt;</td><td style="text-align:center">位置排列关系，例如上面箱线图的position = “dodge2”</td></tr><tr><td style="text-align:center">&lt; COORDINATE_FUNCTION &gt;</td><td style="text-align:center">坐标轴相关的设置函数，例如coord_flip()用于交换坐标轴</td></tr><tr><td style="text-align:center">&lt; FACET_FUNCTION &gt;</td><td style="text-align:center">分面相关函数，例如上面的facet_grid(sex ~ day)</td></tr><tr><td style="text-align:center">&lt; THEME_FUNCTION &gt;</td><td style="text-align:center">主题设置相关函数，例如theme_classic()+theme(axis.ticks.x=element_blank())</td></tr></tbody></table><p>如果想画散点图：<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data</span> = mpg) + </span><br><span class="line">  geom_point(<span class="name">mapping</span> = aes(<span class="name">x</span> = displ, y = hwy,color=class))+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  scale_color_viridis(<span class="name">discrete=TRUE</span>)</span><br></pre></td></tr></table></figure></p><p>其对应关系为</p><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">图形</th></tr></thead><tbody><tr><td style="text-align:center">data = &lt; DATA &gt;</td><td style="text-align:center">data = mpg</td></tr><tr><td style="text-align:center">&lt; GEOM_FUNCTION &gt;</td><td style="text-align:center">几何对象，geom_point(mapping = aes(x = displ, y = hwy,color=class))</td></tr><tr><td style="text-align:center">stat = &lt; STAT &gt;</td><td style="text-align:center">默认统计为stat=”identity”</td></tr><tr><td style="text-align:center">position = &lt; POSITION &gt;</td><td style="text-align:center">默认</td></tr><tr><td style="text-align:center">&lt; COORDINATE_FUNCTION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; FACET_FUNCTION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; THEME_FUNCTION &gt;</td><td style="text-align:center">theme_classic()+scale_color_viridis(discrete=TRUE)</td></tr></tbody></table><p><img src="/images/2018-08/43d519c3-7d4b-449b-a3fb-2be1398ea879.png" alt="scatter2"><br>如果想画条形图：<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data</span> = diamonds) + </span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,fill=cut))+</span><br><span class="line">  theme_classic()</span><br></pre></td></tr></table></figure></p><p>其对应关系为</p><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">图形</th></tr></thead><tbody><tr><td style="text-align:center">data = &lt; DATA &gt;</td><td style="text-align:center">data = diamonds</td></tr><tr><td style="text-align:center">&lt; GEOM_FUNCTION &gt;</td><td style="text-align:center">geom_bar(mapping=aes(x=cut,fill=cut))</td></tr><tr><td style="text-align:center">stat = &lt; STAT &gt;</td><td style="text-align:center">默认stat=”count”</td></tr><tr><td style="text-align:center">position = &lt; POSITION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; COORDINATE_FUNCTION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; FACET_FUNCTION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; THEME_FUNCTION &gt;</td><td style="text-align:center">theme_classic()</td></tr></tbody></table><p><img src="/images/2018-08/11.png" alt="bar2"><br>如果想画箱线图：<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data</span> = mpg,mapping=aes(<span class="name">x=class</span>,y=hwy)) + </span><br><span class="line">  stat_boxplot(<span class="name">geom</span> = <span class="string">"errorbar"</span>,width=0.<span class="number">15</span>)+</span><br><span class="line">  geom_boxplot(<span class="name">width=0</span>.<span class="number">3</span>)+</span><br><span class="line">  theme_classic()</span><br></pre></td></tr></table></figure></p><p>对应关系为</p><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">图形</th></tr></thead><tbody><tr><td style="text-align:center">data = &lt; DATA &gt;</td><td style="text-align:center">data = mpg</td></tr><tr><td style="text-align:center">&lt; GEOM_FUNCTION &gt;</td><td style="text-align:center">stat_boxplot(geom = “errorbar”,width=0.15)</td></tr><tr><td style="text-align:center">stat = &lt; STAT &gt;</td><td style="text-align:center">默认stat=”identity”</td></tr><tr><td style="text-align:center">position = &lt; POSITION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; COORDINATE_FUNCTION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; FACET_FUNCTION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; THEME_FUNCTION &gt;</td><td style="text-align:center">theme_classic()</td></tr></tbody></table><p><img src="/images/2018-08/12.png" alt="box5"><br>直方图<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_histogram(<span class="name">mapping=aes</span>(<span class="name">x=carat</span>),binwidth=0.<span class="number">5</span>)+</span><br><span class="line">  theme_classic()</span><br></pre></td></tr></table></figure></p><p>对应关系</p><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">图形</th></tr></thead><tbody><tr><td style="text-align:center">data = &lt; DATA &gt;</td><td style="text-align:center">data=diamonds</td></tr><tr><td style="text-align:center">&lt; GEOM_FUNCTION &gt;</td><td style="text-align:center">geom_histogram(mapping=aes(x=carat),binwidth=0.5)</td></tr><tr><td style="text-align:center">stat = &lt; STAT &gt;</td><td style="text-align:center">默认stat=”count”</td></tr><tr><td style="text-align:center">position = &lt; POSITION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; COORDINATE_FUNCTION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; FACET_FUNCTION &gt;</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">&lt; THEME_FUNCTION &gt;</td><td style="text-align:center">theme_classic()</td></tr></tbody></table><p><img src="/images/2018-08/13.png" alt="hist3"><br>甚至于热图<br><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">pres_rating</span> &lt;- <span class="class"><span class="keyword">data</span>.frame(</span></span><br><span class="line"><span class="class">  <span class="title">rating</span> = <span class="title">as</span>.<span class="title">numeric</span>(<span class="title">presidents</span>),</span></span><br><span class="line">  year = <span class="keyword">as</span>.numeric(floor(time(presidents))),</span><br><span class="line">  quarter = <span class="keyword">as</span>.numeric(cycle(presidents))</span><br><span class="line">)</span><br><span class="line"><span class="title">p</span> &lt;- ggplot(<span class="class"><span class="keyword">data</span>=pres_rating, mapping=aes(<span class="title">x</span>=<span class="title">year</span>, <span class="title">y</span>=<span class="title">quarter</span>, <span class="title">fill</span>=<span class="title">rating</span>))+</span></span><br><span class="line">  geom_raster()+</span><br><span class="line">  theme_classic()</span><br><span class="line"><span class="title">p</span></span><br></pre></td></tr></table></figure></p><p>对应关系</p><table><thead><tr><th>命令</th><th>图形</th></tr></thead><tbody><tr><td>data = &lt; DATA &gt;</td><td>data=pres_rating</td></tr><tr><td>&lt; GEOM_FUNCTION &gt;</td><td>geom_raster()</td></tr><tr><td>stat = &lt; STAT &gt;</td><td>默认stat=”identity”</td></tr><tr><td>position = &lt; POSITION &gt;</td><td>无</td></tr><tr><td>&lt; COORDINATE_FUNCTION &gt;</td><td>无</td></tr><tr><td>&lt; FACET_FUNCTION &gt;</td><td>无</td></tr><tr><td>&lt; THEME_FUNCTION &gt;</td><td>theme_classic()</td></tr></tbody></table><p><img src="/images/2018-08/455cbe01-1956-4328-affe-a979d010f0bf.png" alt="hest"><br>所有的这些绘图都可以用统一的语法格式概括到一起,当然每个图形都有一些细微的参数不太一样，但是这依然给我们带来了很多便利，提高了我们对于数据与图表对应关系的理解，方便了我们画不同的图形。</p><h1 id="四、基本的图形元素及使用原则"><a href="#四、基本的图形元素及使用原则" class="headerlink" title="四、基本的图形元素及使用原则"></a>四、基本的图形元素及使用原则</h1><p>坐标轴、轴须和坐标方格这些都属于导航元素(navigational elements), 这些导航元素提供了标准并帮助我们准确地获得长度以及比例的相关信息。这些元素在作图中需要保持以下原则：<br><strong>1.总原则</strong>：必须与数据信息明显地区别开来，任何时候都要保持一个高 数据/墨水 比例，也就是说导航元素用尽可能少的墨水。下图fig 1a中由于没有将数据与线条区别开，导致读者很难快速从图中获得信息，而fig 1b则运用不同的颜色和透明度将数据与线条有效区分开，使人一目了然。<br><img src="/images/2018-08/a0ac611e-48e2-4ac8-b190-e646e402f793.png" alt="exm18"><br><strong>2.坐标轴</strong><br>(1)坐标轴线条的宽度应当适度，0.5pt（像素点）就够了。(2)除非图片特别大，否则不能将坐标轴置于画布的边缘。（3）不要在坐标轴上加箭头，因为坐标轴的方向从来都不用怀疑。（4）多个图片一起放置时应该保持坐标轴刻度统一，因为在多图片比较时坐标轴范围的变化很容易被忽略，从而引起误导。如果想保持统一性，可以使用坐标中断（axis breaks），但是有些杂志不允许使用坐标中断，并且坐标中断很可能会掩饰一些很重要的pattern。<br><img src="/images/2018-08/0183435f-d810-4e91-8b7c-a5a03974661c.png" alt="exm1"><br><strong>3.轴须：轴须要尽可能地少，因为如果轴须太多会增加图形的复杂性和认知负担。</strong><br><img src="/images/2018-08/5323f45b-741d-4af4-b9df-e1aed5329a60.png" alt="exm2"><br><strong>4.坐标方格：坐标方格的使用常常就是用浅色线条来用于比较比例和坐标轴轴须的相对位置。</strong><br>（1）横线越多，读者就会越意识到数据的轻微波动。但是不要错误地使用坐标网格，因为坐标网格太密集会影响读者对数据的准确判断。总的来说，当你不知道怎么使用坐标网格时就不要使用它。<br><img src="/images/2018-08/49db82cc-0253-4c04-a820-7dbf81bfe724.png" alt="exm3"><br>（2）坐标方格的颜色不能太深，否则会影响读者对数据的判断。建议网格不透明度在15%-45%之间，可以依数据密度来调整。<br><img src="/images/2018-08/f3d79836-96ca-4672-888e-c8bf35f6f01b.png" alt="exm4"><br>5.基本图形原则<code>ggplot2</code>的实现<br>下面就运用以上的原则来用<code>ggplot2</code>进行实践，比方说如果我想画一个条形图，<br>(1)一开始画图是这样的<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/4dec1be2-4aa2-451e-b270-680fe8c2b7b3.png" alt="bar4"><br>(2)很多人觉得<code>ggplot2</code>这个灰色背景太烂大街了，于是去掉<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()+</span><br><span class="line">  theme_classic()</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/2.png" alt="bar5"><br>(3)前面说了，应该去除不必要的轴须，y轴的轴须就是不必要的：<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y=element_blank())</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/3.png" alt="bar6"><br>(4)坐标轴线的宽度设为<strong>0.5</strong><br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.line=element_line(<span class="name">size=0</span>.<span class="number">5</span>))</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/4.png" alt="bar7"><br>(5)调整边缘，使得图像不充满画布<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.line=element_line(<span class="name">size=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">plot</span>.margin = margin(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">"cm"</span>))</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/5.png" alt="bar8"><br>(6)由于图例与坐标轴纵轴表现的分类信息重复，因此我们要去除冗余信息，去掉图例<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.line=element_line(<span class="name">size=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">plot</span>.margin = margin(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">"cm"</span>))+</span><br><span class="line">  theme(<span class="name">legend</span>.position = <span class="string">"None"</span>)</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/6.png" alt="bar9"><br>(7)x轴和y轴的标题看着也很碍眼<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.line=element_line(<span class="name">size=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">plot</span>.margin = margin(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">"cm"</span>))+</span><br><span class="line">  theme(<span class="name">legend</span>.position = <span class="string">"None"</span>)+</span><br><span class="line">  theme(<span class="name">axis</span>.title = element_blank())</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/7.png" alt="bar10"><br>(8)向图中添加标题并使之居中<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.line=element_line(<span class="name">size=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">plot</span>.margin = margin(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">"cm"</span>))+</span><br><span class="line">  theme(<span class="name">legend</span>.position = <span class="string">"None"</span>)+</span><br><span class="line">  theme(<span class="name">axis</span>.title = element_blank())+</span><br><span class="line">  ggtitle(<span class="string">"The distribution of cut"</span>)+</span><br><span class="line">  theme(<span class="name">plot</span>.title = element_text(<span class="name">hjust=0</span>.<span class="number">5</span>))</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/8.png" alt="bar11"><br>(9)x轴和y轴的标签是灰色的，看着不太显眼<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.line=element_line(<span class="name">size=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">plot</span>.margin = margin(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">"cm"</span>))+</span><br><span class="line">  theme(<span class="name">legend</span>.position = <span class="string">"None"</span>)+</span><br><span class="line">  theme(<span class="name">axis</span>.title = element_blank())+</span><br><span class="line">  ggtitle(<span class="string">"The distribution of cut"</span>)+</span><br><span class="line">  theme(<span class="name">plot</span>.title = element_text(<span class="name">hjust=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">axis</span>.text = element_text(<span class="name">colour=</span><span class="string">"black"</span>))</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/9.png" alt="bar12"><br>(10)最后，添加网格线以便于查看数据分布情况<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data=diamonds</span>)+</span><br><span class="line">  geom_bar(<span class="name">mapping=aes</span>(<span class="name">x=cut</span>,y=..count..,fill=cut))+</span><br><span class="line">  coord_flip()+</span><br><span class="line">  theme_classic()+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.line=element_line(<span class="name">size=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">plot</span>.margin = margin(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">"cm"</span>))+</span><br><span class="line">  theme(<span class="name">legend</span>.position = <span class="string">"None"</span>)+</span><br><span class="line">  theme(<span class="name">axis</span>.title = element_blank())+</span><br><span class="line">  ggtitle(<span class="string">"The distribution of cut"</span>)+</span><br><span class="line">  theme(<span class="name">plot</span>.title = element_text(<span class="name">hjust=0</span>.<span class="number">5</span>))+</span><br><span class="line">  theme(<span class="name">axis</span>.text = element_text(<span class="name">colour=</span><span class="string">"black"</span>))+</span><br><span class="line">  theme(<span class="name">panel</span>.grid.major.x=element_line(<span class="name">color=</span><span class="string">"grey"</span>,linetype = <span class="number">6</span>))</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-08/10.png" alt="bar13"></p><hr><p>参考资料<br>1.Schwartz, Daniel L., Jessica M. Tsang, and Kristen P. Blair. The ABCs of how we learn: 26 scientifically proven approaches, how they work, and when to use them. WW Norton &amp; Company, 2016.<br>2.Moore, David S., William I. Notz, and William Notz. Statistics: Concepts and controversies. Macmillan, 2009.<br>3.Why we love these 5 data visualization tools: <a href="https://www.softwebsolutions.com/resources/five-data-visualization-tools.html" target="_blank" rel="noopener">https://www.softwebsolutions.com/resources/five-data-visualization-tools.html</a><br>4.Why use ggplot2:<a href="https://github.com/tidyverse/ggplot2/wiki/Why-use-ggplot2" target="_blank" rel="noopener">https://github.com/tidyverse/ggplot2/wiki/Why-use-ggplot2</a><br>5.Comparing ggplot2 and R Base Graphics : <a href="https://flowingdata.com/2016/03/22/comparing-ggplot2-and-r-base-graphics/" target="_blank" rel="noopener">https://flowingdata.com/2016/03/22/comparing-ggplot2-and-r-base-graphics/</a><br>6.Wickham, H. and G. Grolemund (2016). R for Data Science: Import, Tidy, Transform, Visualize, and Model Data, O’Reilly Media.<br>7.Krzywinski, M. (2013). “Axes, ticks and grids.” Nature methods 10: 183.</p>]]></content>
      
      <categories>
          
          <category> 专业内/数据可视化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>滇行漫记</title>
      <link href="/2018-08-11-%E6%BB%87%E8%A1%8C%E6%BC%AB%E8%AE%B0.html"/>
      <url>/2018-08-11-%E6%BB%87%E8%A1%8C%E6%BC%AB%E8%AE%B0.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/images/2018-08/洱海.jpg" alt="erhai1"><br>多年以后，面对洱海边上漂浮的水葫芦，他将会想起观看《心花路放》的那个下午。</p><a id="more"></a>        <div id="aplayer-nUxrCtrZ" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-nUxrCtrZ"),            narrow: false,            autoplay: true,            showlrc: false,            music: {              title: "悲情城市",              author: "S.E.N.S",              url: "http://p76pxmjnt.bkt.clouddn.com/S.E.N.S.%20-%20%E6%82%B2%E6%83%85%E5%9F%8E%E5%B8%82%20~A%20City%20of%20Sadness.mp3",              pic: "/2018-08-11-滇行漫记/TIM图片2018081122423.png",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><hr><p>2014年上映的《心花路放》让我印象最为深刻的不是其引人入胜的叙事结构，而是电影中俯拾皆是清新明丽的云南风光。而电影中的那首插曲《去大理》中唱到<code>也许爱情就在洱海边等着，也许故事正在发生着</code>让大理又多了一层浪漫主义的幻想，让我从那时起就有了去云南看一看的念想。但是念想终究是念想，无奈自己对于旅行总有一种恐惧，使得始终难以迈开这一步。说来也巧，这个暑假本来想拿出几天去云南转一转，正好知道廖（niao）同学和她的同学们已经买好了去云南的机票，于是我们寝室几个人也加入了他们的云南之行，这一次,念想终于照进了现实。<br><img src="/images/2018-08/洱海1.jpg" alt="erhai"><br>我们的第一个目的地是大理，一行6人租了3个电瓶车来环绕洱海骑行。幸运的是，环洱海的前一天大理还在阴雨连绵，我们环洱海的当天却天气晴朗，蓝天白云，使得我们得以饱览洱海的美景。顺着洱海边行驶，首先映入眼帘的是拥挤地漂浮在洱海岸边的水葫芦，水葫芦的下面和前方是水质已经有些泛黑的洱海，岸边不时有一些挖掘机在把洱海边上的水葫芦拖到岸上，而洱海岸边的墙壁上随处可见<code>洱海清，大理兴</code>这样宣传保护洱海的标语。好在沿着洱海边继续骑行，那些水葫芦终于暂时消失了踪影，我们也终于找到了一处适合拍照的地方。洱海从脚下向远方伸展，直到触及苍山并与其融为一体，有了蓝天白云作底，我们就好像面对着一个巨大的舞台，身体虽然还在岸边，但是灵魂已经在这舞台上手之舞之足之蹈之。洱海的美并不在于洱海，若单论洱海，其水质的质地和清澈程度远远不及深圳的杨梅坑，但是洱海背靠着苍山，头顶着比深圳更加清澈的蓝天白云，当这三者融为一体时，一切都起了变化。同样，苍山的美也不在于苍山而在于洱海，单论苍山本身不过与中国大大小小的名山大川并无太大区别，但是从苍山之上俯瞰下去，大理古城和大理古城包裹的洱海尽收眼底，上帝视角也不过如此。<br>旅途的第二站是丽江。本来我们计划去玉龙雪山，一来由于费用问题和旅行社出现了龃龉，二来在于八月份的玉龙雪山实在是没有什么过人之处：每年只有在12月和1月2月的时候玉龙雪山上才会有雪，如果山上没雪，那么它不就是<code>玉龙山</code>而不是<code>玉龙雪山</code>?只是看一个玉龙山就不值得我们耗费那么多财力和人力，但是玉龙雪山没雪这个事情旅行社不会告诉你，也许这是丽江旅游行业内公开的秘密，所以才会导致很多人在登上了玉龙雪山后心生疑惑：玉龙雪山怎么没雪呢？与玉龙雪山的宣传相似的一个宣传莫过于丽江<code>艳遇之都</code>这个标签了，这一次我们一行6人并未去丽江的酒吧，因此无从验证<code>艳遇之都</code>这个标签的准确性，但是我向来对于那些廉价的美好事物抱有很高的警惕：如果真的有这么多好事，为什么会轮的上你？细细想来，<code>艳遇之都</code>这个名号也许不过是丽江旅游局为了宣传丽江而包装出来的一句口号而已。没有听过在丽江收获艳遇的，听得更多的是抱着收获艳遇的目的最后却只收获了一大笔酒水费的故事。<br><img src="/images/2018-08/P80806-140809.jpg" alt="lanyuegu"><br>虽然没有去玉龙雪山，但是我们去了玉龙雪山山脚下的蓝月谷。坐着景区的公交车到达蓝月谷后，向前走几步便能看见一汪清澈的蓝色湖水，这湖水就像一块玉石，蓝色从外而内深入到骨髓，却又清澈透亮，湖底的石头和植物清晰可见。这一汪蓝色湖水又因背着玉龙雪山，在蓝天白云下愈发显得高贵和优雅。在湖水边行走不时能见到来这里拍婚纱照的男男女女。<br><img src="/images/2018-08/P80808-182742.jpg" alt="puzhehei"><br>旅途的终点站是普者黑。普者黑让我们充分体会了大自然鬼斧神工的力量，相较于大理丽江的名声在外，普者黑的名号并没有那么响亮，很多人都是由于《爸爸去哪儿》和《三生三世十里桃花》才知道的这个地方。由于矿物质的侵蚀，普者黑形成了独特的喀斯特地貌，随便找一处望去就可见一片片孤峰伫立在田野之上，湖泊、沼泽、田野和房屋纵横交错，星罗棋布。沿着湖边行走，在蓝天的映衬下，一座座驼峰似的山峰倒映在湖面上，远处能看见蚂蚁似的游船，此时此景，让我想到王家卫《东邪西毒》里那首配乐的名字：天地孤影任我行。沿着山路行走，总能看到由于冲击所形成的小山洞，这总让我想起陶渊明的《桃花源记》：林尽水源，便得一山，山有小口，仿佛若有光。但是这里不是桃花源的入口，而是出口，因为如果这个世界上真的存在桃花源，那么一定是普者黑的模样。普者黑的景象总让人想到桂林，<code>桂林山水甲天下</code>已经写进了课本，普者黑虽已游人如织，但是相对于大理、丽江和桂林来说，它还是偏居一隅，惊醒少数人。<br><img src="/images/2018-08/P80808-160632.jpg" alt="puzhehei1"><br>云南之行让我了却了这几年一直以来的愿望，但是在云南之行中我一直在想一个问题：旅行的意义是什么？在云南行之前我一直处于身心俱疲的状态，也积压着一些问题，这让我出行前像《心花路放》里的黄渤一样以为旅行能够解决这些问题，就像《去大理》里面唱的那样，也像很多文艺作品和广告中宣传的那样，他们总是让人以为生活很简单，解决生活中的问题很简单，但是生活的残酷一再提醒我们：旅行只是旅行，问题是问题，旅行只是让自己头脑中那根弹簧放松一下，它并不能解决生活中的问题，而旅行途中更会产生新的问题，这些问题都需要解决，旅行只会不断提醒自己：要去自己直面问题，解决问题。直面问题是过去，现在，也是将来一直以来的主题。就像杨德昌《一一》告诉我们的那样：不同的年龄会有不同的生存压力和问题，小至10岁的洋洋，大至六十多岁的婆婆，每个人都有自己的疼痛和问题要去面对，无可遁逃。</p>]]></content>
      
      <categories>
          
          <category> 杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 杂记 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>对特定的坐标轴标签进行标记</title>
      <link href="/2018-07-26-%E5%AF%B9%E7%89%B9%E5%AE%9A%E7%9A%84%E5%9D%90%E6%A0%87%E8%BD%B4%E6%A0%87%E7%AD%BE%E8%BF%9B%E8%A1%8C%E9%A2%9C%E8%89%B2%E6%A0%87%E8%AE%B0.html"/>
      <url>/2018-07-26-%E5%AF%B9%E7%89%B9%E5%AE%9A%E7%9A%84%E5%9D%90%E6%A0%87%E8%BD%B4%E6%A0%87%E7%AD%BE%E8%BF%9B%E8%A1%8C%E9%A2%9C%E8%89%B2%E6%A0%87%E8%AE%B0.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>我们经常会遇到这种情况：需要把特定的坐标轴标签用不同的颜色进行高亮。<br><a id="more"></a><br>例如我们画这么一幅图：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>,<span class="string">"d"</span>,<span class="string">"e"</span>,<span class="string">"f"</span>)</span><br><span class="line">y &lt;- c(<span class="string">"10"</span>, <span class="string">"9"</span>,<span class="string">"-10"</span>,<span class="string">"11"</span>,<span class="string">"-3"</span>,<span class="string">"-15"</span>)</span><br><span class="line">data &lt;- data.frame(x, y)</span><br><span class="line">data<span class="variable">$y</span> &lt;- as.numeric(as.character(data<span class="variable">$y</span>))</span><br><span class="line">data<span class="variable">$category</span> &lt;- ifelse(as.numeric(data<span class="variable">$y</span>)&lt;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">data<span class="variable">$category</span> &lt;- as.factor(data<span class="variable">$category</span>)</span><br><span class="line">#Graph</span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(cowplot)</span></span> #theme</span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(ggplot2)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ggplot</span><span class="params">(data, aes(x=x, y=y)</span></span>) + </span><br><span class="line">  geom_bar(stat = <span class="string">"identity"</span>, aes(fill=category)) +</span><br><span class="line">  theme(axis<span class="selector-class">.text</span><span class="selector-class">.x</span> = element_text(angle = <span class="number">45</span>, hjust = <span class="number">1</span>)) +</span><br><span class="line">  theme(axis<span class="selector-class">.text</span><span class="selector-class">.x</span> = element_text(colour = <span class="string">"black"</span>))</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-07/b9377063-8fa9-4168-b9b7-67370f27e683.png" alt="heatmap"><br>这个画图里面用到了一个比较抽象的<code>ifelse()</code>函数，该函数<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">ifelse</span><span class="params">(b,u,v)</span></span></span><br></pre></td></tr></table></figure></p><p>其中b是一个布尔向量，通常为一个判断值，u和v为向量。如果b[i]为真，则返回的第i个与秦素为u[i],如果b[i]为假，则返回的第i个元素为v[i]。例如：<br><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; x &lt;- 1:10</span><br><span class="line">&gt; x</span><br><span class="line"> [1]<span class="number"> 1 </span>2<span class="number"> 3 </span>4<span class="number"> 5 </span>6<span class="number"> 7 </span>8<span class="number"> 9 </span>10</span><br><span class="line">&gt; y &lt;- ifelse(x %% 2==0,5,12)</span><br><span class="line">&gt; y</span><br><span class="line"> [1]<span class="number"> 12 </span>5<span class="number"> 12 </span>5<span class="number"> 12 </span>5<span class="number"> 12 </span>5<span class="number"> 12 </span>5   <span class="comment">###如果能被2整除，则返回5，如果不能则返回12</span></span><br></pre></td></tr></table></figure></p><p>然而如果我们想将<code>x</code>轴小于0的标签标为红色，应该如何操作？<br>可以先根据data$category来进行判断，指定每个向量的颜色：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> &lt;- ifelse(data<span class="variable">$category</span> == <span class="number">0</span>, <span class="string">"red"</span>, <span class="string">"blue"</span>)</span><br></pre></td></tr></table></figure></p><p>然后<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">data</span>, aes(<span class="name">x</span> = x, y = y)) + </span><br><span class="line">  geom_bar(<span class="name">stat</span> = <span class="string">"identity"</span>, aes(<span class="name">fill</span> = category)) +</span><br><span class="line">  theme(<span class="name">axis</span>.text.x = element_text(<span class="name">angle</span> = <span class="number">45</span>, hjust = <span class="number">1</span>, colour = a))</span><br></pre></td></tr></table></figure></p><p>其中向量<code>a</code>的内容如下：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; a</span><br><span class="line">[<span class="number">1</span>] <span class="string">"blue"</span> <span class="string">"blue"</span> <span class="string">"red"</span> <span class="string">"blue"</span> <span class="string">"red"</span> <span class="string">"red"</span></span><br></pre></td></tr></table></figure></p><p>其中<code>theme()</code>中的<code>colour=a</code>是将<code>a</code>这个指定颜色的向量透射到<code>colour</code>上,于是生成如下的图：<br><img src="/images/2018-07/993fd14c-0f16-48ef-81a4-0b87d9dd10e0.png" alt="heatmap"><br>完整代码：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>,<span class="string">"d"</span>,<span class="string">"e"</span>,<span class="string">"f"</span>)</span><br><span class="line">y &lt;- c(<span class="string">"10"</span>, <span class="string">"9"</span>,<span class="string">"-10"</span>,<span class="string">"11"</span>,<span class="string">"-3"</span>,<span class="string">"-15"</span>)</span><br><span class="line">data &lt;- data.frame(x, y)</span><br><span class="line">data<span class="variable">$y</span> &lt;- as.numeric(as.character(data<span class="variable">$y</span>))</span><br><span class="line"></span><br><span class="line">data<span class="variable">$category</span> &lt;- ifelse(as.numeric(data<span class="variable">$y</span>)&lt;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">data<span class="variable">$category</span> &lt;- as.factor(data<span class="variable">$category</span>)</span><br><span class="line"></span><br><span class="line">#Graph</span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(cowplot)</span></span> #theme</span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(ggplot2)</span></span></span><br><span class="line"><span class="selector-tag">a</span> &lt;- ifelse(data<span class="variable">$category</span> == <span class="number">0</span>, <span class="string">"red"</span>, <span class="string">"blue"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ggplot</span><span class="params">(data, aes(x = x, y = y)</span></span>) + </span><br><span class="line">  geom_bar(stat = <span class="string">"identity"</span>, aes(fill = category)) +</span><br><span class="line">  theme(axis<span class="selector-class">.text</span><span class="selector-class">.x</span> = element_text(angle = <span class="number">45</span>, hjust = <span class="number">1</span>, colour = a))</span><br></pre></td></tr></table></figure></p><hr><p>参考：</p><ol><li><a href="https://stackoverflow.com/questions/38862303/customize-ggplot2-axis-labels-with-different-colors" target="_blank" rel="noopener">https://stackoverflow.com/questions/38862303/customize-ggplot2-axis-labels-with-different-colors</a></li><li>《R语言编程艺术》2.9</li></ol>]]></content>
      
      <categories>
          
          <category> 生信/R </category>
          
          <category> 绘图 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 绘图 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>用ggplot2绘制热图</title>
      <link href="/2018-07-26-%E7%94%A8ggplot2%E7%BB%98%E5%88%B6%E7%83%AD%E5%9B%BE.html"/>
      <url>/2018-07-26-%E7%94%A8ggplot2%E7%BB%98%E5%88%B6%E7%83%AD%E5%9B%BE.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>热图算是各种途中有点复杂的一类图，但是其实画起来并不难。本文中的代码参考了《R数据可视化手册》的13.6，并在此基础上加以改进。</p><a id="more"></a><p>1.数据准备<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">pres_rating &lt;- data.frame(</span><br><span class="line">  rating = as.numeric(presidents),</span><br><span class="line">  year = as.numeric(floor(time(presidents))),</span><br><span class="line">  quarter = as.numeric(cycle(presidents))</span><br><span class="line">)</span><br><span class="line">pres_rating</span><br><span class="line">rating year quarter</span><br><span class="line"><span class="number">1</span> NA <span class="number">1945</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">87</span> <span class="number">1945</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">82</span> <span class="number">1945</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span> <span class="number">75</span> <span class="number">1945</span> <span class="number">4</span></span><br><span class="line"><span class="number">5</span> <span class="number">63</span> <span class="number">1946</span> <span class="number">1</span></span><br><span class="line"><span class="number">6</span> <span class="number">50</span> <span class="number">1946</span> <span class="number">2</span></span><br><span class="line"><span class="number">7</span> <span class="number">43</span> <span class="number">1946</span> <span class="number">3</span></span><br><span class="line"><span class="number">8</span> <span class="number">32</span> <span class="number">1946</span> <span class="number">4</span></span><br><span class="line"><span class="number">9</span> <span class="number">35</span> <span class="number">1947</span> <span class="number">1</span></span><br><span class="line"><span class="number">10</span> <span class="number">60</span> <span class="number">1947</span> <span class="number">2</span></span><br><span class="line"><span class="number">11</span> <span class="number">54</span> <span class="number">1947</span> <span class="number">3</span></span><br><span class="line"><span class="number">12</span> <span class="number">55</span> <span class="number">1947</span> <span class="number">4</span></span><br><span class="line"><span class="number">13</span> <span class="number">36</span> <span class="number">1948</span> <span class="number">1</span></span><br><span class="line"><span class="number">14</span> <span class="number">39</span> <span class="number">1948</span> <span class="number">2</span></span><br><span class="line"><span class="number">15</span> NA <span class="number">1948</span> <span class="number">3</span></span><br><span class="line"><span class="number">16</span> NA <span class="number">1948</span> <span class="number">4</span></span><br><span class="line"><span class="number">17</span> <span class="number">69</span> <span class="number">1949</span> <span class="number">1</span></span><br><span class="line"><span class="number">18</span> <span class="number">57</span> <span class="number">1949</span> <span class="number">2</span></span><br><span class="line"><span class="number">19</span> <span class="number">57</span> <span class="number">1949</span> <span class="number">3</span></span><br><span class="line"><span class="number">20</span> <span class="number">51</span> <span class="number">1949</span> <span class="number">4</span></span><br><span class="line"><span class="number">21</span> <span class="number">45</span> <span class="number">1950</span> <span class="number">1</span></span><br><span class="line"><span class="number">22</span> <span class="number">37</span> <span class="number">1950</span> <span class="number">2</span></span><br><span class="line"><span class="number">23</span> <span class="number">46</span> <span class="number">1950</span> <span class="number">3</span></span><br><span class="line"><span class="number">24</span> <span class="number">39</span> <span class="number">1950</span> <span class="number">4</span></span><br><span class="line"><span class="number">25</span> <span class="number">36</span> <span class="number">1951</span> <span class="number">1</span></span><br><span class="line"><span class="number">26</span> <span class="number">24</span> <span class="number">1951</span> <span class="number">2</span></span><br><span class="line"><span class="number">27</span> <span class="number">32</span> <span class="number">1951</span> <span class="number">3</span></span><br><span class="line"><span class="number">28</span> <span class="number">23</span> <span class="number">1951</span> <span class="number">4</span></span><br><span class="line"><span class="number">29</span> <span class="number">25</span> <span class="number">1952</span> <span class="number">1</span></span><br><span class="line"><span class="number">30</span> <span class="number">32</span> <span class="number">1952</span> <span class="number">2</span></span><br><span class="line"><span class="number">31</span> NA <span class="number">1952</span> <span class="number">3</span></span><br><span class="line"><span class="number">32</span> <span class="number">32</span> <span class="number">1952</span> <span class="number">4</span></span><br><span class="line"><span class="number">33</span> <span class="number">59</span> <span class="number">1953</span> <span class="number">1</span></span><br><span class="line"><span class="number">34</span> <span class="number">74</span> <span class="number">1953</span> <span class="number">2</span></span><br><span class="line"><span class="number">35</span> <span class="number">75</span> <span class="number">1953</span> <span class="number">3</span></span><br><span class="line"><span class="number">36</span> <span class="number">60</span> <span class="number">1953</span> <span class="number">4</span></span><br><span class="line"><span class="number">37</span> <span class="number">71</span> <span class="number">1954</span> <span class="number">1</span></span><br><span class="line"><span class="number">38</span> <span class="number">61</span> <span class="number">1954</span> <span class="number">2</span></span><br><span class="line"><span class="number">39</span> <span class="number">71</span> <span class="number">1954</span> <span class="number">3</span></span><br><span class="line"><span class="number">40</span> <span class="number">57</span> <span class="number">1954</span> <span class="number">4</span></span><br><span class="line"><span class="number">41</span> <span class="number">71</span> <span class="number">1955</span> <span class="number">1</span></span><br><span class="line"><span class="number">42</span> <span class="number">68</span> <span class="number">1955</span> <span class="number">2</span></span><br><span class="line"><span class="number">43</span> <span class="number">79</span> <span class="number">1955</span> <span class="number">3</span></span><br><span class="line"><span class="number">44</span> <span class="number">73</span> <span class="number">1955</span> <span class="number">4</span></span><br><span class="line"><span class="number">45</span> <span class="number">76</span> <span class="number">1956</span> <span class="number">1</span></span><br><span class="line"><span class="number">46</span> <span class="number">71</span> <span class="number">1956</span> <span class="number">2</span></span><br><span class="line"><span class="number">47</span> <span class="number">67</span> <span class="number">1956</span> <span class="number">3</span></span><br><span class="line"><span class="number">48</span> <span class="number">75</span> <span class="number">1956</span> <span class="number">4</span></span><br><span class="line"><span class="number">49</span> <span class="number">79</span> <span class="number">1957</span> <span class="number">1</span></span><br><span class="line"><span class="number">50</span> <span class="number">62</span> <span class="number">1957</span> <span class="number">2</span></span><br><span class="line"><span class="number">51</span> <span class="number">63</span> <span class="number">1957</span> <span class="number">3</span></span><br><span class="line"><span class="number">52</span> <span class="number">57</span> <span class="number">1957</span> <span class="number">4</span></span><br><span class="line"><span class="number">53</span> <span class="number">60</span> <span class="number">1958</span> <span class="number">1</span></span><br><span class="line"><span class="number">54</span> <span class="number">49</span> <span class="number">1958</span> <span class="number">2</span></span><br><span class="line"><span class="number">55</span> <span class="number">48</span> <span class="number">1958</span> <span class="number">3</span></span><br><span class="line"><span class="number">56</span> <span class="number">52</span> <span class="number">1958</span> <span class="number">4</span></span><br><span class="line"><span class="number">57</span> <span class="number">57</span> <span class="number">1959</span> <span class="number">1</span></span><br><span class="line"><span class="number">58</span> <span class="number">62</span> <span class="number">1959</span> <span class="number">2</span></span><br><span class="line"><span class="number">59</span> <span class="number">61</span> <span class="number">1959</span> <span class="number">3</span></span><br><span class="line"><span class="number">60</span> <span class="number">66</span> <span class="number">1959</span> <span class="number">4</span></span><br><span class="line"><span class="number">61</span> <span class="number">71</span> <span class="number">1960</span> <span class="number">1</span></span><br><span class="line"><span class="number">62</span> <span class="number">62</span> <span class="number">1960</span> <span class="number">2</span></span><br><span class="line"><span class="number">63</span> <span class="number">61</span> <span class="number">1960</span> <span class="number">3</span></span><br><span class="line"><span class="number">64</span> <span class="number">57</span> <span class="number">1960</span> <span class="number">4</span></span><br><span class="line"><span class="number">65</span> <span class="number">72</span> <span class="number">1961</span> <span class="number">1</span></span><br><span class="line"><span class="number">66</span> <span class="number">83</span> <span class="number">1961</span> <span class="number">2</span></span><br><span class="line"><span class="number">67</span> <span class="number">71</span> <span class="number">1961</span> <span class="number">3</span></span><br><span class="line"><span class="number">68</span> <span class="number">78</span> <span class="number">1961</span> <span class="number">4</span></span><br><span class="line"><span class="number">69</span> <span class="number">79</span> <span class="number">1962</span> <span class="number">1</span></span><br><span class="line"><span class="number">70</span> <span class="number">71</span> <span class="number">1962</span> <span class="number">2</span></span><br><span class="line"><span class="number">71</span> <span class="number">62</span> <span class="number">1962</span> <span class="number">3</span></span><br><span class="line"><span class="number">72</span> <span class="number">74</span> <span class="number">1962</span> <span class="number">4</span></span><br><span class="line"><span class="number">73</span> <span class="number">76</span> <span class="number">1963</span> <span class="number">1</span></span><br><span class="line"><span class="number">74</span> <span class="number">64</span> <span class="number">1963</span> <span class="number">2</span></span><br><span class="line"><span class="number">75</span> <span class="number">62</span> <span class="number">1963</span> <span class="number">3</span></span><br><span class="line"><span class="number">76</span> <span class="number">57</span> <span class="number">1963</span> <span class="number">4</span></span><br><span class="line"><span class="number">77</span> <span class="number">80</span> <span class="number">1964</span> <span class="number">1</span></span><br><span class="line"><span class="number">78</span> <span class="number">73</span> <span class="number">1964</span> <span class="number">2</span></span><br><span class="line"><span class="number">79</span> <span class="number">69</span> <span class="number">1964</span> <span class="number">3</span></span><br><span class="line"><span class="number">80</span> <span class="number">69</span> <span class="number">1964</span> <span class="number">4</span></span><br><span class="line"><span class="number">81</span> <span class="number">71</span> <span class="number">1965</span> <span class="number">1</span></span><br><span class="line"><span class="number">82</span> <span class="number">64</span> <span class="number">1965</span> <span class="number">2</span></span><br><span class="line"><span class="number">83</span> <span class="number">69</span> <span class="number">1965</span> <span class="number">3</span></span><br><span class="line"><span class="number">84</span> <span class="number">62</span> <span class="number">1965</span> <span class="number">4</span></span><br><span class="line"><span class="number">85</span> <span class="number">63</span> <span class="number">1966</span> <span class="number">1</span></span><br><span class="line"><span class="number">86</span> <span class="number">46</span> <span class="number">1966</span> <span class="number">2</span></span><br><span class="line"><span class="number">87</span> <span class="number">56</span> <span class="number">1966</span> <span class="number">3</span></span><br><span class="line"><span class="number">88</span> <span class="number">44</span> <span class="number">1966</span> <span class="number">4</span></span><br><span class="line"><span class="number">89</span> <span class="number">44</span> <span class="number">1967</span> <span class="number">1</span></span><br><span class="line"><span class="number">90</span> <span class="number">52</span> <span class="number">1967</span> <span class="number">2</span></span><br><span class="line"><span class="number">91</span> <span class="number">38</span> <span class="number">1967</span> <span class="number">3</span></span><br><span class="line"><span class="number">92</span> <span class="number">46</span> <span class="number">1967</span> <span class="number">4</span></span><br><span class="line"><span class="number">93</span> <span class="number">36</span> <span class="number">1968</span> <span class="number">1</span></span><br><span class="line"><span class="number">94</span> <span class="number">49</span> <span class="number">1968</span> <span class="number">2</span></span><br><span class="line"><span class="number">95</span> <span class="number">35</span> <span class="number">1968</span> <span class="number">3</span></span><br><span class="line"><span class="number">96</span> <span class="number">44</span> <span class="number">1968</span> <span class="number">4</span></span><br><span class="line"><span class="number">97</span> <span class="number">59</span> <span class="number">1969</span> <span class="number">1</span></span><br><span class="line"><span class="number">98</span> <span class="number">65</span> <span class="number">1969</span> <span class="number">2</span></span><br><span class="line"><span class="number">99</span> <span class="number">65</span> <span class="number">1969</span> <span class="number">3</span></span><br><span class="line"><span class="number">100</span> <span class="number">56</span> <span class="number">1969</span> <span class="number">4</span></span><br><span class="line"><span class="number">101</span> <span class="number">66</span> <span class="number">1970</span> <span class="number">1</span></span><br><span class="line"><span class="number">102</span> <span class="number">53</span> <span class="number">1970</span> <span class="number">2</span></span><br><span class="line"><span class="number">103</span> <span class="number">61</span> <span class="number">1970</span> <span class="number">3</span></span><br><span class="line"><span class="number">104</span> <span class="number">52</span> <span class="number">1970</span> <span class="number">4</span></span><br><span class="line"><span class="number">105</span> <span class="number">51</span> <span class="number">1971</span> <span class="number">1</span></span><br><span class="line"><span class="number">106</span> <span class="number">48</span> <span class="number">1971</span> <span class="number">2</span></span><br><span class="line"><span class="number">107</span> <span class="number">54</span> <span class="number">1971</span> <span class="number">3</span></span><br><span class="line"><span class="number">108</span> <span class="number">49</span> <span class="number">1971</span> <span class="number">4</span></span><br><span class="line"><span class="number">109</span> <span class="number">49</span> <span class="number">1972</span> <span class="number">1</span></span><br><span class="line"><span class="number">110</span> <span class="number">61</span> <span class="number">1972</span> <span class="number">2</span></span><br><span class="line"><span class="number">111</span> NA <span class="number">1972</span> <span class="number">3</span></span><br><span class="line"><span class="number">112</span> NA <span class="number">1972</span> <span class="number">4</span></span><br><span class="line"><span class="number">113</span> <span class="number">68</span> <span class="number">1973</span> <span class="number">1</span></span><br><span class="line"><span class="number">114</span> <span class="number">44</span> <span class="number">1973</span> <span class="number">2</span></span><br><span class="line"><span class="number">115</span> <span class="number">40</span> <span class="number">1973</span> <span class="number">3</span></span><br><span class="line"><span class="number">116</span> <span class="number">27</span> <span class="number">1973</span> <span class="number">4</span></span><br><span class="line"><span class="number">117</span> <span class="number">28</span> <span class="number">1974</span> <span class="number">1</span></span><br><span class="line"><span class="number">118</span> <span class="number">25</span> <span class="number">1974</span> <span class="number">2</span></span><br><span class="line"><span class="number">119</span> <span class="number">24</span> <span class="number">1974</span> <span class="number">3</span></span><br><span class="line"><span class="number">120</span> <span class="number">24</span> <span class="number">1974</span> <span class="number">4</span></span><br></pre></td></tr></table></figure></p><p>2.画图<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">ggplot2</span>)</span><br><span class="line">p &lt;- ggplot(<span class="name">pres_rating</span>, aes(<span class="name">x=year</span>, y=quarter, fill=rating))+</span><br><span class="line">  theme(<span class="name">panel</span>.background = element_blank(),axis.line = element_line(<span class="name">colour=</span><span class="string">"black"</span>))+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.x = element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y = element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.title.y=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.title.x=element_blank())+</span><br><span class="line">  theme(<span class="name">legend</span>.title=element_blank())</span><br><span class="line">p+ geom_raster()</span><br></pre></td></tr></table></figure></p><p><img src="/images/2018-07/Rplot01.png" alt="heatmap"><br>其中</p><table><thead><tr><th style="text-align:center">代码</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">theme(panel.background = element_blank(),axis.line = element_line(colour=”black”))</td><td style="text-align:center">将ggplot的默认的灰色背景去掉，坐标轴线为黑色</td></tr><tr><td style="text-align:center">theme(axis.ticks.x = element_blank())</td><td style="text-align:center">去掉X轴的轴须</td></tr><tr><td style="text-align:center">theme(axis.title.y=element_blank())</td><td style="text-align:center">去掉y轴标题</td></tr><tr><td style="text-align:center">theme(legend.title=element_blank())</td><td style="text-align:center">去掉图例的标题</td></tr><tr><td style="text-align:center">geom_raster()</td><td style="text-align:center">绘制热图，geom_raster()效率更高,也可用geom_tile() 参数更多</td></tr></tbody></table><p>3.修改热图的颜色<br>在<code>ggplot2</code>默认的热图颜色中，颜色由浅入深代表数字由高到低，这种颜色显示方式多少与我们的习惯相反。因此我们经常需要修改热图的颜色，例如我们想修改成<a href="https://www.nature.com/articles/s41559-018-0588-1" target="_blank" rel="noopener">这篇文献</a>里的这幅图<br><img src="/images/2018-07/9c3550fd-10d3-4110-b730-a5f74d3ade1e.png" alt="heatmap2"><br>的颜色。可以用<a href="http://www.jiniannet.com/page/allcolor" target="_blank" rel="noopener">取色器</a>获取这些颜色的<code>RGB</code>号，然后就可以添加到图里：<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(<span class="name">pres_rating</span>, aes(<span class="name">x=year</span>, y=quarter, fill=rating))+</span><br><span class="line">  theme(<span class="name">panel</span>.background = element_blank(),axis.line = element_line(<span class="name">colour=</span><span class="string">"black"</span>))+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.x = element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.ticks.y = element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.title.y=element_blank())+</span><br><span class="line">  theme(<span class="name">axis</span>.title.x=element_blank())+</span><br><span class="line">  theme(<span class="name">legend</span>.title=element_blank())+</span><br><span class="line">  scale_fill_gradient2(<span class="name">low</span> = <span class="string">"#5E4EA2"</span>, high = <span class="string">"#9E0041"</span>,mid=<span class="string">"#FBFCB5"</span>,midpoint=60)</span><br><span class="line">p+ geom_raster()</span><br></pre></td></tr></table></figure></p><p>其中<code>scale_fill_gradient2(low = &quot;#5E4EA2&quot;, high = &quot;#9E0041&quot;,mid=&quot;#FBFCB5&quot;,midpoint=60)</code>的命令中</p><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">scale_fill_gradient2</td><td style="text-align:center">三色渐变，由中间色、两端色渐变而成，此外还有scale_fill_gradient为两色渐变，scale_fill_gradientn为等间隔的n种颜色</td></tr><tr><td style="text-align:center">low = “#5E4EA2”和high = “#9E0041”</td><td style="text-align:center">根据取色器取到的两端的颜色</td></tr><tr><td style="text-align:center">mid=”#FBFCB5”</td><td style="text-align:center">中间的颜色</td></tr><tr><td style="text-align:center">midpoint=60</td><td style="text-align:center">设置中间点</td></tr></tbody></table><p>得到的结果如下<br><img src="/images/2018-07/Rplot02.png" alt="heatmap3"></p><hr><p>参考</p><ol><li><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" target="_blank" rel="noopener">https://ggplot2.tidyverse.org/reference/geom_tile.html</a></li><li>《R数据可视化手册》</li></ol>]]></content>
      
      <categories>
          
          <category> 生信/R </category>
          
          <category> 绘图 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 绘图 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>用BUSCO来评估基因组完整性</title>
      <link href="/2018-07-15-%E7%94%A8BUSCO%E6%9D%A5%E8%BF%9B%E8%A1%8C%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AE%8C%E6%95%B4%E6%80%A7%E8%AF%84%E4%BC%B0.html"/>
      <url>/2018-07-15-%E7%94%A8BUSCO%E6%9D%A5%E8%BF%9B%E8%A1%8C%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AE%8C%E6%95%B4%E6%80%A7%E8%AF%84%E4%BC%B0.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Benchmarking Universal Single-Copy Orthologs</p><a id="more"></a><blockquote><p>随着基因组数据越来越多，但是将短reads组装成全长的染色体依然非常具有挑战，因此我们经常要对组装的基因组进行质量评估。进行质量评估时常用的方法有：碱基错误率的统计、插入片段长度统计、k-mer分布、contig长度分布、N50等等。然而这些统计方法并没有从基因含量层面来评估基因组的完整性，而基因含量是可以影响数据解读和下游分析的重要指标。</p></blockquote><p>而<a href="https://busco.ezlab.org/" target="_blank" rel="noopener">BUSCO</a>是用于在基因含量层面来评估基因组完整性的一个公开发表流程，其原理在于：先构建一个Benchmarking Universal Single-Copy Orthologs (BUSCO) 的数据库，这个数据库有很多种，有真核生物的数据库，脊椎动物的数据库，鸟类的数据库。以脊椎动物数据库为例，这个数据库中的所有基因都在脊椎动物中存在且只存在一个拷贝，因此我们就可以以此为标准，对组装的基因组用这些基因集进行注释（这个过程中用到了Augstus），通过注释情况来评估不同基因组的质量。<br>由于我们是做鸟类基因组研究，而<code>Gallus gallus</code>即原鸡的基因组是鸟类基因组研究中非常重要的模式基因组，而从14年到现在，已经从第4个基因组版本更新到了第6个基因组版本，虽然从N50等指标上来看越新的基因组其质量越好，但是我们还是想看一看是不是从基因含量的层面上版本越新其基因组完整性越好。于是我用了三个数据库（真核生物、原核生物、鸟类）分别对<code>gal4</code>、<code>gal5</code>、<code>gal6</code>的基因含量进行了评估，然后得到了一下统计结果：<br>真核生物BUSCO数据库:<br><img src="/images/2018-07/busco_figure_eukaryota_odb9.png" alt="busco_figure_eukaryota_odb9"><br>不同指标的含义：<br>Complete：完整性，在被评估的基因组中BUSCO基因的预测分数以及比对上的长度打到了要求<br>Complete and single-copy：完整且在该基因组中只有一个拷贝的数目，该指标越高说明组装效果越好<br>Complete and duplicated：完整且在该基因组中有多个拷贝的数目，由于BUSCO基因集中的基因都是单拷贝的基因，因此如果出现了多个拷贝，就说明在单体型组装过程中出现了错误，因此该指标越高说明组装效果越差<br>Fragmented：Fragmented的基因虽然达到了预测分数，但是长度并没达到要求。有可能基因组组装过程中没有将该片段组装出来，也有可能是基因预测的时候由于基因结构的特殊性没能完整地将该基因预测出来。该指标越低越好。<br>Missing：Fragmented的基因在基因组中完全没有找到，或者预测分数低于要求。有可能基因组组装过程中没有将该片段组装出来，也有可能是基因预测的时候由于基因结构的特殊性没能完整地将该基因预测出来。该指标越低越好。<br>因此从真核生物BUSCO数据库的评价结果来说，Gal6综合情况最好，gal5和gal4之间则难分伯仲。<br>脊椎动物BUSCO数据库:<br><img src="/images/2018-07/busco_figure_vertebrata_odb9.png" alt="busco_figure_vertebrata_odb9"><br>从真核生物BUSCO数据库的评价结果来说，Gal6综合情况最好，gal5次之，gal4最好。<br>鸟类BUSCO数据库：<br><img src="/images/2018-07/busco_figure_aves_odb9.png" alt="busco_figure_aves_odb9"><br>从真核生物BUSCO数据库的评价结果来说，Gal6综合情况最好，gal4次之，gal5最好。<br>但是根据<code>BUSCO</code>提供的<a href="https://gitlab.com/ezlab/busco/raw/master/BUSCO_v3_userguide.pdf" target="_blank" rel="noopener">使用说明</a>来看，在评估基因组时应该选取最specific的数据库来进行评价，比如我们在评估鸟类基因组时，就应该以鸟类的数据库为标准而非以脊椎动物的数据库为标准。<br>综上，Gal6综合情况最好，gal4次之，gal5最次。</p><hr><p><code>BUSCO</code>的流程中有一个绘图脚本可以对BUSCO的结果进行画图，但是其输出结果的画风是这样的：<br><img src="/images/2018-07/busco_figure.png" alt="busco_figure"><br>但是根据我之前看的<a href="https://book.douban.com/subject/27108685/" target="_blank" rel="noopener">《用数据讲故事》</a>这本书中所提供的绘图原则(推荐下这本书，这本书里面所讲的绘图原则很实用，可以让你知道数据可视化展示时的基本原则,回头我也会总结下这本书的要点，<a href="http://www.storytellingwithdata.com/" target="_blank" rel="noopener">作者博客</a>)，该图有三个地方需要改进：：<br>1.堆积条形图不利于体现差别，因此用簇状条形图更好<br>2.Y轴的坐标轴其实没有也能看清<br>3.X轴在最上面更符合阅读顺序。<br>因此我修改了<code>BUSCO</code>自带的绘图脚本，地址：<a href="https://github.com/xieduo7/my_script/blob/master/busco_plot/generate_plot_xd_v2.py" target="_blank" rel="noopener">https://github.com/xieduo7/my_script/blob/master/busco_plot/generate_plot_xd_v2.py</a></p><hr><p>参考文献<br>Simão, F. A., et al. (2015). “BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs.” Bioinformatics 31(19): 3210-3212.<br>Waterhouse, R. M., et al. (2018). “BUSCO Applications from Quality Assessments to Gene Prediction and Phylogenomics.” Molecular Biology and Evolution 35(3): 543-548.<br>Korlach, J., et al. (2017). “De novo PacBio long-read and phased avian genome assemblies correct and add to reference genes generated with intermediate and short reads.” GigaScience 6(10): 1-16.</p>]]></content>
      
      <categories>
          
          <category> 生信/python </category>
          
          <category> 注释 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 注释 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>在python中用docopt模块传入参数</title>
      <link href="/2018-07-04-%E5%9C%A8python%E4%B8%AD%E7%94%A8docopt%E6%A8%A1%E5%9D%97%E4%BC%A0%E5%85%A5%E5%8F%82%E6%95%B0.html"/>
      <url>/2018-07-04-%E5%9C%A8python%E4%B8%AD%E7%94%A8docopt%E6%A8%A1%E5%9D%97%E4%BC%A0%E5%85%A5%E5%8F%82%E6%95%B0.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Pythonic command line arguments parser, that will make you smile<br><a id="more"></a><br><code>python</code>中有<a href="http://python.jobbole.com/87014/" target="_blank" rel="noopener">很多模块</a>可以传入参数，例如<a href="https://docs.python.org/2/library/argparse.html" target="_blank" rel="noopener">argparse</a>、<a href="https://github.com/docopt/docopt" target="_blank" rel="noopener">docopt</a>,我一开始在<code>BUSCO</code>的软件的<a href="https://gitlab.com/ezlab/busco/blob/master/scripts/generate_plot.py" target="_blank" rel="noopener">某个脚本</a>中看到了使用<code>argparse</code>模块的，但是我在看完相关的文档后觉得太麻烦了，有人在<a href="https://xuanwo.org/2016/04/04/docopt-intro/" target="_blank" rel="noopener">博客</a>中说<strong>珍爱生命，远离argparse</strong>，与<code>perl</code>中的<code>getopt</code>模块的使用方法相去甚远。不过还好找到了<code>docopt</code>这个模块，这个模块方便简单优美有效，将书写<code>usage</code>的过程与设置参数的过程完美结合。<br>于是尝试试一下这个模块:<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">""</span><span class="comment">"Duo Xie</span></span><br><span class="line">Usage:</span><br><span class="line"> <span class="number">01</span>.docopt.<span class="keyword">py</span> [--<span class="built_in">input</span>=<span class="symbol">&lt;path&gt;</span>] [--speed=<span class="symbol">&lt;kn&gt;</span>]</span><br><span class="line"></span><br><span class="line">Option<span class="variable">s:</span></span><br><span class="line"> --<span class="built_in">input</span>=<span class="symbol">&lt;path&gt;</span> the path of <span class="built_in">input</span> <span class="keyword">file</span> [defaul<span class="variable">t:</span> ./test.<span class="keyword">py</span>].</span><br><span class="line"> --speed=<span class="symbol">&lt;kn&gt;</span> the <span class="keyword">number</span> test [defaul<span class="variable">t:</span> <span class="number">2.95</span>].</span><br><span class="line"><span class="string">""</span><span class="comment">"</span></span><br><span class="line">from docopt import docopt</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    arguments = docopt(__doc__)</span><br><span class="line">    <span class="keyword">print</span>(arguments)</span><br></pre></td></tr></table></figure></p><p>然后执行<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python <span class="number">01</span><span class="selector-class">.docopt</span><span class="selector-class">.py</span></span><br></pre></td></tr></table></figure></p><p>得到输出<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">'--input'</span>: <span class="string">'./test.py'</span>,</span><br><span class="line"> <span class="string">'--speed'</span>: <span class="string">'2.95'</span>&#125;</span><br></pre></td></tr></table></figure></p><p>这个模块的具体使用方法请看文档，这里只指出一些需要注意的点：</p><ol><li>Usage<br>写<code>usage</code>时不要在脚本名称前面加上<code>python</code>,即不要写成<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> <span class="number">01</span>.docopt.<span class="keyword">py</span> [--<span class="built_in">input</span>=<span class="symbol">&lt;path&gt;</span>] [--speed=<span class="symbol">&lt;kn&gt;</span>]</span><br></pre></td></tr></table></figure></li></ol><p>而是写成<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">01<span class="selector-class">.docopt</span><span class="selector-class">.py</span> <span class="selector-attr">[--input=&lt;path&gt;]</span> <span class="selector-attr">[--speed=&lt;kn&gt;]</span></span><br></pre></td></tr></table></figure></p><p>否则的话<code>python 01.docopt.py</code>就会认为格式不对:<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Usage:</span><br><span class="line"> <span class="keyword">python</span> <span class="number">01</span>.docopt.<span class="keyword">py</span> [--<span class="built_in">input</span>=<span class="symbol">&lt;path&gt;</span>] [--speed=<span class="symbol">&lt;kn&gt;</span>]</span><br></pre></td></tr></table></figure></p><ol start="2"><li>Options<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--<span class="built_in">input</span>=<span class="symbol">&lt;path&gt;</span> the path of <span class="built_in">input</span> <span class="keyword">file</span> [defaul<span class="variable">t:</span> ./test.<span class="keyword">py</span>].</span><br><span class="line">--speed=<span class="symbol">&lt;kn&gt;</span> the <span class="keyword">number</span> test [defaul<span class="variable">t:</span> <span class="number">2.95</span>].</span><br></pre></td></tr></table></figure></li></ol><p>这两行内容前面不要使用制表符，应该使用空格。这里应该注意，即使是使用四个空格，和使用制表符的效果也是不一样的，因为这在电脑中是两种不同的符号，我们如果用空格，那么<code>cat -A 01.docopt.py</code>显示的是:<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">""</span><span class="comment">"Duo Xie$</span></span><br><span class="line">Usage:$</span><br><span class="line"> <span class="number">01</span>.docopt.<span class="keyword">py</span> [--<span class="built_in">input</span>=<span class="symbol">&lt;path&gt;</span>] [--speed=<span class="symbol">&lt;kn&gt;</span>]$</span><br><span class="line">$</span><br><span class="line">Option<span class="variable">s:</span>$</span><br><span class="line">    --<span class="built_in">input</span>=<span class="symbol">&lt;path&gt;</span> the path of <span class="built_in">input</span> <span class="keyword">file</span> [defaul<span class="variable">t:</span> ./test.<span class="keyword">py</span>].$</span><br><span class="line">    --speed=<span class="symbol">&lt;kn&gt;</span> the <span class="keyword">number</span> test [defaul<span class="variable">t:</span> <span class="number">2.95</span>].$</span><br><span class="line"><span class="string">""</span><span class="comment">"$</span></span><br><span class="line">from docopt import docopt$</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:$</span><br><span class="line">    arguments = docopt(__doc__)$</span><br><span class="line">    <span class="keyword">print</span>(arguments)$</span><br></pre></td></tr></table></figure></p><p>但是如果使用制表符，那么<code>cat -A 01.docopt.py</code>显示的是:<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">""</span><span class="comment">"Duo Xie$</span></span><br><span class="line">Usage:$</span><br><span class="line"> <span class="number">01</span>.docopt.<span class="keyword">py</span> [--<span class="built_in">input</span>=<span class="symbol">&lt;path&gt;</span>] [--speed=<span class="symbol">&lt;kn&gt;</span>]$</span><br><span class="line">$</span><br><span class="line">Option<span class="variable">s:</span>$</span><br><span class="line">^I--<span class="built_in">input</span>=<span class="symbol">&lt;path&gt;</span> the path of <span class="built_in">input</span> <span class="keyword">file</span> [defaul<span class="variable">t:</span> ./test.<span class="keyword">py</span>].$</span><br><span class="line">^I--speed=<span class="symbol">&lt;kn&gt;</span> the <span class="keyword">number</span> test [defaul<span class="variable">t:</span> <span class="number">2.95</span>].$</span><br><span class="line"><span class="string">""</span><span class="comment">"$</span></span><br><span class="line">from docopt import docopt$</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:$</span><br><span class="line">    arguments = docopt(__doc__)$</span><br><span class="line">    <span class="keyword">print</span>(arguments)$</span><br></pre></td></tr></table></figure></p><p>参考:<br><a href="http://docopt.org/" target="_blank" rel="noopener">http://docopt.org/</a><br><a href="https://github.com/docopt/docopt/issues/118" target="_blank" rel="noopener">https://github.com/docopt/docopt/issues/118</a><br><a href="https://stackoverflow.com/questions/26592289/how-can-text-in-the-options-configuration-of-docopt-be-wrapped" target="_blank" rel="noopener">https://stackoverflow.com/questions/26592289/how-can-text-in-the-options-configuration-of-docopt-be-wrapped</a><br><a href="https://xuanwo.org/2016/04/04/docopt-intro/" target="_blank" rel="noopener">https://xuanwo.org/2016/04/04/docopt-intro/</a><br><a href="https://www.jianshu.com/p/9ae4cf88e552" target="_blank" rel="noopener">https://www.jianshu.com/p/9ae4cf88e552</a><br><a href="https://wp-lai.gitbooks.io/learn-python/content/0MOOC/docopt.html" target="_blank" rel="noopener">https://wp-lai.gitbooks.io/learn-python/content/0MOOC/docopt.html</a></p>]]></content>
      
      <categories>
          
          <category> 生信/python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docopt </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>基因预测软件中的奥古斯都-Augustus的安装</title>
      <link href="/2018-06-25-%E5%9F%BA%E5%9B%A0%E9%A2%84%E6%B5%8B%E8%BD%AF%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%A5%A5%E5%8F%A4%E6%96%AF%E9%83%BD-Augustus%E7%9A%84%E5%AE%89%E8%A3%85.html"/>
      <url>/2018-06-25-%E5%9F%BA%E5%9B%A0%E9%A2%84%E6%B5%8B%E8%BD%AF%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%A5%A5%E5%8F%A4%E6%96%AF%E9%83%BD-Augustus%E7%9A%84%E5%AE%89%E8%A3%85.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/images/2018-06/奥古斯都.jpg" alt="奥古斯都"><br><code>Augustus</code>是用作<em>de novo</em>基因注释(即从头预测)的软件，而这个软件的名字也起得很好：<code>Augustus</code>翻译成中文名字就是<strong>奥古斯都</strong>,即罗马帝国的开国君主。<br><a id="more"></a><br>而开国君主这层含义与从头预测不谋而合，这样一来，这个名字既指出了这个软件的功能，又有一定的历史底蕴。虽然这是一个从头预测基因的软件，但是现在很多基因注释相关的软件都会依赖于这个软件，例如<a href="https://github.com/ComparativeGenomicsToolkit/Comparative-Annotation-Toolkit" target="_blank" rel="noopener">CAT</a>以及<a href="https://busco.ezlab.org/" target="_blank" rel="noopener">BUSCO</a>，因此这个软件的作用并不是只有从头预测基因这么狭隘。虽然这个软件的<a href="http://bioinf.uni-greifswald.de/augustus/" target="_blank" rel="noopener">官网</a>上有<a href="http://bioinf.uni-greifswald.de/augustus/binaries/tutorial2018/" target="_blank" rel="noopener">安装教程</a>，也指出了需要的依赖包，但是在安装过程中还是有非常多的trick，因此安装这个软件是非常浩大的工程，这个软件的安装过程比<code>UCSC</code>软件包的安装还要繁琐。</p><h1 id="安装需要安装的包-顺序有先后"><a href="#安装需要安装的包-顺序有先后" class="headerlink" title="安装需要安装的包(顺序有先后)"></a>安装需要安装的包(顺序有先后)</h1><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">libboost</span></span><br><span class="line"><span class="symbol">libgsl</span></span><br><span class="line"><span class="symbol">libsqlite3</span></span><br><span class="line"><span class="symbol">libsuitesparse</span></span><br><span class="line"><span class="symbol">lp</span>-solve</span><br><span class="line"><span class="keyword">bamtools</span></span><br><span class="line"><span class="keyword">htslib</span></span><br><span class="line"><span class="keyword">bcftools</span></span><br><span class="line"><span class="keyword">samtools</span></span><br></pre></td></tr></table></figure><ol><li>libboost，<a href="https://blog.csdn.net/this_capslock/article/details/47170313" target="_blank" rel="noopener">参考1</a>和<a href="https://www.boost.org/doc/libs/1_67_0/more/getting_started/unix-variants.html#get-boost" target="_blank" rel="noopener">参考2</a><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./bootstrap.sh <span class="attribute">--with-libraries</span>=all <span class="attribute">--with-toolset</span>=gcc <span class="attribute">--prefix</span>=/xieduo/lib/boost-1.67.0</span><br><span class="line">./b2 <span class="attribute">toolset</span>=gcc</span><br><span class="line">./b2 install <span class="attribute">--prefix</span>=/xieduo/lib/boost-1.67.0</span><br></pre></td></tr></table></figure></li></ol><p>记得在<code>~/.bash_profile</code>中添加,<a href="https://www.cnblogs.com/image-eye/archive/2011/08/20/2147133.html" target="_blank" rel="noopener">参考</a><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">ver</span>=<span class="string">"boost-1.67.0"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">C_INCLUDE_PATH</span>=<span class="string">"/xieduo/lib/<span class="variable">$&#123;ver&#125;</span>/include:<span class="variable">$&#123;C_INCLUDE_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CPLUS_INCLUDE_PATH</span>=<span class="string">"<span class="variable">$&#123;C_INCLUDE_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">"/xieduo/lib/<span class="variable">$&#123;ver&#125;</span>/lib:<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LIBRARY_PATH</span>=<span class="string">"<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br></pre></td></tr></table></figure></p><p>以下所有的库的安装后都要加入环境变量，不再重复。</p><ol start="2"><li><p>libgsl安装</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> gsl-2.4</span><br><span class="line"><span class="string">./configure</span> <span class="params">--prefix=/xieduo/software/gsl-2</span>.4</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></li><li><p>libsqlite3</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -zxf sqlite-autoconf<span class="number">-3240000.</span>tar.gz</span><br><span class="line">cd sqlite-autoconf<span class="number">-3240000</span></span><br><span class="line">./configure --prefix=/xieduo/software/sqlite<span class="number">-3.24</span><span class="number">.0</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></li></ol><ol start="4"><li><p>libsuitesparse</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">tar</span> <span class="selector-tag">-zxf</span> <span class="selector-tag">libSuiteSparse-devel-3</span><span class="selector-class">.2</span><span class="selector-class">.0-2</span><span class="selector-class">.tar</span></span><br></pre></td></tr></table></figure></li><li><p>lp_solve_5.5.2.5</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="symbol">https:</span>/<span class="regexp">/jaist.dl.sourceforge.net/project</span><span class="regexp">/lpsolve/lpsolve</span><span class="regexp">/5.5.2.5/lp</span>_solve_5.<span class="number">5.2</span>.<span class="number">5</span>_exe_ux64.tar.gz</span><br><span class="line">mkdir lp_solve_5.<span class="number">5.2</span>.<span class="number">5</span></span><br><span class="line">mkdir lp_solve_5.<span class="number">5.2</span>.<span class="number">5</span>/<span class="class"><span class="keyword">lib</span> <span class="title">lp_solve_5</span>.5.2.5/<span class="title">include</span></span></span><br><span class="line">mv *so lp_solve_5.<span class="number">5.2</span>.<span class="number">5</span>/<span class="class"><span class="keyword">lib</span></span></span><br><span class="line">mv *h lp_solve_5.<span class="number">5.2</span>.<span class="number">5</span>/<span class="keyword">include</span></span><br></pre></td></tr></table></figure></li><li><p>bamtools</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> bamtools-<span class="number">2.4</span>.<span class="number">0</span></span><br><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="keyword">cd</span> build</span><br><span class="line">cmake -DCMAKE_INSTALL_PREFIX=/xieduo/software/bamtools-<span class="number">2.4</span>.<span class="number">0</span> ..</span><br><span class="line"><span class="keyword">make</span></span><br><span class="line"><span class="keyword">make</span> install</span><br></pre></td></tr></table></figure></li><li><p>安装htslib</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">autoheader</span><br><span class="line">autoreconf</span><br><span class="line">./configure --prefix=/xieduo/<span class="keyword">lib</span>/htslib<span class="number">-1.8</span></span><br><span class="line"><span class="built_in">make</span></span><br><span class="line"><span class="built_in">make</span> install</span><br></pre></td></tr></table></figure></li><li><p>安装<code>bcftools</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure <span class="attribute">--prefix</span>=/xieduo/software/bcftools-1.8 <span class="attribute">--with-htslib</span>=/xieduo/lib/htslib-1.8</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></li><li><p>安装samtools</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">autoheader</span><br><span class="line">autoconf -Wno-syntax</span><br><span class="line">.<span class="regexp">/configure --prefix=/</span>xieduo<span class="regexp">/software/</span>samtools-<span class="number">1.8</span></span><br></pre></td></tr></table></figure></li></ol><p>修改<code>misc/maq2sam.c</code>中33行中<code>#include &quot;version.h&quot;</code>为<code>#include &quot;../version.h&quot;</code>,修改<code>misc/wgsim.c</code>的42行的<code>#include &quot;version.h&quot;</code>为<code>#include &quot;../version.h&quot;</code>。<br>然后<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span></span><br><span class="line"><span class="built_in">make</span> install</span><br></pre></td></tr></table></figure></p><p>如果不修改就会报错：<br><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gcc -g -O2 -DMAQ_LONGREADS -I. -I../htslib<span class="number">-1.8</span> -I./lz4 isc/maq2sam-<span class="built_in">long</span>.o misc/maq2sam.c</span><br><span class="line">misc/maq2sam.c: <span class="keyword">In</span> <span class="keyword">function</span> ‘main’:</span><br><span class="line">misc/maq2sam.c:<span class="number">215</span>:<span class="number">42</span>: <span class="keyword">error</span>: ‘SAMTOOLS_VERSION’ undeclared (first use <span class="keyword">in</span> this <span class="keyword">function</span>)</span><br><span class="line">         fprintf(stderr, <span class="string">"Version: %s\n"</span>, SAMTOOLS_VERSION);</span><br><span class="line">                                          ^</span><br><span class="line">misc/maq2sam.c:<span class="number">215</span>:<span class="number">42</span>: note: <span class="keyword">each</span> undeclared identifier <span class="keyword">is</span> reported only once <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">function</span> it appears <span class="keyword">in</span></span><br><span class="line">make: *** [misc/maq2sam-<span class="built_in">long</span>.o] <span class="keyword">Error</span> <span class="number">1</span></span><br></pre></td></tr></table></figure></p><h1 id="正式安装Augustus"><a href="#正式安装Augustus" class="headerlink" title="正式安装Augustus"></a>正式安装<code>Augustus</code></h1><ol><li><p>bam2hints<br>修改<code>/xieduo/src/augustus-3.3.1/auxprogs/bam2hints/Makefile</code>中第11行为</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INCLUDES</span> = <span class="regexp">/xieduo/</span>software<span class="regexp">/bamtools-2.4.0/i</span>nclude<span class="regexp">/bamtools</span></span><br></pre></td></tr></table></figure></li><li><p>bam2wig<br>修改</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cd  /xieduo/src/augustus-<span class="number">3.3</span>.<span class="number">1</span>/auxprogs/bam2wig</span><br><span class="line">mkdir tools</span><br><span class="line">cd tools</span><br><span class="line">ln -s /xieduo/software/bcftools-<span class="number">1.8</span> </span><br><span class="line">ln -s  /xieduo/<span class="class"><span class="keyword">lib</span>/<span class="title">htslib</span>-1.8 <span class="title">tabix</span></span></span><br><span class="line">mkdir htslib</span><br><span class="line">cd htslib</span><br><span class="line">ln -s  /xieduo/<span class="class"><span class="keyword">lib</span>/<span class="title">htslib</span>-1.8/<span class="title">bin</span></span></span><br><span class="line">ln -s  /xieduo/<span class="class"><span class="keyword">lib</span>/<span class="title">htslib</span>-1.8/<span class="title">include</span></span></span><br><span class="line">ln -s  /xieduo/<span class="class"><span class="keyword">lib</span>/<span class="title">htslib</span>-1.8/<span class="title">lib</span></span></span><br><span class="line">ln -s  /xieduo/<span class="class"><span class="keyword">lib</span>/<span class="title">htslib</span>-1.8/<span class="title">share</span></span></span><br><span class="line">cp  /xieduo/src/htslib-<span class="number">1.8</span>/libhts.a ./</span><br><span class="line">cd ../</span><br><span class="line">mkdir samtools</span><br><span class="line">cd samtools</span><br><span class="line">ln -s  /xieduo/software/samtools-<span class="number">1.8</span>/bin</span><br><span class="line">ln -s /xieduo/software/samtools-<span class="number">1.8</span>/share</span><br><span class="line">cp  /xieduo/src/samtools-<span class="number">1.8</span>/libbam.a ./</span><br><span class="line">cp  /xieduo/src/samtools-<span class="number">1.8</span>/bam.h ./</span><br><span class="line">cp  /xieduo/src/samtools-<span class="number">1.8</span>/sam.h ./</span><br></pre></td></tr></table></figure></li></ol><p>然后将修改<code>samtools/sam.h</code>的<code>28</code>行为<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="string">"../htslib/include/htslib/sam.h"</span></span></span><br></pre></td></tr></table></figure></p><p>修改<code>samtools/bam.h</code>的<code>48</code>和<code>49</code>行为<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="string">"../htslib/include/htslib/bgzf.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="string">"../htslib/include/htslib/sam.h"</span></span></span><br></pre></td></tr></table></figure></p><ol start="3"><li>修改<code>/xieduo/src/augustus-3.3.1/common.mk</code><br>把<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ZIPINPUT</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">COMPGENEPRED</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">SQLITE</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure></li></ol><p>去掉注释.</p><ol start="4"><li><p>修改<code>/xieduo/src/augustus-3.3.1/Makefile</code><br>把第15行改为</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSTALLDIR = /xieduo/software/augustus-<span class="variable">$(AUGVERSION)</span></span><br></pre></td></tr></table></figure></li><li><p>修改<code>/xieduo/src/augustus-3.3.1/src/Makefile</code><br>第55行改为</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LIBS += -lsqlite3 -Wl,-rpath=<span class="regexp">/xieduo/</span>lib<span class="regexp">/sqlite-3.24.0/</span>lib</span><br></pre></td></tr></table></figure></li><li><p>修改<code>/xieduo/src/augustus-3.3.1/auxprogs/homGeneMapping/src/Makefile</code><br>将第4行和第8行去注释</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">BOOST</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">SQLITE</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure></li></ol><p>在23行改为<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INCLS += -I/xieduo/<span class="class"><span class="keyword">lib</span>/<span class="title">boost</span>-1.67.0/<span class="title">lib</span></span></span><br></pre></td></tr></table></figure></p><p>第28、29行改为<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INCLS += -I/xieduo/<span class="class"><span class="keyword">lib</span>/<span class="title">sqlite</span>-3.24.0/<span class="title">include</span></span></span><br><span class="line">LIBS += -lsqlite3 -L/xieduo/<span class="class"><span class="keyword">lib</span>/<span class="title">sqlite</span>-3.24.0/<span class="title">lib</span></span></span><br></pre></td></tr></table></figure></p><ol start="7"><li>编译<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span> </span><br><span class="line"><span class="built_in">make</span> install</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      <categories>
          
          <category> 生信/基因注释 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Augustus </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>多序列比对可视化工具</title>
      <link href="/2018-06-25-%E5%A4%9A%E5%BA%8F%E5%88%97%E6%AF%94%E5%AF%B9%E7%BB%93%E6%9E%9C%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96.html"/>
      <url>/2018-06-25-%E5%A4%9A%E5%BA%8F%E5%88%97%E6%AF%94%E5%AF%B9%E7%BB%93%E6%9E%9C%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>做比较基因组学中，进场会进行多序列比对结果的可视化。<br><a id="more"></a><br>以通过肉眼来对比对结果进行查看和评估，有很多软件都可以实现这个功能，例如<code>MEGA</code>,<code>Bioedit</code>以及<code>Genious</code>,<code>MEGA</code>和<code>Bioedit</code>只能从细节上去看比对结果<br><img src="/images/2018-06/MEGA.png" alt="MEGA"><br>难以从整体上对比对结果进行把握，<code>Genious</code>虽然可以在总体上看但是<code>Genious</code>是收费软件，且费用很高，但是我后来还找到了另一个工具：NCBI<a href="https://www.ncbi.nlm.nih.gov/projects/msaviewer/" target="_blank" rel="noopener">可视化工具</a>,虽然是在线工具，但是可以实现<code>Genious</code>的功能，上方可以看比对分值的分布，下方可以看比对效果的分布，<br><img src="/images/2018-06/整体.png" alt="整体"><br>放大后可显示碱基：<br><img src="/images/2018-06/碱基.png" alt="碱基"></p>]]></content>
      
      <categories>
          
          <category> 生信/比较基因组学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 可视化 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>批量从NCBI下载指定物种中指定基因的序列</title>
      <link href="/2018-06-25-%E6%89%B9%E9%87%8F%E4%BB%8ENCBI%E4%B8%8B%E8%BD%BD%E6%8C%87%E5%AE%9A%E7%89%A9%E7%A7%8D%E4%B8%AD%E6%8C%87%E5%AE%9A%E5%9F%BA%E5%9B%A0%E7%9A%84%E5%BA%8F%E5%88%97.html"/>
      <url>/2018-06-25-%E6%89%B9%E9%87%8F%E4%BB%8ENCBI%E4%B8%8B%E8%BD%BD%E6%8C%87%E5%AE%9A%E7%89%A9%E7%A7%8D%E4%B8%AD%E6%8C%87%E5%AE%9A%E5%9F%BA%E5%9B%A0%E7%9A%84%E5%BA%8F%E5%88%97.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在做比较基因组学分析的时候，经常会遇到一种需求：我们想看某一个基因在不同物种中的分布情况及基因结构的区别。<br><a id="more"></a><br>在很多文献中比较常见的一种思路是：通过一个query序列在不同物种中进行blast搜索，获取基因组上大致的范围，然后用<code>Genewise</code>进行基因预测，如果是新测的物种，那么由于NCBI上没有这一物种的注释结果，我们只能这么做。但是如果我们要在已经发表的基因组中看某一个基因的情况的话，最好先在NCBI数据库中看下这个基因是否在这些基因组中已经注释出来。<br>因为无论我们自己的注释始终比不上NCBI的注释方法全面，因为NCBI的注释综合了NCBI中大量的数据，例如EST、cDNA等等，我们自己去注释的话没有这么多数据来源，所以对于<br>已经发表的基因组注释，我们的注释效果肯定比不上NCBI自己注释的效果。<br>比方说，如果我们要看<code>CYP2J19</code>这个基因在所有的已经发表的鸟类基因组中的分布情况，那么首先去NCBI上搜索这一基因：<br><img src="/images/2018-06/CYP2j19.png" alt="CYP2J19"><br>由于鸡是鸟类中比较有代表性的物种，我们以鸡当中的这个基因作为query，点击右侧的<code>Run Blast</code>,在<code>Entrez Query</code>中输入<code>biomol_mrna[properties] AND avian[organism]</code>,意思是只需要<code>mRNA</code>序列，物种范围为<code>鸟纲</code>,具体可<a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&amp;PAGE_TYPE=BlastDocs&amp;DOC_TYPE=BlastHelp#entrez_query" target="_blank" rel="noopener">参考</a><br><img src="/images/2018-06/69c0bf67-f81f-4032-8fec-4902f210ae97.png" alt="CYP2J19_1"><br>在下方的参数设置中设置为最多250个结果，以得到尽量多的结果:<br><img src="/images/2018-06/250.png" alt="250"><br>点击<code>BLAST</code>,登上差不多1分钟，NCBI就有结果了。然后选择<code>All</code>:<br><img src="/images/2018-06/all.png" alt="all"><br>点击下载完整序列（这样我们会得到这些匹配上结果的完整序列，而不止是比对上的部分）：<br><img src="/images/2018-06/mrna.png" alt="mrna"><br>但是这样一来就有了第二个问题：NCBI上的基因序列分为<code>mRNA</code>和<code>cds</code>，两者的区别在与，<code>mRNA</code>序列前后经常会有<code>UTR</code>片段，而<code>cds</code>序列不包括UTR序列，因此cds才是蛋白序列所对应的核酸序列，也就是说<code>cds</code>经过翻译后可以成为蛋白序列。刚才的下载选项里只有完整序列即<code>mRNA</code>序列，我们现在如果只想获得cds序列的话，该怎么办？<br>我这里有一个曲线救国的方法：<br>先获得这些序列的编号，然后通过<code>Batch Entrez</code>批量获得cds序列。<br>获得序列编号(其中seqdump.txt是刚刚下载的mRNA序列文件)<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">grep</span> <span class="string">"&gt;"</span> seqdump.txt|awk <span class="string">'&#123;print <span class="variable">$1</span>&#125;'</span>|awk -F<span class="string">"&gt;"</span> <span class="string">'&#123;print <span class="variable">$2</span>&#125;'</span> &gt;download.list</span><br></pre></td></tr></table></figure></p><p>然后打开<a href="https://www.ncbi.nlm.nih.gov/sites/batchentrez" target="_blank" rel="noopener">Batch Entrez</a>,<br><img src="/images/2018-06/entrz.png" alt="entrz"><br>数据库选择<code>Nucleotide</code>,然后选择文件上传，再点击右侧的<code>Retrieve</code>,出现如下界面:<br><img src="/images/2018-06/shu.png" alt="shu"><br>然后点击<code>Retrieve records for 87 UID(s)</code>,然后看到批量的结果：<br><img src="/images/2018-06/send.png" alt="send"><br>这时点击右上角的<code>Send to</code>,选择<code>Coding Sequences</code>,再点击<code>Creat File</code>,即可获得文件，<br><img src="/images/2018-06/code.png" alt="code"><br><img src="/images/2018-06/cds.png" alt="cds"></p>]]></content>
      
      <categories>
          
          <category> 生信/数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NCBI </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>极度狂热：启程</title>
      <link href="/2018-06-18-%E6%9E%81%E5%BA%A6%E7%8B%82%E7%83%AD%EF%BC%9A%E5%90%AF%E7%A8%8B.html"/>
      <url>/2018-06-18-%E6%9E%81%E5%BA%A6%E7%8B%82%E7%83%AD%EF%BC%9A%E5%90%AF%E7%A8%8B.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/images/2018-06/24-14062315553Y44.png" alt="世界杯"><br><a id="more"></a><br>2018年6月16日凌晨2点，随着裁判的一声哨响，迭戈科斯塔将球传给布斯克茨，我心中的2018世界杯终于开幕了。<br>这是一场精彩的比赛，西班牙和葡萄牙之间你来我往，西班牙依然秉持着传统的传控风格，脚下技术出色，伊涅斯塔、伊斯科和席尔瓦在中场的精彩配合赏心悦目，连后腰布斯克茨也有几个非常漂亮的摆脱和过人动作。但是凡事皆有意外，葡萄牙利用反击给西班牙的后场制造了不少麻烦，而C罗更是有如神助搬地打进三球，使得西班牙不得跟跟葡萄牙握手言和，作为西班牙队的支持者，这样的结果让人多少有些失望，尤其是本以为胜券在握的情况下最后被追平。</p><hr><p>2002年夏天，我第一次看世界杯，那场比赛是中国对阵巴西，我依稀记得米卢在场边的捶胸顿足，以及大罗小罗脸上始终洋溢的笑容。那时，我不知世界杯为何物，更不要说明白世界杯出线对于中国足球的意义所在，但是从那时起，第一次知道了属于中国足球和巴西足球的两个标签：”臭球”和“艺术足球”。</p><hr><p>2012年夏天欧洲杯半决赛——葡萄牙对阵西班牙，那是我第一次完整地观看一场足球比赛，那时我对于足球依然一无所知，球场上所有的球员中只认识一个人——那个代言某洗发水的C罗，而对西班牙队中的小白哈维阿隆索这些名字绰号一头雾水，因此那场比赛我支持了葡萄牙队。C罗在86分钟时获得了一个单刀直入的机会，最后却将球踢向了看台，于是不得不迎接加时赛以及点球大战的到来。在点球大战中，西班牙队的门将发挥神勇，扑出了葡萄牙4个点球中的2个，最后西班牙队踢进了第五个点球，4:2，葡萄牙点球大战中顺序排在第5位的C罗失去了主罚点球的机会，西班牙队获得了胜利。我依然记得C罗脸上无奈的神情以及眼中的泪水，他以及那个落寞的背影。在决赛中，西班牙横扫意大利，实现了欧洲杯世界杯三连冠的霸业，但是令我印象更为深刻的是西班牙行云流水的足球风格:那像一曲华丽的交响乐，时而宛转悠扬，时而恢弘壮阔，于是我心中便有了这样一个观念：足球就应该是这样的，什么是艺术足球？这才是真正的艺术足球。从那时起起，我也成为了西班牙队的拥蹙。那次欧洲杯之后，《锵锵三人行》做了一期关于欧洲杯的节目，作为西班牙巴萨双料球迷的道长梁文道对欧洲杯侃侃而谈，对西班牙的球员如数家珍，他说西班牙的足球风格是拉丁打法和欧洲打法的完美融合。而嗜书如命的道长更是道出了一个颇有意思的细节：在西班牙对阵法国的比赛前，西班牙球员阿隆索在更衣室看书，书的名字叫《人类群星闪耀时》。</p><hr><p>2014年世界杯，那位在2012年夏天发挥神勇的西班牙门将也已不再神勇，而我也终于知道他的名字叫卡西利亚斯，西班牙在小组赛惨败于智利和荷兰，早早打道回府，然而我却一直对那支美妙的交响乐队念念不忘。直到在观看阿根廷对阵德国的决赛时，我在德国队身上看到了那支交响乐的影子，他们用足球勾勒出一条又一条美丽曲线，运筹帷幄却又杀机四伏。在116分钟，替补上场的格策接过许尔勒的传球，用身体将球送入了球网。德国拿到了大力神杯，我异常兴奋，因为在我看来这是理所应当的：踢得更漂亮的那支队伍更应该拿到冠军。但是在德国队走上颁奖台领取大力神杯时，我注意到一个失望而落寞的身影——梅西，他对大力神杯望眼欲穿的神情令人动容，一如12年C罗那落寞的身影。德国队的足球风格征服了我，我开始去了解足球，了解德国队。而了解德国队一定会绕不开一支球队：拜仁慕尼黑。决赛中德国队首发中的7名球员来自拜仁慕尼黑，而德国队的足球风格也沿袭自拜仁慕尼黑，而这一足球风格的缔造者是瓜迪奥拉，我又了解到他是了2009-2012年那支巴萨宇宙队的缔造者，而那支以巴萨球员为班底打造的西班牙国家队也承袭了这种足球风格，并因为这种风格取得了成功，我终于知道了为什么14年的西班牙和16年的德国队的风格如此相像，因为这两支球队中都有同一个人的鲜明烙印，他们都因此取得了成功。在那次世界杯之后，《锵锵三人行》做了一期关于世界杯的节目，道长在节目中说：喜爱读书热爱知识的道长说德国队的平均学历是所有球队中最高的。<br>从此，我开始了我的看球生涯，并几乎观看了14-15赛季巴萨拜仁的所有比赛。而在开始看球后的几个月，我在同学寝室的柜子上看到一本书——《瓜迪奥拉:成功的另一种道路》，这算是瓜迪奥拉的传记，从这本书中我了解到瓜迪奥拉的足球经理：从进入拉玛西亚开始，进入巴萨一线队，在克鲁伊夫手下效力随巴萨赢得冠军，最后退役成为教练，带领巴萨拿下一个又一个冠军而后急流勇退，休整一年后执教拜仁慕尼黑。看完那本书的时间距今已有4年，其中的诸多细节已模糊不清，但是那本书中对于瓜迪奥拉足球哲学的阐释令我印象深刻，永生难忘，并让我成为了这位足球哲学家的忠实信徒，甚至影响了我的价值观和处事方式。他师承自克鲁伊夫，对克鲁伊夫的足球哲学深信不疑，而这一切都成为了今天巴萨的根基和财富。书中有一段话令我印象深刻：</p><blockquote><p>瓜迪奥拉大大击退了足坛盛行的功利主义风气，在那些人看来，获得巅峰荣耀和踢出漂亮足球比赛是不可调和的矛盾，有些人甚至想要背弃体育精神，抛弃应有的底线。是谁定下了这样的规矩，又是谁带来了这样的风气？佩普要逆势而为，因为那是他内心信仰所在。<br>他的目标不仅是获得冠军，更是要铸就某种风格。</p></blockquote><p>而后一句话让我明白：完成一件事情的方式有很多，<strong>但是比完成一件事情本身更重要的，是以自己喜欢的方式，或者说是自己认为最正确的方式去完成一件事情</strong>。而他的所作所为完美地阐释了这一理念，他不仅在追求赢球，更是不断在尝试新的方式，以及用自己喜欢的方式来赢球。这是他的优点，也同样是他的软肋，因为足球中也有阴谋家，他们利用他这种对于美丽足球的偏执来打败他。但是这又如何呢？<br>2018年6月17日，俄罗斯世界杯德国对阵墨西哥，德国依然在以4年前的姿势演奏那支交响曲，只是那支交响曲开始变得沉重，没有了往日的灵动和悠扬，甚至有些走调，不知这是否又预示着一个帝国的谢幕呢？而在一个月之后，当世界杯结束时，我们也无法在《锵锵三人行》上看到道长对新科世界杯冠军侃侃而谈，因为这档节目已经停播了。</p>]]></content>
      
      <categories>
          
          <category> 杂谈 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 足球 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>分享一个之前下载的电台节目</title>
      <link href="/2018-06-03-%E7%94%B5%E5%8F%B0%E8%8A%82%E7%9B%AE.html"/>
      <url>/2018-06-03-%E7%94%B5%E5%8F%B0%E8%8A%82%E7%9B%AE.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>大约正好3年前，王东在网易云音乐的王东电台做了一期这样的电台节目，当时觉得很震撼，然后就下载了下来，然后不知道什么时候这期节目被删除了，这期节目里的一些歌曲也在各大音乐平台消失了，还好，当时下载了下来。<br>各位且听且珍惜。<br><a id="more"></a><br>        <div id="aplayer-jNXkPeKD" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-jNXkPeKD"),            narrow: false,            autoplay: true,            showlrc: false,            music: {              title: "为了忘却的记念",              author: "王东",              url: "http://p76pxmjnt.bkt.clouddn.com/%E7%8E%8B%E4%B8%9C%20-%20%E4%B8%BA%E4%BA%86%E5%BF%98%E5%8D%B4%E7%9A%84%E8%AE%B0%E5%BF%B5.mp3",              pic: "/2018-06-03-电台节目/电台.png",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script></p>]]></content>
      
      <categories>
          
          <category> 音乐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电台 </tag>
            
            <tag> 王东 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>杀人放火金腰带，修桥补路无尸骸</title>
      <link href="/2018-05-11-%E6%9D%80%E4%BA%BA%E6%94%BE%E7%81%AB.html"/>
      <url>/2018-05-11-%E6%9D%80%E4%BA%BA%E6%94%BE%E7%81%AB.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>5月7号我刷到一条微博，微博的内容让我十分震惊，然后我根据我有限的经验认为这条微博活不过一个小时，然后我对其进行了转发并加了句评论：<em>看看多久被删。。。</em><br><a id="more"></a><br>        <div id="aplayer-SyZeTEHO" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-SyZeTEHO"),            narrow: false,            autoplay: true,            showlrc: false,            music: {              title: "面会菜",              author: "林生祥",              url: "http://p76pxmjnt.bkt.clouddn.com/%E6%9E%97%E7%94%9F%E7%A5%A5%20-%20%E9%9D%A2%E4%BC%9A%E8%8F%9C.mp3",              pic: "/2018-05-11-杀人放火/有无封面.jpg",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><br>然后一语成谶，结果果真被删了，被删的不是我转发的原文，因为我去我看了看我转发的原文，原文并未被删除，转发的原文安然无而是我的转发：<br><img src="/images/2018-05/删除.png" alt="转发"><br>是什么原因导致了原文未被删除而我的转发被删除呢？只要看下原文就知道了：<br><img src="/images/2018-05/微博内容.png" alt="内容"><br>首先我认为原文的内容的逻辑就是一坨屎，但是这坨屎因为这次我被转发的删除而变得壮烈起来。那么为什么这篇微博原文未被删除而转发却被删除呢？原因就是因为发布者身份的特殊性：两国交战不杀来使。外交豁免权使得这条微博有了免死金牌，但是这条微博内容的敏感性不得不引起当局的注意，不得不减少传播转而删除转发内容，因此这条微博评论数有2万多而转发只有不到1000。虽然这条微博及其敏感而我的转发又死的极其壮烈，但是我不得不说这条微博的内容逻辑是一坨屎，但是这坨屎上面因为有了奥威尔的加成。<br>首先，这条微博偷换概念，把政治底线替换为政治正确。中文维基上政治正确的定义：使用一些用词及施行部分政治措施，避免冒犯及歧视社会上的弱势群体，如不能冒犯少数族群、女性、不同性取向、宗教信仰或持不同政见者，及身障人士。少数族群包括以国籍、种族、宗教划分的族群，与本国主流族群相比。“政治正确”不限于“用词正确”，也包括观点、立场、政策和行为的“正确性”，不能违背被认定为“正确”的立场。“政治正确”也被应用于非针对特定人群的范畴，例如气候变化、动物权益。那么这条微博里所指的政治正确是什么？”4月25日，中国民用航空局致信36家外国航空公司，其中包括多家美国航空公司。该通知要求航空公司更改其网站和宣传材料中有关“台湾”、“香港”和“澳门”的标识，以符合共产党的标准。<br>于是我用谷歌搜索了相关新闻，了解到这个事情大概是这个样子：<br><img src="/images/2018-05/新闻.png" alt="新闻"><br>于是我们可以理解，美国白宫秘书认为：把香港、澳门和台湾称之为地区而非国家是一种<strong>政治正确</strong>。<br>我不知道白宫秘书脑子坏了还是有意为之：把香港、澳门和台湾称之为地区而非国家是一种<strong>政治底线</strong>而非<strong>政治正确</strong>。而美国白宫把这种<strong>政治底线</strong>的概念偷换为<strong>政治正确</strong>，要么是脑子脑子蠢，要么是心眼坏，如果是前者，我只能自求美国人民自求多福，因为他们至少还要被这帮蠢猪统治2年，如果是后者，那也没有关系，因为这种坏心眼连我这种人都能看穿，遑论那些食肉糜之人。<br>其次，这个微博令人恶心的地方不在于其偷换概念，而在于其偷换了概念之后又要站在道德制高点上对我国进行批判，又要当婊子又要立牌坊。他搬出了在西方和东方极具影响力的“奥威尔”作为挡箭牌和遮羞布，使得这一坨逻辑跟屎一样的微博立马成为一坨有档次的屎，我明白“奥威尔式的胡言乱语”指的是什么，但是我不明白为什么他要在这个地方用这个词，如果说这个词有意义，那也只是让这坨屎变得有了点光鲜的色泽。<br>最后，可惜，这篇微博又回到了西方国家攻击中国的老套路，诚然，他的攻击并非空穴来风，我也并不支持中国对于互联网的压制，但是由于其前文竖立了一个错误的靶子，导致这一段论据显得毫无力量，吹弹可破。<br>当然，由于这条微博里出现了“奥威尔”、“中国对国内互联网的压制”等关键词，使得这条微博具有了对抗威权政治的力量，在情感上引起很多人的共鸣，但是，这也只能说这条微博是一坨色泽鲜艳的屎，而色泽鲜艳的是还是屎。<br>由于外交豁免权的存在，这条屎一样的微博至今还安详地躺在微博的服务器里，大家可以随时赏阅。但是今天我发现我在网易云音乐的一首纯音乐《面会菜》下一条评论被删除了，这条评论马上就要破千了，一直是热评数第一，我认为这条评论不带任何情感色彩，只是来自一个理科生对于自己所见所得的客观描述，只是对电影《大佛普拉斯》的一种白描化的评论，如果你在这条评论里读到了任何情感的因素，我想这是导演黃信堯太过优秀，把这个电影拍的如此动人，最后附上我这条被删的评论：<br>一个被社会抛弃的人<br>没有女朋友<br>没有稳定的收入来源<br>没有改变生存状态的能力<br>依靠别人扔掉的垃圾生存<br>夹娃娃来治愈自我<br>看成人杂志和行车记录仪的视频来解决生理需要<br>临死前吃的最好的一顿饭是面会菜<br>然后无力的被来自社会上层的车轮碾压<br>没有留下适合作遗像的照片<br>只有一个人形。</p><hr><p>经过与网易云管理员的沟通，我的评论又被恢复了，说明网易云还可以抢救一下。</p>]]></content>
      
      <categories>
          
          <category> 务虚笔记/胡言乱语 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 胡言乱语 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>暴裂无声，落地有形:《大佛普拉斯》与《暴裂无声》的一个感想</title>
      <link href="/2018-04-14-%E6%9A%B4%E8%A3%82%E6%97%A0%E5%A3%B0%EF%BC%8C%E8%90%BD%E5%9C%B0%E6%9C%89%E5%BD%A2.html"/>
      <url>/2018-04-14-%E6%9A%B4%E8%A3%82%E6%97%A0%E5%A3%B0%EF%BC%8C%E8%90%BD%E5%9C%B0%E6%9C%89%E5%BD%A2.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>我翻开历史一查，这历史没有年代，歪歪斜斜的每叶上都写着“仁义道德”几个字。我横竖睡不着，仔细看了半夜，才从字缝里看出字来，满本都写着两个字是“吃人”！ ——鲁迅《狂人日记》<br><img src="/images/2018-04/大佛普拉斯.jpg" alt="《大佛普拉斯》海报"><br><a id="more"></a><br>内含一定剧透，建议先看完电影再继续往下看</p><hr><p>在开始看文章前，建议点开下面这首音乐，这是《大佛普拉斯》的片尾曲，名字叫做《有无》，在第54届金马奖上获得了<strong>最佳原创电影歌曲</strong>（当然，《大佛普拉斯》的原声配乐也很好听，强烈推荐看完电影后去网易云上听一听，btw，其中评论数最高的那首配乐的最热评论就是我写的，我就不说具体哪一首了）。<br>        <div id="aplayer-Urfbrbre" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-Urfbrbre"),            narrow: false,            autoplay: true,            showlrc: false,            music: {              title: "有无",              author: "林生祥",              url: "http://p76pxmjnt.bkt.clouddn.com/%E6%9E%97%E7%94%9F%E7%A5%A5%20-%20%E6%9C%89%E6%97%A0%20%28%E7%89%87%E5%B0%BE%E6%9B%B2%29.mp3",              pic: "/2018-04-14-暴裂无声，落地有形/有无封面.jpg",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script></p><h1 id="阶级"><a href="#阶级" class="headerlink" title="阶级"></a>阶级</h1><p>昨天终于去看了去年9月份就开始期待的《暴裂无声》，看完这部电影后我的感受和看完《大佛普拉斯》感受很相似，我之所以觉得《暴裂无声》和《大佛普拉斯》的感受很相似，不是这两个电影的剧情很相似，而是两部电影的人物很相似，说两个人物相似也不是说这两个主角的遭遇相似，<strong>而是这两个主角的社会地位相似</strong>，不仅两个主角的社会地位相似，在两部电影中他们所要对抗的对手的社会地位也很相似。<br>两部电影主角：《暴裂无声》中的张保民一个是煤矿工人，《大佛普拉斯》里的肚财以捡垃圾为生，从社会的生态位上来说，<strong>一个是初级消费者，另一个介于初级消费者与分解者之间</strong>，前者还在创造着一定的社会价值，而后者只能拿别人不要的东西，虽说两者社会地位相似，但前者比后者还要高一些。<br>而两部电影主角的对头：《暴裂无声》里的煤矿老板昌万年是煤矿老板，每一个毛孔中都渗透着来自张保民们的血液；《大佛普拉斯》里的董事长黄启文是艺术家老板，拥有着足以碾死肚财们的力量，这两个人都是次级消费者，通过剥削初级消费者的剩余价值来获得资本积累，有趣的是，<strong>在电影里面，这两个人都喜欢戴假发</strong>。<br>而两部电影中所要探讨的一个问题是，当社会地位处于低端的人受到来自社会上层的冲击的时候会发生什么？ 在《暴裂无声》里，当一个无法说话的煤矿工人丢掉了自己的孩子，没有足够的社会资源，又没有审时度势眼光和冷静清醒的头脑，有的只是一股横冲直撞的狠劲，最后得到的结果只能是拳打棉花，暴裂无声，然而你我和他自己以及这个社会都对此无能为力，只能报之以无力的同情。在《大佛普拉斯》里，当一个没有改造命运的能力的拾荒者人凝视了太久的深渊，无意中知道了艺术家老板的秘密之后，无可选择地只能被来自上层的车轮碾压至死，最后只留下了地上的一个人形。</p><h1 id="吃人"><a href="#吃人" class="headerlink" title="吃人"></a>吃人</h1><p>说到了阶级，不免要说下资产阶级和资本主义。资产阶级通常会被认为是剥削无产阶级的人，剥削的方式即通过剩余价值：剩余价值是指剥削劳动者所生产的新价值中的利润（劳动创造的价值和工资之间的差异），即“劳动者创造的被资产阶级无偿占有的劳动”。我之前常常会想，资产阶级之所以占有了大量的剩余价值是因为其能力和魄力要高于普通的无产阶级，从而使其占有了大量的社会财富，但是现在我认为，<strong>在你成为资本家之前，能力与魄力对于资本家很重要，而当你成为资本家以后，最为重要的是你可以调动大量的人力资源和社会资源来完成自己想做的事情</strong>，从而实现资本的积累，但是在这个社会中，资本家寥寥，而无产阶级芸芸。我们知道腾讯是马化腾的，阿里巴巴是马云的，华为是任正非的，但我们经常忽略的就是站在他们身后的每天加班加点成千上万的程序员用生命和健康来换取生活的程序员们。这也许是我们忽略的一点：资产阶级之所以为资产阶级是因为他占有了大量的剩余价值，无产阶级之所以为无产阶级是因为他们被剥削了剩余价值，这也许就是鲁迅在《狂人日记》中吃人的另一层含义吧：压迫与被压迫，剥削与被剥削。<strong>当然，总要有人被压迫，总要有人被剥削，这就是现实，它是我们的宿命，悲哀而无法改变</strong>，而《大佛普拉斯》和《暴裂无声》表达的就是一种这样的悲哀。<br>当然，这两部电影肯定都还有很多解读方向，但是我看到的就是人与人之间的巨大差距，以及极端不平衡的进化优势。虽然我们都喜欢同情弱者，村上春树也说过在鸡蛋和墙之间自己永远选择鸡蛋，但是这个世界并不是因为你的社会地位相对弱势就会对你报以同情，即使你是正义的一方。正因如此，即使要想与上层的社会反抗，最后也只能在无声中暴烈，然后落向地面，只留下一个轮廓。</p>]]></content>
      
      <categories>
          
          <category> 浮光掠影/电影 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电影 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>哈佛《幸福课》之完美主义:完美是一种病</title>
      <link href="/2018-04-11-%E5%93%88%E4%BD%9B%E5%B9%B8%E7%A6%8F%E8%AF%BE%E4%B9%8B%E5%AE%8C%E7%BE%8E%E4%B8%BB%E4%B9%89.html"/>
      <url>/2018-04-11-%E5%93%88%E4%BD%9B%E5%B9%B8%E7%A6%8F%E8%AF%BE%E4%B9%8B%E5%AE%8C%E7%BE%8E%E4%B8%BB%E4%B9%89.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>说到处女座，大家第一反应是”完美主义”，完美主义因为里面含有<strong>完美</strong>两个字，让我们误以为<strong>完美主义是一个褒义词</strong>，但是</p><a id="more"></a><p>我在知乎上搜索了<strong>完美主义</strong>相关问题后，有一位<a href="https://www.zhihu.com/question/20759341/answer/16086702" target="_blank" rel="noopener">答主</a>将<strong>完美主义</strong>视作一个贬义词，并在答案里推荐了哈佛《幸福课》里的<strong>完美主义</strong>这一课， 于是我找到了视频来看，看完之后感觉这堂课真的是入木三分，如沐春风。于是想要把这堂课的内容总结下来，于是我看了第二遍，边看边总结，既是自己的一个总结，希望自己能过之能改，也希望其他人也能由此获益。同时，我不遗余力的向大家推荐<a href="http://open.163.com/movie/2006/1/6/K/M6HV755O6_M6I42KT6K.html" target="_blank" rel="noopener">这个视频</a>（链接里是网易公开课的链接，B站的资源在<a href="https://www.bilibili.com/video/av9781864/?p=15" target="_blank" rel="noopener">这里</a>）</p><h1 id="完美主义的病：不能容忍失败"><a href="#完美主义的病：不能容忍失败" class="headerlink" title="完美主义的病：不能容忍失败"></a>完美主义的病：不能容忍失败</h1><p>完美主义者往往对自己要求很高，从而导致自己无法接受失败。但是我们常常说<strong>失败是成功之母</strong>，这句话让大家总是感受到一点鸡汤的味道，但是这句话确实是有道理的，说它有道理不是说它仅仅在理论上正确，而是说技术上也是正确的。<br>首先定义一下什么是成功，我在这里对成功的定义是<strong>把一件需要一定技巧和脑力的事情做成</strong>。它可以是成功地炒了一道让自己让别人都满意的菜，也可以是写出了一个可以解决实际问题的程序，或者于是你学会了如何去画一个圆圈。<br>为了更为形象地解释这个道理，在课堂上Tal老师叫一个学生上去画圆圈，一开始让这个学生画一个尽可能完美的圆，然后又让学生画一个一年级水平学生画出来的圆，最后又让学生画一个一岁婴儿画出来的圆（如下图），最后老师来给这三个圆打分，不出所料，第一个圆及格，而第二个和第三个不及格。紧接着老师说，很抱歉，虽然你的第二个和第三个圆不及格，但是如果没有画过这两个圆，你能否画出第一个圆？<br>Tal老师这个例子举得发人深省，不仅仅是画圆，其他事情也是如此。如果在写程序是不出现一些bug不对程序做一些调试，我们永远都不知道我们哪些写的是对的哪些写得是错的，而如果不知道哪些是错的，我们以后就无法在写程序时避开这些错误，也就很难说我们真正掌握了一门编程语言。炒菜也是一样，如果不炒一些难吃菜出来，我们就不知道我们哪些调料该放多些，哪些该放少一些，火候该猛一些还是要柔一些。<br>从控制论的角度来讲，我们如果要掌握一门技能，或者说要控制一样东西，我们需要知道去如何控制，而如果要知道如何控制，就需要我们掌握一定量的信息，即我们不仅仅需要知道<strong>该怎么做，更要知道不应该怎么做</strong>，只有我们走一些弯路，犯一些错误以后才能深刻体会到不该怎么做。因此，犯错误是必须要走的路。<br>总而言之，成长过程中我们必须容忍我们犯错误，当然，没有人愿意犯错误，没有人喜欢失败，但是这是成长过程中的一部分，跌倒了，爬起来，下次知道哪里有坑然后绕开就是了。而完美主义者总是不容许自己出现失败，不容许自己出现错误，为什么完美主义者不容许自己出现错误？</p><h1 id="完美主义者vs最优主义者"><a href="#完美主义者vs最优主义者" class="headerlink" title="完美主义者vs最优主义者"></a>完美主义者vs最优主义者</h1><p><img src="/images/完美主义.png" alt="完美主义者 vs 最优主义者"><br>我们可以笼统粗暴地把人分为两类人，一类人是完美主义者（Perfectionist），另一类是最优主义者(Person commited to excellence ),这两种人的区别和特点在于对待人生中某一个过程的看法（即从A到B）是：完美主义者认为在人生过程中从A点到B点存在一条直线，因此完美主义者认为从A到B的过程必须沿着这条直线前进，<strong>任何对这条直线的偏离都将会导致失败</strong>。而最优主义者虽然也像完美主义者一样雄心勃勃，但是最优主义者明白现实生活中从A到B点并不存在一条直线，从A点到B点的过程中必将经历曲折，且在这个前进过程中，失败与挫折不可避免（例如在某些考试中不会得到自己想要的分数；没有评上奖学金），而在遇到失败后，最优主义者不会像完美主义者那样认为自己已经完了，而是从失败中汲取经验教训，然后成长变得更强。<br>然而冰冷的现实生活告诉我们，人生没有直线和捷径，要做成任何一件事必将经历曲折的过程：在Linux下安装gcc和R的过程是曲折的，提取DNA的过程是曲折的，发表一篇论文的过程是曲折的，这些曲折的出现并不是因为我们自己不够优秀，是因为它们是生活中不可避免的一部分，<strong>完美主义者并不是对自己要求高，而是对于现实生活的认识不够成熟，总是以为成功路上存在捷径</strong>，但是捷径是不存在的。</p><h1 id="劳碌命"><a href="#劳碌命" class="headerlink" title="劳碌命"></a>劳碌命</h1><p>完美主义者总是不满足于现状，这种进取之心虽然经常会给我们带来动力，但是这样经常会让他们的人生充满压力，他们总是以为当有一天从A点到达B点之后就可以轻松了，但是事实是一旦有了这种心态，那么人生永远都不可能轻松，这就是我们常说的劳碌命（rat racer）。我们不妨来看这样一个故事：</p><blockquote><p>我们姑且称这个人为X，X在上幼儿园和学前班之前一直生活的很快乐，但是当他进入小学的时候，压力就随之而来了，因为他意识到，如果自己想要去一所好的初中，就必努力学习并做到最好以面对激烈的竞争，因此他的压力越来越大，他也不再有上小学之前那种学习的快乐，在平日里要努力学习，只有在节假日和刚刚结束考试的日子里才能享受到片刻的放松。最后，功夫不负有心人，他终于进入了自己理想的初中。<br>由于之前的目标已经完成，他感觉良好，但是这种感觉也只是维持了两周，因为他的下一步是要考取自己理想中的高中，这所高中是他梦寐以求的学校，于是他在初中期间拼命努力学习，虽然他并不喜欢这种感觉。最后，他如愿以偿地进入了自己理想的高中。<br>他为此欣喜若狂，但是这种喜悦只维持了一周。这所学校竞争更加激烈，他参加了两个校体育队和三个学生社团，他每天疲于奔命，但是他想，这种忙碌是暂时的，等他考上了自己理想的大学一切都值了。最后，他终于收到了自己心仪大学的录取通知书。他再一次欣喜若狂，这一次，他比之前被理想高中录取还要高兴，他觉得自己终于可以放松了。<br>在刚刚进入大学的时候他很放松，但是刚刚过了新生周，他就开始了自己的忙碌。因为期中考试马上就要到来，这里竞争很激烈，大家学习都很努力，他也不得不努力学习。除了学习，他参加了两个校队和一个社团，以期望得到自己理想公司的岗位，因为得到那个岗位很难。功夫不负有心人，他最终得到了梦寐以求的岗位。但是他又有了新的目标-进入商学院，这样就能商界一帆风顺。于是他努力工作，没有付出便没有收获，通过自己的努力，他最终进入了商学院，从商学院毕业后成为了公司职员，他对此感到满意，然而好景不长，他又有了新的目标-成为公司的合伙人，于是他又为此努力工作，每天充满压力，终于，他成为了公司的合伙人。然而好景又不长，他现在只是初级合伙人，为了成为高级合伙人，他不得不再次为此付出努力，他每天充满压力和焦虑，然而由于他的出色工作，最终他成为了这个公司的高级合伙人。他为此给自己买了个度假别墅，高兴了一阵子。但是好景又又又不长，他想成为这个公司的CEO，他有为此拼命工作，终于皇天不负有心人， 他成为了这家公司的首席执行官，登上了《华尔街日报》封面。<br>公司在他治下井井有条，董事会对他的工作很满意。有一天，他进入了自己的办公室，把腿放在了桌子上，向后张望着中央公园的美景。然而此时董事会主席敲门走了进来，告诉他：谢谢您的工作，公司在您治下业绩出色，但是现在您该退休了。<br>此时他已经74岁了。</p></blockquote><p>这就是我们想象中劳碌命所能过到的最好的一生。当一个目标没有达成时，他总是全神贯注于这个目标，想着当目标完成时就可以休息了，但是当目标完成时，新的目标又出现了，如此循环往复，永无停歇。<br>因此，<strong>我们每个人要问一问自己到底想要什么样的生活？现在的生活究竟是不是自己想要的？</strong></p><h1 id="在生活中多尝试"><a href="#在生活中多尝试" class="headerlink" title="在生活中多尝试"></a>在生活中多尝试</h1><p>Wiseman教授做了一个研究想看看如何能遇到更多的好运气，研究表明，要想拥有好运气，就要多尝试走不同的道路，多做一些偏离之前道路的事情，只有这样我们才能遇到新的东西，给我们的生活带来改变，而完美主义者常常拒绝偏离改变，他们觉得只有照着之前的路来走才能通向成功。</p><h1 id="二八原则"><a href="#二八原则" class="headerlink" title="二八原则"></a>二八原则</h1><p>我们都听说过二八原则，即80%的财富掌握在20%人的手里，推而广之，80%的收入来源于20%的客户，80%的工作可以在20%的时间内完成。这个原理可以从两个方面去应用。<br>第一，我们要知道我们工作中哪些工作是关键的或者是对自己来说比较重要的工作，这些工作就是80%的工作，然后用我们20%的时间去优先完成。<br>第二，我们每个人每天都有高峰期和低谷期，我们要找到自己的高峰期，然后用这个高峰期去完成80%的工作。</p><h1 id="完美主义的来源"><a href="#完美主义的来源" class="headerlink" title="完美主义的来源"></a>完美主义的来源</h1><p><strong>完美主义很大程度来源于社会环境</strong>。我们从小就被鼓励少犯错和得到成功。当我们学会走路时，家长会说“干的漂亮”，当我们考了高分时，家长会说“太棒了，奖励你一个星星”。从家长，老师到媒体，学校，大家只会关心结果，没有谁会因为努力而被受到奖励，这样的社会环境改变了我们，关注结果而不关心过程的模式在我们头脑中根深蒂固，这样直接导致我们舍本逐末，不关心过程，不喜欢遭受曲折和失败。</p><h1 id="没有完美的关系"><a href="#没有完美的关系" class="headerlink" title="没有完美的关系"></a>没有完美的关系</h1><p>我们总会觉得真正的爱情总是甜蜜的没有争吵的，但是争吵和纠结是爱情的一部分，当这一切发生时，我们要坦然面对并去解决问题。</p><h1 id="关于夸奖的实验"><a href="#关于夸奖的实验" class="headerlink" title="关于夸奖的实验"></a>关于夸奖的实验</h1><p>斯坦福大学的Carol Dweck 的研究表明：并不是所有夸奖都有好效果。总是夸奖孩子“你做的很棒！”、“你很聪明”、“我的小小爱因斯坦”并不是总能带来好效果。从长远看甚至会有害：会导致孩子的完美主义更加严重。<br>她找了一群10岁的学生，并将它们分成两组，实验第一阶段，两组学生都做同样的题目，而不同的是：第一组在做完题目后，老师们会夸奖每个学生“你做的太棒了”；而第二组在做完题目后，老师会对他们说“你很认真！努力地完成了题目！”。实验第二阶段，老师给学生出了两道题，然后告诉学生们其中一道题相对简单，更容易做对；而另一道题很难，但是学生们会获得更多。然后第一组中50%的学生选择了简单题，另外50%学生选择了难题；第二组中90%的学生选择了难题，另外10%选择了难题。实验第三阶段，老师让这些学生做一道非常难的几乎不可能做出来的几乎无解的题，然后第一组的学生在思考了一段时间后感到很沮丧，然后大多数人放弃了这道题。而第二组的学生很认真的思考这个题目并非常享受解题的过程，虽然最后他们也没能做出来，但是他们坚持了更长的时间。<br>Carol Dweck对这个结果的结论是(让我们在心里默念三遍这个掷地有声的结论)：<strong>强调努力的重要性给了学生一个可控的变量，他们觉得成功在自己的掌握当中，而强调天生的聪慧会剥夺学生对于成功的控制，也并没有给他们提供面对失败的策略。当你在夸奖了一个学生聪明之后，如果他们失败了，他们觉得自己不再聪明了，之后他们就会失去对工作的兴趣，而那些因为努力收到表扬的学生，面对困难时不会受挫，而且会士气高涨</strong>。</p><h1 id="如何克服完美主义"><a href="#如何克服完美主义" class="headerlink" title="如何克服完美主义"></a>如何克服完美主义</h1><ol><li>自我认知：认识到自己哪里有不足，然后去改正和提高，而不是视而不见</li><li>强调努力的重要性：以发展的眼光看世界，关注努力的过程，改变自己注重结果的思维方式</li><li>接受现实： 完美主义会贯穿我们的一生，我们需要不断与其作斗争。</li></ol>]]></content>
      
      <categories>
          
          <category> 专业外/心理学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 心理学 </tag>
            
            <tag> 幸福课 </tag>
            
            <tag> 完美主义 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux下源码安装R(干净版)</title>
      <link href="/2018-04-09-Linux%E4%B8%8B%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85R(%E5%B9%B2%E5%87%80%E7%89%88).html"/>
      <url>/2018-04-09-Linux%E4%B8%8B%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85R(%E5%B9%B2%E5%87%80%E7%89%88).html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>去年10月份曾经写过一个比较曲折的R安装教程，里面给自己加了很多戏，本以为有那篇教程在前，这下在阿里云上部署R会是一马平川，没想到还是踩了几个之前没踩过的坑，于是将这次的教训跟之前的教程整理一下，写一个比较干净的教程。如果你们想体会下之前我安装R的内心戏，可以看下这篇文章<a href="/2018-04-02-R安装.html" title="Linux下安装R(心路历程版)">Linux下安装R(心路历程版)</a></p><a id="more"></a><p>这个教程主要分三个部分：1.主要库的准备；2.环境变量的配置；3.R主体的安装；4.其他可能遇到的问题及解决方案。</p><h1 id="1-主要库的准备"><a href="#1-主要库的准备" class="headerlink" title="1. 主要库的准备"></a>1. 主要库的准备</h1><blockquote><p>注：所有的builder文件夹都代表你的目标文件夹,你的库的源码的文件夹跟你要安装的目标文件夹最好分开</p></blockquote><p>1.1安装zlib<code>1.2.5版本及以上</code><br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd zlib<span class="number">-1.2</span><span class="number">.11</span></span><br><span class="line">/export/app/src/zlib<span class="number">-1.2</span><span class="number">.11</span>/configure --prefix =/export/app/zlib<span class="number">-1.2</span><span class="number">.11</span></span><br><span class="line">make  </span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>1.2安装bzip<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd bzip2<span class="number">-1.0</span><span class="number">.6</span></span><br><span class="line">make -f Makefile-libbz2_so</span><br><span class="line">修改Makefile 中的PREFIX=/export/app/bzip2<span class="number">-1.0</span><span class="number">.6</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></p><p>1.3安装liblzma<code>5.0.3版本及以上</code><br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir xz<span class="number">-5.2</span><span class="number">.3</span></span><br><span class="line">cd xz<span class="number">-5.2</span><span class="number">.3</span></span><br><span class="line">/export/app/src/xz<span class="number">-5.2</span><span class="number">.3</span>/configure -prefix=/export/app/xz<span class="number">-5.2</span><span class="number">.3</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>1.4安装pcre<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir pcre-8.42</span><br><span class="line"><span class="keyword">cd</span> pcre-8.42</span><br><span class="line"><span class="string">/export/app/src/pcre-8.42/configure</span> <span class="params">--prefix</span> <span class="string">/export/app/pcre-8.42</span> <span class="params">--enable-utf</span> <span class="params">--enable-unicode-properties</span> <span class="params">--enable-jit</span> <span class="params">--disable-cpp</span> <span class="comment">##这个包的安装参数是有要求的，因此用的是官方文档的推荐命令</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>1.5安装libcurl<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf  curl<span class="number">-7.28</span><span class="number">.0</span>.tar.gz</span><br><span class="line">mkdir curl<span class="number">-7.28</span><span class="number">.0</span></span><br><span class="line">cd curl<span class="number">-7.28</span><span class="number">.0</span></span><br><span class="line">/export/app/src/curl<span class="number">-7.28</span><span class="number">.0</span>/configure --prefix=/export/app/curl<span class="number">-7.28</span><span class="number">.0</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>1.6配置<code>jdk</code><br>这个需要去<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">官网</a>下载适合你机器系统的版本，然后解压到相应文件夹。</p><h1 id="2-及环境变量的配置"><a href="#2-及环境变量的配置" class="headerlink" title="2.及环境变量的配置"></a>2.及环境变量的配置</h1><p>在<code>~/.bash_profile</code>中加入如下环境变量：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###zlib</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ver</span>=<span class="string">"zlib-1.2.11"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">C_INCLUDE_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/include:<span class="variable">$&#123;C_INCLUDE_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/lib:<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LIBRARY_PATH</span>=<span class="string">"<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###curl</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ver</span>=<span class="string">"curl-7.28.0"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">C_INCLUDE_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/include:<span class="variable">$&#123;C_INCLUDE_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/lib:<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/bin:<span class="variable">$&#123;PATH&#125;</span>"</span>   </span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LIBRARY_PATH</span>=<span class="string">"<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###bzip</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ver</span>=<span class="string">"bzip2-1.0.6"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">C_INCLUDE_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/include:<span class="variable">$&#123;C_INCLUDE_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/lib:<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LIBRARY_PATH</span>=<span class="string">"<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###pcre</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ver</span>=<span class="string">"pcre-8.42"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">C_INCLUDE_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/include:<span class="variable">$&#123;C_INCLUDE_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/lib:<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LIBRARY_PATH</span>=<span class="string">"<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###xz</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ver</span>=<span class="string">"xz-5.2.3"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">C_INCLUDE_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/include:<span class="variable">$&#123;C_INCLUDE_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/lib:<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LIBRARY_PATH</span>=<span class="string">"<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Java_JRE</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ver</span>=<span class="string">"jdk1.8.0_161"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=<span class="string">"/export/app/jdk1.8.0_161"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=<span class="string">"<span class="variable">$&#123;JAVA_HOME&#125;</span>/lib/"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:$&#123;PATH&#125;</span><br></pre></td></tr></table></figure></p><p>然后<strong>重新登录一个bash</strong>，开始下一步安装<code>R</code>.</p><h1 id="3-安装R主体"><a href="#3-安装R主体" class="headerlink" title="3.安装R主体"></a>3.安装R主体</h1><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/export/app/src/R-3.4.4/configure</span> <span class="params">--prefix=/export/app/R-3</span>.4.4 <span class="params">--enable-R-shlib</span> <span class="params">--with-cairo</span>  <span class="params">--with-jpeglib</span> <span class="params">--with-readline</span> <span class="params">--with-tcltk</span>  <span class="params">--with-blas</span> <span class="params">--with-lapack</span> <span class="params">--enable-R-profiling</span> <span class="params">--with-x=no</span> LDFLAGS=<span class="string">"-L/export/app/bzip2-1.0.6/lib"</span> CPPFLAGS=<span class="string">"-I/export/app/bzip2-1.0.6/include"</span></span><br></pre></td></tr></table></figure><p>其中<code>LDFLAGS</code>和<code>CPPFLAGS</code>后面的路径要置换成你的<code>bzip</code>包的安装路径。本来我们在第二部分里配置了这个库的环境变量的，但是不知道为什么这个不行。<br>然后<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span></span><br><span class="line"><span class="built_in">make</span> install</span><br></pre></td></tr></table></figure></p><p>这样就安装完成了，然后就可以将<code>R</code>加入环境变量<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## R</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ver</span>=<span class="string">"R-3.4.4"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">R_LIBS</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/library"</span></span><br></pre></td></tr></table></figure></p><p>这样只要运行<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">R</span></span><br></pre></td></tr></table></figure></p><p>就会显示<br><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ R</span><br><span class="line"></span><br><span class="line">R version <span class="number">3.4</span>.<span class="number">4</span> (<span class="number">2018</span>-<span class="number">03</span>-<span class="number">15</span>) <span class="comment">-- "Someone to Lean On"</span></span><br><span class="line">Copyright (C) <span class="number">2018</span> The R Foundation <span class="keyword">for</span> Statistical Computing</span><br><span class="line">Platform: x86_64-pc-linux-gnu (<span class="number">64</span>-<span class="built_in">bit</span>)</span><br><span class="line"></span><br><span class="line">R <span class="keyword">is</span> free software <span class="keyword">and</span> comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY.</span><br><span class="line">You are welcome <span class="keyword">to</span> redistribute it under certain conditions.</span><br><span class="line"><span class="keyword">Type</span> <span class="symbol">'license</span>()' <span class="keyword">or</span> <span class="symbol">'licence</span>()' <span class="keyword">for</span> distribution details.</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Natural</span> language support but running <span class="keyword">in</span> an English locale</span><br><span class="line"></span><br><span class="line">R <span class="keyword">is</span> a collaborative project <span class="keyword">with</span> many contributors.</span><br><span class="line"><span class="keyword">Type</span> <span class="symbol">'contributors</span>()' <span class="keyword">for</span> more information <span class="keyword">and</span></span><br><span class="line"><span class="symbol">'citation</span>()' <span class="keyword">on</span> how <span class="keyword">to</span> cite R <span class="keyword">or</span> R packages <span class="keyword">in</span> publications.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Type</span> <span class="symbol">'demo</span>()' <span class="keyword">for</span> some demos, <span class="symbol">'help</span>()' <span class="keyword">for</span> <span class="keyword">on</span>-<span class="literal">line</span> help, <span class="keyword">or</span></span><br><span class="line"><span class="symbol">'help</span>.start()' <span class="keyword">for</span> an HTML browser interface <span class="keyword">to</span> help.</span><br><span class="line"><span class="keyword">Type</span> <span class="symbol">'q</span>()' <span class="keyword">to</span> quit R.</span><br><span class="line"></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p><h1 id="4-可能的报错以及解决方法"><a href="#4-可能的报错以及解决方法" class="headerlink" title="4.可能的报错以及解决方法"></a>4.可能的报错以及解决方法</h1><p>4.1<code>libcurl</code>的环境变量配置问题<br>报错：<br><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">configure: <span class="literal">error</span>: libcurl &gt;= <span class="number">7.22</span>.<span class="number">0</span> <span class="keyword">library</span> <span class="keyword">and</span> headers are required <span class="keyword">with</span> support <span class="keyword">for</span> https</span><br></pre></td></tr></table></figure></p><p>在这里面有一个坑就是<code>libcurl</code>在配置环境变量时一定要将<code>bin</code>的路径也加入至环境变量，不然就会报错,而其他库则没有此要求。可以回头再看下3。<br>解决方法：将<code>export PATH=&quot;/export/app/${ver}/bin:${PATH}&quot;</code>加入环境变量，如下所示。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###curl</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ver</span>=<span class="string">"curl-7.28.0"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">C_INCLUDE_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/include:<span class="variable">$&#123;C_INCLUDE_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/lib:<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="string">"/export/app/<span class="variable">$&#123;ver&#125;</span>/bin:<span class="variable">$&#123;PATH&#125;</span>"</span>    ####就是它</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LIBRARY_PATH</span>=<span class="string">"<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span>"</span></span><br></pre></td></tr></table></figure></p><p>4.2<code>jdk</code>版本不对<br>报错：<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/<span class="class"><span class="keyword">lib</span>/<span class="title">ld</span>-<span class="title">linux</span>.<span class="title">so</span>.2: <span class="title">bad</span> <span class="title">ELF</span> <span class="title">interpreter</span>: <span class="title">No</span> <span class="title">such</span> <span class="title">file</span> <span class="title">or</span> <span class="title">directory</span></span></span><br></pre></td></tr></table></figure></p><p>或<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">conftest.c:<span class="number">1</span>:<span class="number">17</span>: fatal <span class="built_in">error</span>: jni.h: No such file <span class="keyword">or</span> directory</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> &lt;jni.h&gt;</span></span><br><span class="line">                ^</span><br><span class="line">compilation terminated.</span><br><span class="line"><span class="built_in">make</span>[<span class="number">2</span>]: *** [conftest.o] <span class="built_in">Error</span> <span class="number">1</span></span><br><span class="line"><span class="built_in">make</span>[<span class="number">2</span>]: Leaving directory `/tmp/Rjavareconf.xQ4EzH'</span><br><span class="line">Unable to <span class="keyword">compile</span> a JNI program</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">JAVA_HOME        : /usr/<span class="keyword">lib</span>/jvm/java<span class="number">-1.7</span><span class="number">.0</span>-openjdk<span class="number">-1.7</span><span class="number">.0</span><span class="number">.151</span>.x86_64/jre</span><br><span class="line">Java <span class="keyword">library</span> path:</span><br><span class="line">JNI cpp flags    :</span><br><span class="line">JNI linker flags :</span><br><span class="line">Updating Java configuration in /export/app/R<span class="number">-3.4</span><span class="number">.4</span></span><br><span class="line">Done.</span><br><span class="line"></span><br><span class="line"><span class="built_in">make</span>[<span class="number">1</span>]: Leaving directory `/export/app/R<span class="number">-3.4</span><span class="number">.4</span>'</span><br></pre></td></tr></table></figure></p><p>可能是64位系统装了32位的<code>jdk或者</code>jdk<code>版本不对，去官网重新下载适合自己的版本的</code>jdk`。<br>如果不知道你机器的版本，用下面这两个命令：<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a              <span class="comment"># 查看内核/操作系统/CPU信息</span></span><br><span class="line">head -n <span class="number">1</span> <span class="regexp">/etc/i</span>ssue  <span class="comment"># 查看操作系统版本</span></span><br></pre></td></tr></table></figure></p><p>比如我的结果是<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2<span class="selector-class">.6</span><span class="selector-class">.32-696</span><span class="selector-class">.13</span><span class="selector-class">.2</span><span class="selector-class">.el6</span><span class="selector-class">.x86_64</span></span><br></pre></td></tr></table></figure></p><p>说明我应该下载<code>64</code>位的<code>jdk</code>。<br>4.3安装<code>xlsx</code>等R包调用<code>java</code>时报错<br><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">checking whether setjmp.h <span class="keyword">is</span> POSIX<span class="number">.1</span> compatible... yes</span><br><span class="line">checking whether sigsetjmp <span class="keyword">is</span> declared... yes</span><br><span class="line">checking whether siglongjmp <span class="keyword">is</span> declared... yes</span><br><span class="line">checking Java support <span class="keyword">in</span> R... present:</span><br><span class="line">interpreter : <span class="comment">'/usr/bin/java'</span></span><br><span class="line">archiver    : <span class="comment">''</span></span><br><span class="line">compiler    : <span class="comment">''</span></span><br><span class="line">header prep.: <span class="comment">''</span></span><br><span class="line">cpp flags  : <span class="comment">''</span></span><br><span class="line">java libs  : <span class="comment">''</span></span><br><span class="line">configure: <span class="keyword">error</span>: Java Development Kit (JDK) <span class="keyword">is</span> missing <span class="keyword">or</span> <span class="keyword">not</span> registered <span class="keyword">in</span> R</span><br><span class="line">Make sure R <span class="keyword">is</span> configured <span class="keyword">with</span> full Java support (including JDK). Run</span><br><span class="line">R CMD javareconf</span><br><span class="line"><span class="keyword">as</span> root <span class="keyword">to</span> add Java support <span class="keyword">to</span> R.</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> you don<span class="comment">'t have root privileges, run</span></span><br><span class="line">R CMD javareconf -e</span><br><span class="line"><span class="keyword">to</span> <span class="keyword">set</span> all Java-related variables <span class="keyword">and</span> <span class="keyword">then</span> install rJava.</span><br><span class="line"></span><br><span class="line"><span class="keyword">ERROR</span>: configuration failed <span class="keyword">for</span> package ‘rJava’</span><br><span class="line">* removing ‘/export/app/R<span class="number">-3.4</span><span class="number">.4</span>/library/rJava’</span><br><span class="line"><span class="keyword">ERROR</span>: dependency ‘rJava’ <span class="keyword">is</span> <span class="keyword">not</span> available <span class="keyword">for</span> package ‘xlsxjars’</span><br><span class="line">* removing ‘/export/app/R<span class="number">-3.4</span><span class="number">.4</span>/library/xlsxjars’</span><br><span class="line"><span class="keyword">ERROR</span>: dependencies ‘rJava’, ‘xlsxjars’ are <span class="keyword">not</span> available <span class="keyword">for</span> package ‘xlsx’</span><br><span class="line">* removing ‘/export/app/R<span class="number">-3.4</span><span class="number">.4</span>/library/xlsx’</span><br></pre></td></tr></table></figure></p><p>解决方案：同4.2点。</p><hr><p>最后：如果你遇到了其他问题，欢迎你在评论里留下你的问题和报错代码，方便我完善这个文章，谢谢！</p>]]></content>
      
      <categories>
          
          <category> 生信/软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ggplot箱线图之如何添加最大值最小值线(whisker-ends)</title>
      <link href="/2018-04-02-ggplot%E7%AE%B1%E7%BA%BF%E5%9B%BE%E4%B9%8B%E5%A6%82%E4%BD%95%E6%B7%BB%E5%8A%A0%E6%9C%80%E5%A4%A7%E5%80%BC%E6%9C%80%E5%B0%8F%E5%80%BC%E7%BA%BF(whisker-ends).html"/>
      <url>/2018-04-02-ggplot%E7%AE%B1%E7%BA%BF%E5%9B%BE%E4%B9%8B%E5%A6%82%E4%BD%95%E6%B7%BB%E5%8A%A0%E6%9C%80%E5%A4%A7%E5%80%BC%E6%9C%80%E5%B0%8F%E5%80%BC%E7%BA%BF(whisker-ends).html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><code>ggplot</code>作为R语言画图的瑞士军刀，相比于基础的R包，语法更加易于理解和掌握，不需要掌握很多的命令就能画出整洁美观的图表。比方说用<code>ggplot</code>来画箱线图，首先我们可以这样操作：</p><a id="more"></a><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">ggplot2</span>)</span><br><span class="line">library(<span class="name">RColorBrewer</span>)</span><br><span class="line">p &lt;- ggplot(<span class="name">mpg</span>, aes(<span class="name">class</span>, hwy))</span><br><span class="line">p + geom_boxplot(<span class="name">aes</span>(<span class="name">colour=class</span>),width=0.<span class="number">5</span>)+</span><br><span class="line">  theme(<span class="name">panel</span>.background = element_blank(),axis.ticks=element_blank(),legend.position=<span class="string">"none"</span>,axis.line = element_line(<span class="name">colour=</span><span class="string">"black"</span>,arrow=arrow(<span class="name">length</span> = unit(<span class="number">0.20</span>, <span class="string">"npc"</span>))))</span><br></pre></td></tr></table></figure><p>得到下图<br><img src="http://upload-images.jianshu.io/upload_images/166439-901d0d1857bd5dc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ggplot的箱线图"><br>但是在基础R包绘制的箱线图和大部分的箱线图中是这样的<br><img src="http://upload-images.jianshu.io/upload_images/166439-fa581c058200cfa6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="基础R包的箱线图"><br>相比较于基础R包的箱线图，<code>ggplot</code>的箱线图缺少了最大值和最小值的两条须线（whisker-ends），于是我谷歌后找到了一个<a href="https://stackoverflow.com/questions/12993545/how-to-put-whisker-ends-on-ggplot2-boxplot" target="_blank" rel="noopener">网页</a>,参照网页中的操作，我在我的代码中加入了<code>stat_boxplot</code>,变成<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">ggplot2</span>)</span><br><span class="line">library(<span class="name">RColorBrewer</span>)</span><br><span class="line">p &lt;- ggplot(<span class="name">mpg</span>, aes(<span class="name">class</span>, hwy))</span><br><span class="line">p + geom_boxplot(<span class="name">aes</span>(<span class="name">colour=class</span>),width=0.<span class="number">5</span>)+</span><br><span class="line">  stat_boxplot(<span class="name">geom</span> = <span class="string">"errorbar"</span>,width=0.<span class="number">15</span>,aes(<span class="name">color=class</span>))+</span><br><span class="line">  theme(<span class="name">panel</span>.background = element_blank(),axis.ticks=element_blank(),legend.position=<span class="string">"none"</span>,axis.line = element_line(<span class="name">colour=</span><span class="string">"black"</span>,arrow=arrow(<span class="name">length</span> = unit(<span class="number">0.20</span>, <span class="string">"npc"</span>))))</span><br></pre></td></tr></table></figure></p><p><img src="http://upload-images.jianshu.io/upload_images/166439-6994ae7c13f9c28e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="加上须线后的box图"><br>但是这样有一个问题，加上去的须线会挡住我们的box，显得图很乱，后来比照了前面的<a href="https://stackoverflow.com/questions/12993545/how-to-put-whisker-ends-on-ggplot2-boxplot" target="_blank" rel="noopener">网页</a>和我的代码，发现他的<code>stat_boxplot</code>在<code>geom_boxplot</code>前面，后来我想，之所以我的图会变成这样是因为<code>ggplot</code>是以图层的方式进行绘图，即后一个图层会覆盖前一个图层，因此我的代买里面先<code>geom_boxplot</code>后<code>stat_boxplot</code>导致前面的box被后面的线覆盖掉，如果不想出现这种情况，那就只需要将这两个命令调整一下顺序,修改代码如下：<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">ggplot2</span>)</span><br><span class="line">library(<span class="name">RColorBrewer</span>)</span><br><span class="line">p &lt;- ggplot(<span class="name">mpg</span>, aes(<span class="name">class</span>, hwy))</span><br><span class="line">p + stat_boxplot(<span class="name">geom</span> = <span class="string">"errorbar"</span>,width=0.<span class="number">15</span>,aes(<span class="name">color=class</span>))+</span><br><span class="line">  geom_boxplot(<span class="name">aes</span>(<span class="name">colour=class</span>),width=0.<span class="number">5</span>)+</span><br><span class="line">  theme(<span class="name">panel</span>.background = element_blank(),axis.ticks=element_blank(),legend.position=<span class="string">"none"</span>,axis.line = element_line(<span class="name">colour=</span><span class="string">"black"</span>,arrow=arrow(<span class="name">length</span> = unit(<span class="number">0.20</span>, <span class="string">"npc"</span>))))</span><br></pre></td></tr></table></figure></p><p><img src="http://upload-images.jianshu.io/upload_images/166439-e9f8c9a060ab9a3c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="最终修改完的"></p><p>最终总结：记住<code>ggplot</code>是基于图层的绘图系统。</p>]]></content>
      
      <categories>
          
          <category> 生信/软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> R </tag>
            
            <tag> 画图 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux下安装R(心路历程版)</title>
      <link href="/2018-04-02-R%E5%AE%89%E8%A3%85.html"/>
      <url>/2018-04-02-R%E5%AE%89%E8%A3%85.html</url>
      <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>不像在windows上面下载安装包进行安装那么简单，你只要选择好安装目录，然后一直<code>next</code>就行。<br>要在<code>Linux</code>下通过源码安装R包是一件非常耗时耗力的事情。由于个人工作性质的原因，需要常常使用大型机进行作业，但是大型机基本都是<code>Linux</code>系统，由于需要使用<code>R</code>,并且经常会做一些个性化分析，需要自己安装相应的R包，但是由于自己没有root权限，在安装软件时难免会收到这样那样的掣肘。我第一次安装R以失败告终，因为安装R时会告诉你需要A库，然后你去安装A库，但是当你去安装A库的时候又会告诉你需要安装B库，如此循环往复，最后终于心撕力竭，手头又有其他事情要忙，终于铩羽而归。但是有一天遇到王道明，他正好也有过如此安装R的经历，最后捯饬了半天终于成功，最后还把这个经历总结下来，我当时内心狂喜，仿佛得到了武功秘籍。想着终于可以痛快地安装R了，但是事实证明我还是<code>Too young Too simple</code>,最后还是经历了之前没有预想到的大坑，凭借着王道明的安装指南和R官方文档，才终于功德圆满，取经归来。</p><a id="more"></a><h1 id="第一难：R依赖库的安装"><a href="#第一难：R依赖库的安装" class="headerlink" title="第一难：R依赖库的安装"></a>第一难：R依赖库的安装</h1><p>在安装R之前首先要安装R依赖的包，如何知道R安装需要什么包呢？可以去看R的官方文档<a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Essential-and-useful-other-programs-under-a-Unix_002dalike" target="_blank" rel="noopener">R Installation and Administration </a>,我们主要要安装的依赖包是zlib，bzip，liblzma(这个包如果直接搜索liblzma出来的会是XZ，没错，需要安装的就是XZ)以及PCRE。不过首先需要注意的是，我安装的R版本是R-3.4.2 <code>Short Summer，2017-09-28发行</code>，而依照的官方文档也是Version 3.4.2 <code>2017-09-28</code>，因此其他版本的不一定完全适用，但是一般来说R所依赖的包大致都是这些，可能有版本的区别，安装R的大致顺序也差不多。其次，在安装这些库时最好遵照我下面给出的顺序来依次进行。否则就会报错。</p><h2 id="1-安装zlib1-2-5版本及以上"><a href="#1-安装zlib1-2-5版本及以上" class="headerlink" title="1.安装zlib1.2.5版本及以上"></a>1.安装zlib<code>1.2.5版本及以上</code></h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> zlib-1.2.11</span><br><span class="line"><span class="string">./configure</span> <span class="params">--prefix</span> =<span class="string">/bulider/software/zlib</span></span><br><span class="line">make  </span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h2 id="2-安装bzip"><a href="#2-安装bzip" class="headerlink" title="2.安装bzip"></a>2.安装bzip</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> bzip2-<span class="number">1.0</span>.<span class="number">6</span></span><br><span class="line"><span class="keyword">make</span> -<span class="keyword">f</span> Makefile-libbz2_so</span><br><span class="line">修改Makefile 中的PREFIX=/bulider/software/bzip2</span><br><span class="line"><span class="keyword">make</span> &amp;&amp; <span class="keyword">make</span> install</span><br></pre></td></tr></table></figure><h2 id="3-安装liblzma5-0-3版本及以上"><a href="#3-安装liblzma5-0-3版本及以上" class="headerlink" title="3.安装liblzma5.0.3版本及以上"></a>3.安装liblzma<code>5.0.3版本及以上</code></h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> xz-5.2.3</span><br><span class="line"><span class="string">./configure</span> -prefix=<span class="string">/bulider/software/xz</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h2 id="4-安装pcre"><a href="#4-安装pcre" class="headerlink" title="4.安装pcre"></a>4.安装pcre</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf pcre-8.41.tar.gz</span><br><span class="line"><span class="keyword">cd</span> pcre-8.41</span><br><span class="line"><span class="string">./configure</span> <span class="params">--enable-utf</span> <span class="params">--enable-unicode-properties</span> <span class="params">--enable-jit</span> <span class="params">--disable-cpp</span> <span class="params">--prefix</span> <span class="string">/bulider/software/pcre</span><span class="comment">##这个包的安装参数是有要求的，因此用的是官方文档的推荐命令</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h2 id="5-安装libcurl7-22-0及以上，但是不要超过版本8"><a href="#5-安装libcurl7-22-0及以上，但是不要超过版本8" class="headerlink" title="5.安装libcurl7.22.0及以上，但是不要超过版本8"></a>5.安装libcurl<code>7.22.0及以上，但是不要超过版本8</code></h2><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -zxf curl<span class="number">-7.28</span><span class="number">.0</span>.tar.gz</span><br><span class="line">cd curl<span class="number">-7.28</span><span class="number">.0</span></span><br><span class="line">./configure --prefix=/bulider/software/curl</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h1 id="第二难：安装R"><a href="#第二难：安装R" class="headerlink" title="第二难：安装R"></a>第二难：安装R</h1><p>安装了一打R的依赖包以后，你以为就能修成正果，急流勇退了吗？如果你有这个想法我想说你还是<strong>图样图森破！上台拿衣服！</strong><br>1.进行<code>configure</code><br><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/<span class="string">source/</span><span class="string">R-3.</span>4.2/<span class="string">configure </span><span class="built_in">--prefix=/builder/software/R</span> <span class="built_in">--en</span></span><br><span class="line"><span class="built_in">able-R-shlib</span> <span class="built_in">--with-cairo</span>  <span class="built_in">--with-jpeglib</span> <span class="built_in">--with-readline</span> <span class="built_in">--with-tcltk</span>  <span class="built_in">--with-blas</span> <span class="built_in">--with-lapack</span> <span class="built_in">--enable-R-profiling</span> <span class="string">LDFLAGS=</span><span class="string">"-L/builder/software/zlib/lib  -L/builder/software/bzip2/lib -L/builder/software/xz/lib -L/builder/software/pcre/lib -L/builder/so</span></span><br><span class="line"><span class="string">ftware/curl/lib"</span> <span class="string">CPPFLAGS=</span><span class="string">"-I/builder/zlib/include -I/builder/softw</span></span><br><span class="line"><span class="string">are/bzip2/include -I/builder/software/xz/include -I/builder/software/pcre/in</span></span><br><span class="line"><span class="string">clude -I/builder/software/curl/include"</span><span class="comment">##第一步检查环境配置，生成Makefile</span></span><br></pre></td></tr></table></figure></p><p>首先注意一点，如果你要把R安装到另一个文件夹里而不是源码所在的文件夹里，那么你首先要创建一个文件夹，然后在这个文件夹里对R进行编译，在<code>configure</code>时要加上全路径<code>/source/R-3.4.2/configure</code>，同时在后面加上<code>--prefix=</code>参数，比方我要安装到<code>/builder/software/R</code>,那么就需要加入<code>--prefix=/builder/software/R</code>这个参数，而我的源码在<code>/source/R-3.4.2</code>这个文件夹里。<br>其次由于R是用C语言写的，因此要从源码编译R需要把R的源码需要通过<code>gcc</code>将源码编译为可执行文件。在前面我们安装了一些R的依赖库，这些依赖库是在编译R的时候要用到的，如果在一般情况下这些依赖库都会放到系统指定的位置来进行使用，但是由于我没有root权限，因此无法将这些库文件放到系统指定的库路径或者修改相应的配置文件，只能把这些库的路径通过<code>LDFLAGS</code>和<code>CPPFLAGS</code>这两个参数来传递给<code>gcc</code>，关于这两个参数可以<a href="http://www.cnblogs.com/taskiller/archive/2012/12/14/2817650.html" target="_blank" rel="noopener">参考</a>。告诉<code>gcc</code>这些路径里有相应的库。其中<code>LDFLAGS</code>传递的是给链接器的参数，<code>CPPFLAGS</code>传递的是相应的头文件。这两个参数都是<code>configure</code>的参数。<br>2.通过上一步生成了<code>Makefile</code>后，觉得胜利已经在前方向你招手，于是你进行了<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">make</span></span><br></pre></td></tr></table></figure></p><p><strong>但是出现了报错！</strong><br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/<span class="symbol">ld:</span> <span class="symbol">warning:</span> libpcre.so.<span class="number">1</span>, needed by ../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>, <span class="title">not</span> <span class="title">found</span> (<span class="title">try</span> <span class="title">using</span> -<span class="title">rpath</span> <span class="title">or</span> -<span class="title">rpath</span>-<span class="title">link</span>)</span></span><br><span class="line">/usr/bin/<span class="symbol">ld:</span> <span class="symbol">warning:</span> liblzma.so.<span class="number">5</span>, needed by ../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>, <span class="title">not</span> <span class="title">found</span> (<span class="title">try</span> <span class="title">using</span> -<span class="title">rpath</span> <span class="title">or</span> -<span class="title">rpath</span>-<span class="title">link</span>)</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_fullinfo</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_lzma_preset</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_alone_decoder</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_crc64</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_raw_encoder</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_config</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_code</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_stream_decoder</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_free</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_raw_decoder</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_free_study</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_assign_jit_stack</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_exec</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_version_string</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_maketables</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_stream_encoder</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_compile</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_study</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_version</span>'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">lzma_end</span>@<span class="title">XZ_5</span>.0'</span></span><br><span class="line">../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>: <span class="title">undefined</span> <span class="title">reference</span> <span class="title">to</span> `<span class="title">pcre_jit_stack_alloc</span>'</span></span><br><span class="line"><span class="symbol">collect2:</span> <span class="symbol">error:</span> ld returned <span class="number">1</span> exit status</span><br><span class="line">make[<span class="number">3</span>]: *** [R.bin] Error <span class="number">1</span></span><br><span class="line">make[<span class="number">3</span>]: Leaving directory <span class="string">`/builder/software/R/src/main'</span></span><br><span class="line"><span class="string">make[2]: *** [R] Error 2</span></span><br><span class="line"><span class="string">make[2]: Leaving directory `</span>/builder/software/R/src/main<span class="string">'</span></span><br><span class="line"><span class="string">make[1]: *** [R] Error 1</span></span><br><span class="line"><span class="string">make[1]: Leaving directory `/builder/software/R/src'</span></span><br><span class="line"><span class="symbol">make:</span> *** [R] Error <span class="number">1</span></span><br></pre></td></tr></table></figure></p><p>这个报错是因为什么原因导致的？我们可以看到里面说<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/<span class="symbol">ld:</span> <span class="symbol">warning:</span> libpcre.so.<span class="number">1</span>, needed by ../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>, <span class="title">not</span> <span class="title">found</span> (<span class="title">try</span> <span class="title">using</span> -<span class="title">rpath</span> <span class="title">or</span> -<span class="title">rpath</span>-<span class="title">link</span>)</span></span><br><span class="line">/usr/bin/<span class="symbol">ld:</span> <span class="symbol">warning:</span> liblzma.so.<span class="number">5</span>, needed by ../../<span class="class"><span class="keyword">lib</span>/<span class="title">libR</span>.<span class="title">so</span>, <span class="title">not</span> <span class="title">found</span> (<span class="title">try</span> <span class="title">using</span> -<span class="title">rpath</span> <span class="title">or</span> -<span class="title">rpath</span>-<span class="title">link</span>)</span></span><br></pre></td></tr></table></figure></p><p>说缺少<code>libpcre.so.1</code>和<code>liblzma.so.5</code>这两个库文件，<code>我心里浮现了一副黑人问号脸</code>我在前面<code>./configure</code>的时候还传入了<code>PCRE</code>和<code>XZ</code>这两个库的路径，<strong>为什么还是会报错？</strong><br>于是我先是进行了谷歌，从谷歌上找到了一篇<a href="http://kuxingseng2016.blog.51cto.com/1374617/1846326" target="_blank" rel="noopener">R安装攻略</a>,在这篇攻略里也提到了这个问题，</p><blockquote><p>此处报错是由于没有找到动态库，看第一二行<br>解决方法：添加动态库<br>cat /etc/ld.so.conf<br>include ld.so.conf.d/*.conf<br>/opt/pcre-8.39/lib<br>/opt/xz-5.2.2/lib</p></blockquote><p>但是在这个攻略里最后的解决方法是修改<code>/etc/ld.so.conf</code>文件，将前面安装的库的路径添加到这个文件中，但是我没有root权限，并不能修改这个文件，因此这个方法对我并不适用。后来在鹏帆和许骄的提醒下，我们在后面看到建议说<code>try using -rpath or -rpath-link</code>,后来我<a href="http://www.cnblogs.com/bourneli/archive/2012/04/27/2474103.html" target="_blank" rel="noopener">搜索</a>了这两个命令，这两个命令是用于通过<code>gcc</code>向<code>ld</code>传递参数的时候用的，</p><blockquote><p>gcc编译链接动态库时，很有可能编译通过，但是执行时，找不到动态链接库，那是因为-L选项指定的路径只在编译时有效，解决方法是通过-Wl(注意，是字母表K之后的小写L),rpath=&lt;your_lib_dir&gt;，使得execute记住链接库的位置</p></blockquote><p>于是我试着在<code>configure</code>的时候加入这两个参数<br><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/builder/software/R</span><span class="literal">-</span><span class="comment">3</span><span class="string">.</span><span class="comment">4</span><span class="string">.</span><span class="comment">2/configure</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">prefix=/builder/software/R</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">en</span></span><br><span class="line"><span class="comment">able</span><span class="literal">-</span><span class="comment">R</span><span class="literal">-</span><span class="comment">shlib</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">cairo</span>  <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">jpeglib</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">readline</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">tcltk</span>  <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">blas</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">lapack</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">enable</span><span class="literal">-</span><span class="comment">R</span><span class="literal">-</span><span class="comment">profiling</span> <span class="comment">LDFLAGS="</span><span class="literal">-</span><span class="comment">L/builder/software/zlib/lib</span>  <span class="literal">-</span><span class="comment">L/builder/software/bzip2/lib</span> <span class="literal">-</span><span class="comment">L/builder/software/xz/lib</span>  <span class="literal">-</span><span class="comment">Wl</span><span class="string">,</span><span class="literal">-</span><span class="literal">-</span><span class="comment">rpath/builder/software/pcre/lib</span> <span class="literal">-</span><span class="comment">Wl</span><span class="string">,</span><span class="literal">-</span><span class="literal">-</span><span class="comment">rpath/builder/so</span></span><br><span class="line"><span class="comment">ftware/curl/lib"</span> <span class="comment">CPPFLAGS="</span><span class="literal">-</span><span class="comment">I/builder/software/zlib/include</span> <span class="literal">-</span><span class="comment">I/builder/softw</span></span><br><span class="line"><span class="comment">are/bzip2/include</span> <span class="literal">-</span><span class="comment">I/builder/software/xz/include</span> <span class="literal">-</span><span class="comment">I/builder/software/pcre/in</span></span><br><span class="line"><span class="comment">clude</span> <span class="literal">-</span><span class="comment">I/builder/software/curl/include</span></span><br></pre></td></tr></table></figure></p><p>但是这样总会报错，后来我知道，<code>configure</code>的时候我们传入的参数都会写到<code>Makeconf</code>文件里面，那么我可不可以先按照原来的我方法先进行<code>configure</code>，然后再对<code>Makeconf</code>文件进行修改呢？于是我还是先按照之前的方法进行<code>configure</code><br><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/builder/software/R</span><span class="literal">-</span><span class="comment">3</span><span class="string">.</span><span class="comment">4</span><span class="string">.</span><span class="comment">2/configure</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">prefix=/builder/software/R</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">en</span></span><br><span class="line"><span class="comment">able</span><span class="literal">-</span><span class="comment">R</span><span class="literal">-</span><span class="comment">shlib</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">cairo</span>  <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">jpeglib</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">readline</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">tcltk</span>  <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">blas</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">with</span><span class="literal">-</span><span class="comment">lapack</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">enable</span><span class="literal">-</span><span class="comment">R</span><span class="literal">-</span><span class="comment">profiling</span> <span class="comment">LDFLAGS="</span><span class="literal">-</span><span class="comment">L/builder/software/zlib/lib</span>  <span class="literal">-</span><span class="comment">L/builder/software/bzip2/lib</span> <span class="literal">-</span><span class="comment">L/builder/software/xz/lib</span> <span class="literal">-</span><span class="comment">L/builder/software/pcre/lib</span> <span class="literal">-</span><span class="comment">L/builder/so</span></span><br><span class="line"><span class="comment">ftware/curl/lib"</span> <span class="comment">CPPFLAGS="</span><span class="literal">-</span><span class="comment">I/builder/software/zlib/include</span> <span class="literal">-</span><span class="comment">I/builder/softw</span></span><br><span class="line"><span class="comment">are/bzip2/include</span> <span class="literal">-</span><span class="comment">I/builder/software/xz/include</span> <span class="literal">-</span><span class="comment">I/builder/software/pcre/in</span></span><br><span class="line"><span class="comment">clude</span> <span class="literal">-</span><span class="comment">I/builder/software/curl/include</span></span><br></pre></td></tr></table></figure></p><p>然后在<code>make</code>之前修改<code>Makeconf</code>中的参数<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LDFLAGS = -L<span class="regexp">/builder/</span>software<span class="regexp">/zlib/</span>lib  -L<span class="regexp">/builder/</span>software<span class="regexp">/bzip2/</span>lib   -L<span class="regexp">/builder/</span>software<span class="regexp">/curl/</span>lib -Wl,-rpath=<span class="regexp">/builder/</span>software<span class="regexp">/xz/</span>lib -Wl,-rpath=<span class="regexp">/builder/</span>software<span class="regexp">/pcre/</span>lib</span><br></pre></td></tr></table></figure></p><p>再进行<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">make</span></span><br></pre></td></tr></table></figure></p><p><strong>之前的报错终于不见了!</strong>但是出现了新的报错<code>心里有句mmp</code>:<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/ld: cannot <span class="builtin-name">find</span> -lpcre</span><br><span class="line">collect2: error: ld returned 1 exit status</span><br><span class="line">make[3]: *** [libR.so] <span class="builtin-name">Error</span> 1</span><br><span class="line">make[3]: Leaving directory `/builder/software/R-3.4.2/src/main'</span><br><span class="line">make[2]: *** [R] <span class="builtin-name">Error</span> 2</span><br><span class="line">make[2]: Leaving directory `/builder/software/R-3.4.2/src/main'</span><br><span class="line">make[1]: *** [R] <span class="builtin-name">Error</span> 1</span><br><span class="line">make[1]: Leaving directory `/builder/software/R-3.4.2/src'</span><br><span class="line">make: *** [R] <span class="builtin-name">Error</span> 1</span><br></pre></td></tr></table></figure></p><p>于是我在想，可能是前面我把<code>LDFLAGS</code>里面参数由<code>-L/builder/software/pcre/lib</code>修改为了<code>-Wl,-rpath=/builder/software/pcre/lib</code>之后不再出现原来的报错，但是现在又出现了新的报错，而我在使用原来的参数时不会出现这个新的报错，结合之前我搜索到的<a href="http://www.cnblogs.com/bourneli/archive/2012/04/27/2474103.html" target="_blank" rel="noopener">结果</a>,是不是因为我之前的写法只能让路径<code>gcc</code>在编译时有效,而后来的写法只能让其在进行运行时有效？那么如果我让两种参数同时出现，虽然我把库的路径传递了两次，但是会不会就不再报错了？<strong>时间是检验真理的唯一标准！先试验一把！</strong>于是我把两种参数的路径都加到了<code>Makeconf</code>中<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LDFLAGS = -L<span class="regexp">/builder/</span>software<span class="regexp">/zlib/</span>lib  -L<span class="regexp">/builder/</span>software<span class="regexp">/bzip2/</span>lib -L<span class="regexp">/builder/</span>software<span class="regexp">/xz/</span>lib -L<span class="regexp">/builder/</span>software<span class="regexp">/pcre/</span>lib -L<span class="regexp">/builder/</span>software<span class="regexp">/curl/</span>lib -Wl,-rpath=<span class="regexp">/builder/</span>software<span class="regexp">/xz/</span>lib -Wl,-rpath=<span class="regexp">/builder/</span>software<span class="regexp">/pcre/</span>lib</span><br></pre></td></tr></table></figure></p><p>再次进行<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">make</span></span><br></pre></td></tr></table></figure></p><p>终于没有了报错。说明<code>make</code>成功了，于是我再进行<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make <span class="keyword">install</span></span><br></pre></td></tr></table></figure></p><p>终于安装完成！<code>你挑着担我牵着马</code></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ol><li>在Linux下用源码安装R是个大坑<code>尤其是在没有root权限的情况下</code></li><li>安装R之前一定要将R要求的依赖库预先安装好，版本和安装顺序都要对。具体可以参考R官方文档<a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Essential-and-useful-other-programs-under-a-Unix_002dalike" target="_blank" rel="noopener">R Installation and Administration </a>。</li><li>在安装好R的依赖库之后，在进行R的安装的时候要注意将依赖库的路径传入到参数中，而且一定要注意传入的方式。</li><li>注意分析报错信息，从中寻找原因，不要盲目瞎想，多谷歌，多问老司机。</li><li>关于<code>-Wl -rpath</code>更详细的介绍<a href="https://my.oschina.net/shelllife/blog/115958" target="_blank" rel="noopener">参考</a></li></ol>]]></content>
      
      <categories>
          
          <category> 生信/软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
